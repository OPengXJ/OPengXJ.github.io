<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ğŸµæ‰“é€ Goçš„æ­¦å™¨--Viperâœª</title>
    <link href="/2022/09/01/%E6%89%93%E9%80%A0Go%E7%9A%84%E6%AD%A6%E5%99%A8--Viper/"/>
    <url>/2022/09/01/%E6%89%93%E9%80%A0Go%E7%9A%84%E6%AD%A6%E5%99%A8--Viper/</url>
    
    <content type="html"><![CDATA[<p>Goç¨‹åºçš„ç¬¬ä¸€æŠŠæ­¦å™¨ï¼šé¡¹ç›®é…ç½®ç®¡ç†<strong>Viper</strong></p><span id="more"></span><h1 id="ğŸµæ‰“é€ Goçš„æ­¦å™¨â€“Viperâœª"><a href="#ğŸµæ‰“é€ Goçš„æ­¦å™¨â€“Viperâœª" class="headerlink" title="ğŸµæ‰“é€ Goçš„æ­¦å™¨â€“Viperâœª"></a>ğŸµæ‰“é€ Goçš„æ­¦å™¨â€“Viperâœª</h1><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5s8nxlpa2j20fj08q0ti.jpg"></p><h2 id="ä»€ä¹ˆæ˜¯-Viperï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-Viperï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ Viperï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ Viperï¼Ÿ</h2><p>Viper æ˜¯é€‚ç”¨äº Go åº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬ Twelve-Factor Appï¼‰çš„å®Œæ•´é…ç½®è§£å†³æ–¹æ¡ˆã€‚å®ƒè¢«è®¾è®¡ä¸ºåœ¨åº”ç”¨ç¨‹åºä¸­å·¥ä½œï¼Œå¹¶ä¸”å¯ä»¥å¤„ç†æ‰€æœ‰ç±»å‹çš„é…ç½®éœ€æ±‚å’Œæ ¼å¼ã€‚å®ƒæ”¯æŒ</p><ul><li>è®¾ç½®é»˜è®¤å€¼</li><li>å¯ä»¥è¯»å– JSONï¼ŒTOMLï¼ŒYAMLï¼ŒHCLï¼Œenvfile å’Œ Java properties æ ¼å¼çš„é…ç½®æ–‡ä»¶</li><li>å®æ—¶ç›‘æ§å’Œé‡æ–°è¯»å–é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰</li><li>è¯»å–ç¯å¢ƒå˜é‡ä¸­çš„é…ç½®ä¿¡æ¯</li><li>è¯»å–è¿œç¨‹é…ç½®ç³»ç»Ÿï¼ˆetcd æˆ– Consulï¼‰ä¸­çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶ç›‘æ§é…ç½®ä¿¡æ¯å‘ç”Ÿæ”¹å˜</li><li>è¯»å–å‘½ä»¤è¡Œå‚æ•°ä¸­çš„é…ç½®ä¿¡æ¯</li><li>è¯»å– buffer ä¸­çš„é…ç½®ä¿¡æ¯</li><li>æ˜¾å¼è®¾ç½®é…ç½®é¡¹</li></ul><p>å¯ä»¥å°† Viper è§†ä¸ºæ»¡è¶³æ‚¨æ‰€æœ‰åº”ç”¨ç¨‹åºé…ç½®éœ€æ±‚çš„æ³¨å†Œè¡¨ã€‚</p><h2 id="å¿«é€Ÿä½¿ç”¨ğŸ†ï¼š"><a href="#å¿«é€Ÿä½¿ç”¨ğŸ†ï¼š" class="headerlink" title="å¿«é€Ÿä½¿ç”¨ğŸ†ï¼š"></a>å¿«é€Ÿä½¿ç”¨ğŸ†ï¼š</h2><p>å®‰è£…ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cn">go get github.com/spf13/viper<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ï¼š</p><p>å…ˆåœ¨main.goåŒçº§ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®ç›®å½•ä¸‹å»ºç«‹configsç›®å½•ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»º<code>config.yaml</code>ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">Database:</span><br><span class="hljs-symbol">  DBType:</span> mysql<br><span class="hljs-symbol">  Username:</span> root<br><span class="hljs-symbol">  Password:</span> <span class="hljs-number">123456</span><br><span class="hljs-symbol">  Host:</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>:<span class="hljs-number">3306</span><br></code></pre></td></tr></table></figure><p>main.go:</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;github.com/spf13/viper&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>viper.SetConfigName(<span class="hljs-string">&quot;config&quot;</span>)<br>viper.SetConfigType(<span class="hljs-string">&quot;yaml&quot;</span>)<br>viper.AddConfigPath(<span class="hljs-string">&quot;configs&quot;</span>)<br><span class="hljs-keyword">if</span> err := viper.ReadInConfig(); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;error in read&quot;</span>)<br>&#125;<br>fmt.Println(viper.Get(<span class="hljs-string">&quot;Database.Host&quot;</span>))<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><p>å¾ˆç®€å•ï¼Œæ— éå°±ä¸¤éƒ¨åˆ†ï¼šå†™å…¥å’Œè¯»å–ï¼Œæ¥ä¸‹æ¥æŒ‰ç…§è¿™ä¸¤éƒ¨åˆ†æˆ‘ä»¬è®²è®²æ›´æ·±å…¥çš„ç”¨æ³•</p></blockquote><h2 id="ğŸ˜å†™å…¥ï¼š"><a href="#ğŸ˜å†™å…¥ï¼š" class="headerlink" title="ğŸ˜å†™å…¥ï¼š"></a>ğŸ˜å†™å…¥ï¼š</h2><p>viper æ”¯æŒåœ¨å¤šä¸ªåœ°æ–¹è®¾ç½®ï¼Œä½¿ç”¨ä¸‹é¢çš„é¡ºåºä¾æ¬¡è¯»å–ï¼š</p><ul><li>è°ƒç”¨<code>Set</code>æ˜¾ç¤ºè®¾ç½®çš„ï¼›</li><li>å‘½ä»¤è¡Œé€‰é¡¹ï¼›</li><li>ç¯å¢ƒå˜é‡ï¼›</li><li>é…ç½®æ–‡ä»¶ï¼›</li><li>é»˜è®¤å€¼ã€‚</li></ul><h3 id="viper-Set"><a href="#viper-Set" class="headerlink" title="viper.Set:"></a>viper.Set:</h3><p>Setçš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œæ‰€ä»¥å®ƒå¯èƒ½è¢«ç”¨æ¥è¦†ç›–å‘½ä»¤è¡Œå‚æ•°ï¼Œæˆ–è€…å°±å•çº¯è‡ªå·±çš„åº”ç”¨é€»è¾‘ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">viper.Set(<span class="hljs-string">&quot;redis.port&quot;</span>, <span class="hljs-number">5381</span>)<br></code></pre></td></tr></table></figure><h3 id="å‘½ä»¤è¡Œå‚æ•°ï¼š"><a href="#å‘½ä»¤è¡Œå‚æ•°ï¼š" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°ï¼š"></a>å‘½ä»¤è¡Œå‚æ•°ï¼š</h3><p>viperçš„å‘½ä»¤è¡Œå‚æ•°æ˜¯æ­é…PFlagåŒ…ä¸€èµ·ç”¨çš„ï¼Œä¸‹é¢æ˜¯ä¾‹å­ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> globalSource = pflag.String(<span class="hljs-string">&quot;global.source&quot;</span>, <span class="hljs-string">&quot;default(flag)&quot;</span>, <span class="hljs-string">&quot;identify the source of configuration&quot;</span>)<br><span class="hljs-keyword">var</span> serverAddress = pflag.String(<span class="hljs-string">&quot;server.address&quot;</span>, <span class="hljs-string">&quot;&quot;</span>, <span class="hljs-string">&quot;server listen address, empty for all&quot;</span>)<br><span class="hljs-keyword">var</span> serverPort = pflag.Int(<span class="hljs-string">&quot;server.port&quot;</span>, <span class="hljs-number">8080</span>, <span class="hljs-string">&quot;server listen port&quot;</span><br><span class="hljs-comment">//Goä¸­å‘½ä»¤è¡Œå‚æ•°ç»‘å®šçš„å†™æ³•ï¼Œå‚æ•°1ä¸ºå‚æ•°åç§°ï¼Œå‚æ•°2ä¸ºé»˜è®¤å€¼ï¼Œå‚æ•°3ä¸ºè¾“å…¥æç¤º</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-comment">/* ... */</span><br>    pflag.Parse()  <span class="hljs-comment">//å‚æ•°è§£æ</span><br>    viper.BindPFlags(pflag.CommandLine) <span class="hljs-comment">//ç»‘å®šåˆ°viper</span><br>    <span class="hljs-comment">/* ... */</span><br>&#125;<br></code></pre></td></tr></table></figure><p><code>viper.BindPFlags()</code>è‡ªåŠ¨ç»‘å®šäº†æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œå¦‚æœåªéœ€è¦å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨viper.BingPflag()é€‰æ‹©æ€§ç»‘å®šï¼Œå¦‚<code>viper.BindPFlag(&quot;global.source&quot;, pflag.Lookup(&quot;global.source&quot;))</code></p><h3 id="ç¯å¢ƒå˜é‡ï¼š"><a href="#ç¯å¢ƒå˜é‡ï¼š" class="headerlink" title="ç¯å¢ƒå˜é‡ï¼š"></a>ç¯å¢ƒå˜é‡ï¼š</h3><ul><li>AutomaticEnv()</li><li>BindEnv(stringâ€¦) : error</li><li>SetEnvPrefix(string)</li><li>SetEnvKeyReplacer(*strings.Replacer)</li></ul><p>æ³¨æ„ï¼Œç¯å¢ƒå˜é‡æ˜¯åŒºåˆ†å¤§å°å†™çš„</p><p>é¦–å…ˆè¯´<code>AutomaticEnv()</code>å’Œ<code>BindEnv(string...)</code>ï¼Œ<code>AutomaticEnv()</code>è¾ƒä¸ºç®€å•ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç»‘å®šæ‰€æœ‰çš„ç¯å¢ƒå˜é‡ï¼Œegï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-comment">// ç»‘å®šç¯å¢ƒå˜é‡</span><br>viper.AutomaticEnv()<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç </span><br><br>fmt.Println(<span class="hljs-string">&quot;GOPATH: &quot;</span>, viper.Get(<span class="hljs-string">&quot;GOPATH&quot;</span>))<br>&#125;<br><span class="hljs-comment">//æ­£å¸¸è¾“å‡º</span><br></code></pre></td></tr></table></figure><p>è€Œ<code>BindEnv</code>åˆ™æ˜¯ç”¨äºç»‘å®šç‰¹å®šçš„ç¯å¢ƒå˜é‡ï¼Œå®ƒæœ‰ä¸¤ç§è¾“å…¥å‚æ•°çš„æ–¹å¼ï¼Œå½“åªè¾“å…¥ä¸€ä¸ªå‚æ•°æ—¶ï¼Œåˆ™Keyå’Œè¦ç»‘å®šçš„ç¯å¢ƒå˜é‡åŒåï¼Œå¦‚æœè¾“å…¥çš„æ˜¯ä¸¤ä¸ªå‚æ•°ï¼Œåˆ™ç¬¬ä¸€ä¸ªæ˜¯Keyï¼Œç¬¬äºŒä¸ªæ˜¯ç¯å¢ƒå˜é‡åï¼Œegï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-comment">// ç»‘å®šç¯å¢ƒå˜é‡</span><br>viper.BindEnv(<span class="hljs-string">&quot;redis.port&quot;</span>)<br>viper.BindEnv(<span class="hljs-string">&quot;go.path&quot;</span>, <span class="hljs-string">&quot;GOPATH&quot;</span>)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br><span class="hljs-comment">// çœç•¥éƒ¨åˆ†ä»£ç </span><br>fmt.Println(<span class="hljs-string">&quot;go path: &quot;</span>, viper.Get(<span class="hljs-string">&quot;go.path&quot;</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>æ¥ç€æ˜¯<code>SetEnvPrefix</code>ï¼Œç”¨äºè®¾ç½®å‰ç¼€ï¼Œä»–å°†ä¼šå’Œ<code>AutomaticEnv()</code>å’Œ<code>BindEnv</code>é…å¥—ä½¿ç”¨ï¼Œå½“è®¾ç½®äº†å‰ç¼€åï¼Œå†è°ƒç”¨è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåé¢ä½¿ç”¨<code>Get</code>çš„æ—¶å€™åˆ™ä¼šè‡ªåŠ¨å¸¦ä¸Šå‰ç¼€ï¼Œegï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">SetEnvPrefix(<span class="hljs-string">&quot;spf&quot;</span>) <span class="hljs-comment">// ä¼šè‡ªåŠ¨è½¬ä¸ºå¤§å†™</span><br>BindEnv(<span class="hljs-string">&quot;id&quot;</span>)<br><br>os.Setenv(<span class="hljs-string">&quot;SPF_ID&quot;</span>, <span class="hljs-string">&quot;13&quot;</span>)<br><br>id := Get(<span class="hljs-string">&quot;id&quot;</span>) <span class="hljs-comment">// 13</span><br></code></pre></td></tr></table></figure><p>æœ€åæ˜¯<code>SetEnvKeyReplacer</code>ï¼Œè¿™ä¸ªç®—æ˜¯ä¸€ä¸ªè¾…åŠ©æ–¹æ³•ï¼Œç”¨äºå¯¹åœ¨è°ƒç”¨<code>Get</code>çš„æ—¶å€™ä¼ å…¥çš„keyçš„ç¬¦å·è¿›è¡Œæ›¿æ¢ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„æ˜¯<code>Globar.Source</code>è€Œç¯å¢ƒå˜é‡é‡Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<code>Globar_Source</code>ï¼Œè¿™æ—¶å°±èƒ½ç”¨åˆ°äº†ï¼Œegï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go">viper.AutomaticEnv()<br><br>viper.SetEnvPrefix(<span class="hljs-string">&quot;MYAPP&quot;</span>)<br><br>viper.SetEnvKeyReplacer(strings.NewReplacer(<span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>)<br>                        <br>fmt.Println(viper.Get(<span class="hljs-string">&quot;Globar.Source&quot;</span>))<br><span class="hljs-comment">//è¾“å‡ºäº† MYAPP_GLOBAL_SOURCE</span><br></code></pre></td></tr></table></figure><h3 id="é…ç½®æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š"><a href="#é…ç½®æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š" class="headerlink" title="é…ç½®æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š"></a>é…ç½®æ–‡ä»¶ï¼ˆæœ€å¸¸ç”¨ï¼‰ï¼š</h3><p>æ­£å¦‚å¿«é€Ÿä½¿ç”¨é‡Œé¢æåˆ°çš„ï¼Œæ­¥éª¤å°±æ˜¯å†™å¥½é…ç½®æ–‡ä»¶ï¼Œå†è€…å°±æ˜¯<code>viper.SetConfigName(&quot;config&quot;)</code>ï¼Œ<code>viper.SetConfigType(&quot;yaml&quot;)</code>ï¼Œ<code>viper.AddConfigPath(&quot;configs&quot;)</code>ï¼Œå†<code>viper.ReadInConfig()</code>å°±å¯ä»¥è¯»å–äº†ã€‚</p><h3 id="é»˜è®¤å€¼ï¼š"><a href="#é»˜è®¤å€¼ï¼š" class="headerlink" title="é»˜è®¤å€¼ï¼š"></a>é»˜è®¤å€¼ï¼š</h3><p>è®¾ç½®é»˜è®¤å€¼ï¼Œå¯ä»¥ç”¨äºå¤‡ç”¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">viper.SetDefault(<span class="hljs-string">&quot;ContentDir&quot;</span>, <span class="hljs-string">&quot;content&quot;</span>)<br></code></pre></td></tr></table></figure><h3 id="ä»io-Readerä¸­è¯»å–"><a href="#ä»io-Readerä¸­è¯»å–" class="headerlink" title="ä»io.Readerä¸­è¯»å–:"></a>ä»io.Readerä¸­è¯»å–:</h3><p>viper æ”¯æŒä»<code>io.Reader</code>ä¸­è¯»å–é…ç½®ã€‚è¿™ç§å½¢å¼å¾ˆçµæ´»ï¼Œæ¥æºå¯ä»¥æ˜¯æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¨‹åºä¸­ç”Ÿæˆçš„å­—ç¬¦ä¸²ï¼Œç”šè‡³å¯ä»¥ä»ç½‘ç»œè¿æ¥ä¸­è¯»å–çš„å­—èŠ‚æµ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">package main<br><br><span class="hljs-keyword">import</span> (<br>&quot;bytes&quot;<br>&quot;fmt&quot;<br>&quot;log&quot;<br><br>&quot;github.com/spf13/viper&quot;<br>)<br><br>func main() &#123;<br>viper.SetConfigType(&quot;toml&quot;)<br>tomlConfig := []byte(`<br>app_name = &quot;awesome web&quot;<br><br># possible <span class="hljs-keyword">values</span>: <span class="hljs-keyword">DEBUG</span>, <span class="hljs-keyword">INFO</span>, <span class="hljs-built_in">WARNING</span>, ERROR, FATAL<br>log_level = &quot;DEBUG&quot;<br><br>[mysql]<br>ip = &quot;127.0.0.1&quot;<br>port = <span class="hljs-number">3306</span><br><span class="hljs-keyword">user</span> = &quot;root&quot;<br><span class="hljs-keyword">password</span> = <span class="hljs-number">123456</span><br><span class="hljs-keyword">database</span> = &quot;awesome&quot;<br>`)<br>err := viper.ReadConfig(bytes.NewBuffer(tomlConfig))<br><span class="hljs-keyword">if</span> err != nil &#123;<br><span class="hljs-keyword">log</span>.Fatal(&quot;read config failed: %v&quot;, err)<br>&#125;<br><br>fmt.Println(&quot;redis port: &quot;, viper.GetInt(&quot;redis.port&quot;))<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ğŸ¤ªè¯»å–ï¼š"><a href="#ğŸ¤ªè¯»å–ï¼š" class="headerlink" title="ğŸ¤ªè¯»å–ï¼š"></a>ğŸ¤ªè¯»å–ï¼š</h2><h3 id="ä¿å­˜é…ç½®ï¼š"><a href="#ä¿å­˜é…ç½®ï¼š" class="headerlink" title="ä¿å­˜é…ç½®ï¼š"></a>ä¿å­˜é…ç½®ï¼š</h3><p>ç”¨äºåœ¨é…ç½®å‘ç”Ÿæ›´å¥½åä¿å­˜è‡³æœ¬åœ°ï¼Œå…·ä½“æ¨èä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š</p><ul><li><code>WriteConfigAs</code>ï¼šä¿å­˜é…ç½®åˆ°æŒ‡å®šè·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¦†ç›–ï¼›</li><li><code>SafeWriteConfig</code>ï¼šä¸ä¸Šé¢åŠŸèƒ½ä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœé…ç½®æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä¸è¦†ç›–ï¼Œä¼šæŠ¥é”™ã€‚</li></ul><h3 id="åŸºæœ¬è¯»å–ï¼š"><a href="#åŸºæœ¬è¯»å–ï¼š" class="headerlink" title="åŸºæœ¬è¯»å–ï¼š"></a>åŸºæœ¬è¯»å–ï¼š</h3><p>åœ¨ Viper ä¸­ï¼Œæœ‰å‡ ç§æ ¹æ®å€¼çš„ç±»å‹è·å–å€¼çš„æ–¹æ³•ã€‚å­˜åœ¨ä»¥ä¸‹åŠŸèƒ½å’Œæ–¹æ³•ï¼š</p><ul><li>Get(key string) : interface{}</li><li>GetBool(key string) : bool</li><li>GetFloat64(key string) : float64</li><li>GetInt(key string) : int</li><li>GetIntSlice(key string) : []int</li><li>GetString(key string) : string</li><li>GetStringMap(key string) : map[string]interface{}</li><li>GetStringMapString(key string) : map[string]string</li><li>GetStringSlice(key string) : []string</li><li>GetTime(key string) : time.Time</li><li>GetDuration(key string) : time.Duration</li><li>IsSet(key string) : bool</li><li>AllSettings() : map[string]interface{}</li></ul><p>æ¯ä¸ª Get å‡½æ•°å¦‚æœæ‰¾ä¸åˆ°å€¼ï¼Œå®ƒå°†è¿”å›é›¶å€¼ã€‚ä¸ºäº†æ£€æŸ¥ç»™å®šé”®æ˜¯å¦å­˜åœ¨ï¼Œæä¾›äº† IsSet() æ–¹æ³•ã€‚</p><p><strong>è®¿é—®å¥—æ¥é”®ï¼š</strong></p><p>è®¿é—®å™¨æ–¹æ³•è¿˜æ¥å—æ·±åº¦åµŒå¥—é”®çš„æ ¼å¼åŒ–è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåŠ è½½äº†ä»¥ä¸‹JSONæ–‡ä»¶ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go">&#123;<br>    <span class="hljs-string">&quot;host&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>        <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-number">5799</span><br>    &#125;,<br>    <span class="hljs-string">&quot;datastore&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;metric&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-number">3099</span><br>        &#125;,<br>        <span class="hljs-string">&quot;warehouse&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;198.0.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-number">2112</span><br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>Viper å¯ä»¥é€šè¿‡ä¼ é€’ã€Œ.ã€åˆ†éš”é”®çš„è·¯å¾„æ¥è®¿é—®åµŒå¥—å­—æ®µï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">GetString(<span class="hljs-string">&quot;datastore.metric.host&quot;</span>) <span class="hljs-comment">// (returns &quot;127.0.0.1&quot;)</span><br></code></pre></td></tr></table></figure><p>éµå®ˆä¸Šé¢å»ºç«‹çš„ä¼˜å…ˆçº§è§„åˆ™ï¼›æœç´¢è·¯å¾„å°†éå†å…¶ä½™é…ç½®æ³¨å†Œè¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ç»™å®šæ­¤é…ç½®æ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œdatastore.metric.host å’Œ datastore.metric.port å‡å·²å®šä¹‰ï¼ˆå¹¶ä¸”å¯ä»¥è¢«è¦†ç›–ï¼‰ã€‚å¦‚æœå¦å¤–åœ¨é»˜è®¤è®¾ç½®ä¸­å®šä¹‰äº† datastore.metric.protocolï¼ŒViper ä¹Ÿä¼šæ‰¾åˆ°å®ƒã€‚</p><p>ä½†æ˜¯ï¼Œå¦‚æœ datastore.metric è¢«ç›´æ¥èµ‹å€¼è¦†ç›–ï¼ˆé€šè¿‡ flagï¼Œç¯å¢ƒå˜é‡ï¼ŒSet() æ–¹æ³•ç­‰ï¼‰ï¼Œåˆ™ datastore.metric çš„æ‰€æœ‰å­é”®ä¹Ÿéƒ½å˜ä¸ºæœªå®šä¹‰çŠ¶æ€ï¼Œå®ƒä»¬è¢«è¾ƒé«˜çš„ä¼˜å…ˆçº§é…ç½®é®è”½ï¼ˆshadowedï¼‰äº†ã€‚</p><p>Viper å¯ä»¥ä½¿ç”¨è·¯å¾„ä¸­çš„æ•°å­—è®¿é—®æ•°ç»„ç´¢å¼•ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs awk">&#123;<br>    <span class="hljs-string">&quot;host&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;address&quot;</span>: <span class="hljs-string">&quot;localhost&quot;</span>,<br>        <span class="hljs-string">&quot;ports&quot;</span>: [<br>            <span class="hljs-number">5799</span>,<br>            <span class="hljs-number">6029</span><br>        ]<br>    &#125;<br>&#125;<br><br>GetInt(<span class="hljs-string">&quot;host.ports.1&quot;</span>) <span class="hljs-regexp">//</span> returns <span class="hljs-number">6029</span><br></code></pre></td></tr></table></figure><p>æœ€åï¼Œå¦‚æœå­˜åœ¨ä¸åˆ†éš”çš„é”®è·¯å¾„åŒ¹é…çš„é”®ï¼Œåˆ™å°†è¿”å›å…¶å€¼ã€‚ä¾‹å¦‚</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&#123;<br>    <span class="hljs-string">&quot;datastore.metric.host&quot;</span>: <span class="hljs-string">&quot;0.0.0.0&quot;</span>,<br>    <span class="hljs-string">&quot;datastore&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;metric&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;host&quot;</span>: <span class="hljs-string">&quot;127.0.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;port&quot;</span>: <span class="hljs-number">3099</span><br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-title">GetString</span><span class="hljs-params">(<span class="hljs-string">&quot;datastore.metric.host&quot;</span>)</span></span> <span class="hljs-comment">// returns &quot;0.0.0.0&quot;</span><br></code></pre></td></tr></table></figure><h3 id="æå–å­æ ‘ï¼š"><a href="#æå–å­æ ‘ï¼š" class="headerlink" title="æå–å­æ ‘ï¼š"></a>æå–å­æ ‘ï¼š</h3><p>æˆ‘ä»¬ä»¥ä¸‹é¢çš„ä¾‹å­æ¥è®²æå–å­æ ‘ã€‚</p><p>åº”ç”¨ç¨‹åºå¯èƒ½å‡ºäºä¸åŒçš„ç›®çš„ä½¿ç”¨å¤šä¸ªä¸åŒçš„ç¼“å­˜å­˜å‚¨ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">cache:</span><br>  <span class="hljs-attr">cache1:</span><br>    <span class="hljs-attr">max-items:</span> <span class="hljs-number">100</span><br>    <span class="hljs-attr">item-size:</span> <span class="hljs-number">64</span><br>  <span class="hljs-attr">cache2:</span><br>    <span class="hljs-attr">max-items:</span> <span class="hljs-number">200</span><br>    <span class="hljs-attr">item-size:</span> <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure><p>è¿™æ—¶æˆ‘ä»¬è¦å¾—åˆ°å…¶ä¸­ä¸€ä¸ªcacheçš„é…ç½®ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°<code>NewCache()</code>ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨<code>NewCache(&quot;cache1&quot;)</code>ç›´æ¥ä¼ å…¥åå­—çš„æ–¹å¼ï¼Œå†åˆ°å‡½æ•°é‡Œé¢æ ¹æ®åå­—â€cache.cache1.max-itemsâ€çš„å½¢å¼å»åˆ›å»ºï¼Œæ˜¾ç„¶æœ‰ç‚¹å°ä¹±ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨æ›´ä¼˜é›…çš„æ–¹å¼ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs lisp">func NewCache(<span class="hljs-name">v</span> *Viper) *Cache &#123;<br>    return <span class="hljs-symbol">&amp;Cache</span>&#123;<br>        MaxItems: v.GetInt(<span class="hljs-string">&quot;max-items&quot;</span>),<br>        ItemSize: v.GetInt(<span class="hljs-string">&quot;item-size&quot;</span>),<br>    &#125;<br>&#125;<br><br>cache1Config <span class="hljs-symbol">:=</span> viper.Sub(<span class="hljs-string">&quot;cache.cache1&quot;</span>)<br>if cache1Config == <span class="hljs-literal">nil</span> &#123; // Sub returns <span class="hljs-literal">nil</span> if the key cannot be found<br>    panic(<span class="hljs-string">&quot;cache configuration not found&quot;</span>)<br>&#125;<br><br>cache1 <span class="hljs-symbol">:=</span> NewCache(<span class="hljs-name">cache1Config</span>)<br></code></pre></td></tr></table></figure><h3 id="ååºåˆ—åŒ–ï¼š"><a href="#ååºåˆ—åŒ–ï¼š" class="headerlink" title="ååºåˆ—åŒ–ï¼š"></a>ååºåˆ—åŒ–ï¼š</h3><p>viper æ”¯æŒå°†é…ç½®<code>Unmarshal</code>åˆ°ä¸€ä¸ªç»“æ„ä½“ä¸­ï¼Œä¸ºç»“æ„ä½“ä¸­çš„å¯¹åº”å­—æ®µèµ‹å€¼ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;fmt&quot;</span><br><br><span class="hljs-string">&quot;github.com/spf13/viper&quot;</span><br>)<br><span class="hljs-keyword">type</span> Database <span class="hljs-keyword">struct</span>&#123;<br>Dbtype <span class="hljs-type">string</span><br>Host <span class="hljs-type">string</span><br>Password <span class="hljs-type">string</span><br>Username <span class="hljs-type">string</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>viper.SetConfigName(<span class="hljs-string">&quot;config&quot;</span>)<br>viper.SetConfigType(<span class="hljs-string">&quot;yaml&quot;</span>)<br>viper.AddConfigPath(<span class="hljs-string">&quot;configs&quot;</span>)<br><span class="hljs-keyword">if</span> err := viper.ReadInConfig(); err != <span class="hljs-literal">nil</span> &#123;<br>fmt.Println(<span class="hljs-string">&quot;error in read&quot;</span>)<br>&#125;<br><span class="hljs-keyword">var</span> Data Database<br><span class="hljs-keyword">if</span> err:=viper.UnmarshalKey(<span class="hljs-string">&quot;Database&quot;</span>,&amp;Data);err!=<span class="hljs-literal">nil</span>&#123;<br>fmt.Println(err)<br>&#125;<br>fmt.Println(Data)<br>&#125;<br></code></pre></td></tr></table></figure><p>å¦‚æœè¦è§£æ Key æœ¬èº«åŒ…å«ã€Œ.ã€ï¼ˆé»˜è®¤é”®åˆ†éš”ç¬¦ï¼‰çš„é…ç½®ï¼Œå¿…é¡»æ›´æ”¹åˆ†éš”ç¬¦ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs go">v := viper.NewWithOptions(viper.KeyDelimiter(<span class="hljs-string">&quot;::&quot;</span>))<br><br>v.SetDefault(<span class="hljs-string">&quot;chart::values&quot;</span>, <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>&#123;&#125;&#123;<br>    <span class="hljs-string">&quot;ingress&quot;</span>: <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>&#123;&#125;&#123;<br>        <span class="hljs-string">&quot;annotations&quot;</span>: <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>&#123;&#125;&#123;<br>            <span class="hljs-string">&quot;traefik.frontend.rule.type&quot;</span>:                 <span class="hljs-string">&quot;PathPrefix&quot;</span>,<br>            <span class="hljs-string">&quot;traefik.ingress.kubernetes.io/ssl-redirect&quot;</span>: <span class="hljs-string">&quot;true&quot;</span>,<br>        &#125;,<br>    &#125;,<br>&#125;)<br><br><span class="hljs-keyword">type</span> config <span class="hljs-keyword">struct</span> &#123;<br>  Chart <span class="hljs-keyword">struct</span>&#123;<br>        Values <span class="hljs-keyword">map</span>[<span class="hljs-type">string</span>]<span class="hljs-keyword">interface</span>&#123;&#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">var</span> C config<br><br>v.Unmarshal(&amp;C)<br></code></pre></td></tr></table></figure><h3 id="ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼š"><a href="#ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼š" class="headerlink" title="ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼š"></a>ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼š</h3><p>viper å¯ä»¥ç›‘å¬æ–‡ä»¶ä¿®æ”¹ï¼Œçƒ­åŠ è½½é…ç½®ã€‚å› æ­¤ä¸éœ€è¦é‡å¯æœåŠ¡å™¨ï¼Œå°±èƒ½è®©é…ç½®ç”Ÿæ•ˆã€‚</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs sqf">package main<br><br>import (<br><span class="hljs-string">&quot;fmt&quot;</span><br><span class="hljs-string">&quot;log&quot;</span><br><span class="hljs-string">&quot;time&quot;</span><br><br><span class="hljs-string">&quot;github.com/spf13/viper&quot;</span><br>)<br><br>func main() &#123;<br>viper.SetConfigName(<span class="hljs-string">&quot;config&quot;</span>)<br>viper.SetConfigType(<span class="hljs-string">&quot;toml&quot;</span>)<br>viper.AddConfigPath(<span class="hljs-string">&quot;.&quot;</span>)<br>err := viper.ReadInConfig()<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-built_in">log</span>.Fatal(<span class="hljs-string">&quot;read config failed: %v&quot;</span>, err)<br>&#125;<br><br>viper.WatchConfig()<br><br>fmt.Println(<span class="hljs-string">&quot;redis port before sleep: &quot;</span>, viper.<span class="hljs-built_in">Get</span>(<span class="hljs-string">&quot;redis.port&quot;</span>))<br><span class="hljs-built_in">time</span>.<span class="hljs-built_in">Sleep</span>(<span class="hljs-built_in">time</span>.Second * <span class="hljs-number">10</span>)<br>fmt.Println(<span class="hljs-string">&quot;redis port after sleep: &quot;</span>, viper.<span class="hljs-built_in">Get</span>(<span class="hljs-string">&quot;redis.port&quot;</span>))<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å…ˆæ‰“å°<code>redis.port</code>çš„å€¼ï¼Œç„¶å<code>Sleep</code> 10sã€‚åœ¨è¿™æœŸé—´ä¿®æ”¹é…ç½®ä¸­<code>redis.port</code>çš„å€¼ï¼Œ<code>Sleep</code>ç»“æŸåå†æ¬¡æ‰“å°ã€‚å‘ç°æ‰“å°å‡ºä¿®æ”¹åçš„å€¼ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">redis port before sleep:</span>  <span class="hljs-number">7381</span><br><span class="hljs-attr">redis port after sleep:</span>  <span class="hljs-number">73810</span><br></code></pre></td></tr></table></figure><p>å¦å¤–ï¼Œè¿˜å¯ä»¥ä¸ºé…ç½®ä¿®æ”¹å¢åŠ ä¸€ä¸ªå›è°ƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cn">viper.OnConfigChange(func(e fsnotify.Event) &#123;<br>fmt.Printf(&quot;Config file:%s Op:%s\n&quot;, e.Name, e.Op)<br>&#125;)<br></code></pre></td></tr></table></figure><p>è¿™æ ·æ–‡ä»¶ä¿®æ”¹æ—¶ä¼šæ‰§è¡Œè¿™ä¸ªå›è°ƒã€‚</p><p>viper ä½¿ç”¨<a href="https://link.zhihu.com/?target=https://github.com/fsnotify/fsnotify">fsnotify</a>è¿™ä¸ªåº“æ¥å®ç°ç›‘å¬æ–‡ä»¶ä¿®æ”¹çš„åŠŸèƒ½ã€‚</p><h2 id="Viperå®ä¾‹ï¼š"><a href="#Viperå®ä¾‹ï¼š" class="headerlink" title="Viperå®ä¾‹ï¼š"></a>Viperå®ä¾‹ï¼š</h2><p>Viper å¯ä»¥å¼€ç®±å³ç”¨ã€‚æ— éœ€é…ç½®æˆ–åˆå§‹åŒ–ï¼Œå°±å¯ä»¥ä½¿ç”¨ Viperã€‚ç”±äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºéƒ½å¸Œæœ›ä½¿ç”¨å•ä¸ªä¸­å¤®å­˜å‚¨åº“è¿›è¡Œé…ç½®ï¼Œå› æ­¤ viper åŒ…æä¾›äº†æ­¤åŠŸèƒ½ã€‚å®ƒç±»ä¼¼äºå•ä¾‹æ¨¡å¼ã€‚</p><p>åœ¨ä¸Šé¢çš„æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œä»–ä»¬éƒ½ä»¥å•ä¾‹æ¨¡å¼é£æ ¼æ¼”ç¤ºäº†ä½¿ç”¨ Viper çš„ä½¿ç”¨æ–¹æ³•</p><p>æ‚¨è¿˜å¯ä»¥åˆ›å»ºè®¸å¤šä¸åŒçš„ Viper å®ä¾‹ï¼Œä¾›åº”ç”¨ç¨‹åºä½¿ç”¨ã€‚æ¯ä¸ªéƒ½æœ‰å…¶ç‹¬ç‰¹çš„é…ç½®å’Œå€¼é›†ã€‚æ¯ä¸ªéƒ½å¯ä»¥ä»ä¸åŒçš„é…ç½®æ–‡ä»¶ç­‰è¯»å–ã€‚Viper åŒ…æ”¯æŒçš„æ‰€æœ‰å‡½æ•°éƒ½é•œåƒä¸º Viper ä¸Šçš„æ–¹æ³•ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go">x := viper.New()<br>y := viper.New()<br><br>x.SetDefault(<span class="hljs-string">&quot;ContentDir&quot;</span>, <span class="hljs-string">&quot;content&quot;</span>)<br>y.SetDefault(<span class="hljs-string">&quot;ContentDir&quot;</span>, <span class="hljs-string">&quot;foobar&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>å½“ä½¿ç”¨å¤šä¸ª Viper æ—¶ï¼Œç”±ç”¨æˆ·ç®¡ç†ä¸åŒçš„ Viperã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Go</category>
      
      <category>Viper</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Viper</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ğŸ¤—ï¸æ€æ ·å†™å•å…ƒæµ‹è¯•ä¸å¦‚ä½•åˆ¤æ–­sliceä¸­çš„ä¸€ä¸ªå…ƒç´ </title>
    <link href="/2022/08/13/%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95/"/>
    <url>/2022/08/13/%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<p>Goä¸­æ²¡æœ‰å¯ä»¥ç›´æ¥åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨sliceä¸­çš„å‡½æ•°ï¼Œæ‰€ä»¥ç”¨äºåˆ¤æ–­çš„æ–¹æ³•æœ‰éå†ï¼Œè¿˜æœ‰æ”¹è¿›ç‚¹çš„æ„å»ºMapï¼Œç”¨SortåŒ…ï¼Œé‚£åˆ°åº•æ˜¯Mapå¥½è¿˜æ˜¯SortåŒ…å¥½å‘¢ï¼Œæˆ‘ä»¬åšä¸ªå•å…ƒæµ‹è¯•å°±çŸ¥é“äº†ã€‚</p><span id="more"></span><h1 id="ğŸ¤—ï¸æ€æ ·å†™å•å…ƒæµ‹è¯•ä¸å¦‚ä½•åˆ¤æ–­sliceä¸­çš„ä¸€ä¸ªå…ƒç´ "><a href="#ğŸ¤—ï¸æ€æ ·å†™å•å…ƒæµ‹è¯•ä¸å¦‚ä½•åˆ¤æ–­sliceä¸­çš„ä¸€ä¸ªå…ƒç´ " class="headerlink" title="ğŸ¤—ï¸æ€æ ·å†™å•å…ƒæµ‹è¯•ä¸å¦‚ä½•åˆ¤æ–­sliceä¸­çš„ä¸€ä¸ªå…ƒç´ "></a>ğŸ¤—ï¸æ€æ ·å†™å•å…ƒæµ‹è¯•ä¸å¦‚ä½•åˆ¤æ–­sliceä¸­çš„ä¸€ä¸ªå…ƒç´ </h1><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5555r4z1xj21900u0n76.jpg"></p><h2 id="å•å…ƒæµ‹è¯•ä¸æ€§èƒ½æµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•ä¸æ€§èƒ½æµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•ä¸æ€§èƒ½æµ‹è¯•"></a>å•å…ƒæµ‹è¯•ä¸æ€§èƒ½æµ‹è¯•</h2><blockquote><p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦ç”¨äº†Goçš„testingåŒ…ã€‚</p></blockquote><p><strong>ç™½ç›’æµ‹è¯•ï¼š</strong>æµ‹è¯•ä»£ç å’Œè¦æµ‹è¯•çš„ä»£ç æ”¾åœ¨åŒä¸€åŒ…ä¸­ï¼Œæµ‹è¯•ä»£ç å¯ä»¥è¯»å–åˆ°è¯¥åŒ…ä¸­çš„ä¸å¯å¯¼å‡ºå˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç¼–å†™éœ€è¦è®¿é—®åˆ°ä¸å¯å¯¼å‡ºå˜é‡ã€å‡½æ•°ã€å¸¸é‡çš„æµ‹è¯•ä»£ç æ—¶å°±è¦ç”¨è¿™ç§æ–¹æ³•ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯è¾ƒä¸ºæ¨èçš„æ–¹æ³•ã€‚</p><p><strong>é»‘ç›’æµ‹è¯•ï¼š</strong>å¯ä»¥ä¸æ”¾åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œä½†åªèƒ½æµ‹è¯•å¯å¯¼å‡ºçš„æ ‡ç¤ºç¬¦ã€‚</p><blockquote><p>æµ‹è¯•æ–‡ä»¶çš„è§„èŒƒè¦æ±‚ï¼šæµ‹è¯•æ–‡ä»¶å‘½åè§„èŒƒã€å‡½æ•°åè§„èŒƒã€å˜é‡åè§„èŒƒ</p></blockquote><p>æµ‹è¯•æ–‡ä»¶åè§„èŒƒï¼šGoçš„æµ‹è¯•æ–‡ä»¶åå¿…é¡»ä»¥_test.goç»“å°¾ï¼Œå› ä¸ºGoå°±æ˜¯åˆ©ç”¨è¿™ä¸ªå»åˆ¤æ–­å“ªäº›æ˜¯æµ‹è¯•æ–‡ä»¶ï¼Œå“ªäº›æ˜¯æ­£å¼æ–‡ä»¶çš„ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œ<code>go test</code>å‘½ä»¤æ—¶ï¼Œè¿™äº›æ–‡ä»¶ä¼šç»™æ‰§è¡Œï¼Œè€Œåœ¨æ„å»ºç¨‹åºæ—¶åˆ™ä¼šå¿½ç•¥è¿™äº›æ–‡ä»¶ã€‚</p><p>å‡½æ•°åè§„èŒƒï¼šæµ‹è¯•å‡½æ•°å¿…é¡»ä½¿ç”¨Test&#x2F;Benchmark&#x2F;Exampleå¼€å¤´ï¼Œä¾‹å¦‚TestXxxã€BenchmarkXxxã€ExampleXxxï¼ŒXxxé€šå¸¸æ˜¯è¦æµ‹è¯•çš„å‡½æ•°åã€‚</p><p>å˜é‡åè§„èŒƒï¼šGoæ²¡æœ‰å¯¹å˜é‡åæœ‰ç¡¬æ€§çš„è¦æ±‚ï¼Œä½†ä¸ºäº†æ¸…æ™°çš„è¡¨è¾¾å‡½æ•°çš„å®é™…è¾“å‡ºå’Œé¢„æœŸè¾“å‡ºï¼Œå¯ä»¥å°†è¿™ä¸¤ç±»è¾“å‡ºå‘½åä¸ºexpected&#x2F;actualæˆ–è€…got&#x2F;wantã€‚</p><h3 id="ğŸ¤”å•å…ƒæµ‹è¯•ï¼š"><a href="#ğŸ¤”å•å…ƒæµ‹è¯•ï¼š" class="headerlink" title="ğŸ¤”å•å…ƒæµ‹è¯•ï¼š"></a>ğŸ¤”å•å…ƒæµ‹è¯•ï¼š</h3><p>å•å…ƒæµ‹è¯•çš„æµ‹è¯•ç”¨ä¾‹å‡½æ•°ä»¥Testå¼€å¤´ï¼Œå‡½æ•°å‚æ•°å¿…é¡»æ˜¯<code>*tesing.T</code>ï¼Œå¯ä»¥ç”¨è¯¥ç±»å‹æ¥è®°å½•é”™è¯¯æˆ–æµ‹è¯•çŠ¶æ€ã€‚</p><blockquote><p>è‡³æ­¤æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªæ€»ç»“ï¼Œè¦å†™ä¸€ä¸ªå•å…ƒæµ‹è¯•å¿…è¦çš„è§„èŒƒï¼Œ1.æ–‡ä»¶åä»¥_test.goç»“å°¾ï¼Œ2.å‡½æ•°åä»¥Testå¼€å¤´ï¼Œ3.å‡½æ•°å‚æ•°ä¸º<code>testing.T</code></p></blockquote><p>æˆ‘ä»¬å¯ä»¥è°ƒç”¨ <code>testing.T</code> çš„ <code>Error</code> ã€<code>Errorf</code> ã€<code>FailNow</code> ã€<code>Fatal</code> ã€<code>FatalIf</code> æ–¹æ³•ï¼Œæ¥è¯´æ˜æµ‹è¯•ä¸é€šè¿‡ï¼›è°ƒç”¨ <code>Log</code> ã€<code>Logf</code> æ–¹æ³•æ¥è®°å½•æµ‹è¯•ä¿¡æ¯ã€‚å‡½æ•°åˆ—è¡¨å’Œç›¸å…³æè¿°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>å‡½æ•°</th><th>æè¿°</th></tr></thead><tbody><tr><td>t.Log, t.Logf</td><td>æ­£å¸¸ä¿¡æ¯</td></tr><tr><td>t.Error, t.Errorf</td><td>æµ‹è¯•å¤±è´¥ä¿¡æ¯</td></tr><tr><td>t.Fatal, t.Fatalf</td><td>è‡´å‘½é”™è¯¯ï¼Œæµ‹è¯•ç¨‹åºé€€å‡ºçš„ä¿¡æ¯</td></tr><tr><td>t.Fail</td><td>å½“å‰æµ‹è¯•æ ‡è®°ä¸ºå¤±è´¥</td></tr><tr><td>t.Failed</td><td>æŸ¥çœ‹å¤±è´¥æ ‡è®°</td></tr><tr><td>t.FailNow</td><td>æ ‡è®°å¤±è´¥ï¼Œå¹¶ç»ˆæ­¢å½“å‰æµ‹è¯•å‡½æ•°çš„æ‰§è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åªèƒ½åœ¨è¿è¡Œæµ‹è¯•å‡½æ•°çš„Goroutineä¸­è°ƒç”¨t.FailNowæ–¹æ³•ï¼Œè€Œä¸èƒ½åœ¨æˆ‘ä»¬æµ‹è¯•ä»£ç åˆ›å»ºå‡ºçš„Goroutineä¸­è°ƒç”¨å®ƒ</td></tr></tbody></table><p><strong>ä¸€ä¸ªæ —å­ğŸŒ°ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//math.go</span><br><br><span class="hljs-keyword">package</span> Test<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;math&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Abs</span><span class="hljs-params">(a <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span> &#123;<br>b := <span class="hljs-type">float64</span>(a)<br><span class="hljs-keyword">return</span> <span class="hljs-type">int</span>(math.Abs(b))<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> Test<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;testing&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAbs</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br>got := Abs(<span class="hljs-number">-1</span>)<br><span class="hljs-keyword">if</span> got != <span class="hljs-number">1</span> &#123;<br>t.Error(<span class="hljs-string">&quot;fault&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>t.Log(<span class="hljs-string">&quot;right&quot;</span>)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">ç»ˆç«¯æ‰§è¡Œå‘½ä»¤</span><br><br>go test &quot;math.go&quot; &quot;math_test.go&quot;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">å¦‚æœæƒ³æ‰§è¡Œæ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹é‚£å°±ç›´æ¥go <span class="hljs-built_in">test</span>å³å¯</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">ä¹Ÿå¯ä»¥ç”¨go <span class="hljs-built_in">test</span>çš„å‚æ•°æ¥å®Œæˆæ‰§è¡ŒæŒ‡å®šçš„å‡½æ•°</span><br></code></pre></td></tr></table></figure><p>go testæ”¯æŒä¸€ä¸‹ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li><p>-vï¼Œæ˜¾ç¤ºæ‰€æœ‰æµ‹è¯•å‡½æ•°çš„è¿è¡Œç»†èŠ‚ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">pengxj@PEngxJdeMacBook-Pro test % go test -v &quot;math.go&quot; &quot;math_test.go&quot; <br>=== RUN   TestAbs<br>    math_test.go:10: right<br>--- PASS: TestAbs (0.00s)<br>PASS<br>ok      command-line-arguments  0.612s<br></code></pre></td></tr></table></figure></li><li><p>-run &lt; regexp&gt;ï¼ŒæŒ‡å®šè¦æ‰§è¡Œçš„æµ‹è¯•å‡½æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">pengxj@PEngxJdeMacBook-Pro test % go test -run &quot;TestAbs&quot;             <br>PASS<br>ok      test    0.608s<br></code></pre></td></tr></table></figure></li><li><p>-count Nï¼ŒæŒ‡å®šæ‰§è¡Œæµ‹è¯•å‡½æ•°çš„æ¬¡æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">pengxj@PEngxJdeMacBook-Pro test % go test -v -run &quot;TestAbs&quot; -count=2<br>=== RUN   TestAbs<br>    math_test.go:10: right<br>--- PASS: TestAbs (0.00s)<br>=== RUN   TestAbs<br>    math_test.go:10: right<br>--- PASS: TestAbs (0.00s)<br>PASS<br>ok      test    0.087s<br></code></pre></td></tr></table></figure></li></ul><p><strong>å¤šä¸ªæµ‹è¯•ç”¨ä¾‹ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAbs_2</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br>tests:=[]<span class="hljs-keyword">struct</span>&#123;<br>x <span class="hljs-type">int</span><br>want <span class="hljs-type">int</span><br>&#125;&#123;<br>&#123;<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>&#125;,<br>&#123;<span class="hljs-number">-2</span>,<span class="hljs-number">2</span>&#125;,<br>&#123;<span class="hljs-number">-3</span>,<span class="hljs-number">3</span>&#125;,<br>&#125;<br><span class="hljs-keyword">for</span> _,v:=<span class="hljs-keyword">range</span> tests&#123;<br>got:=Abs(v.x)<br><span class="hljs-keyword">if</span> got!=v.want&#123;<br>t.Error(<span class="hljs-string">&quot;fault&quot;</span>)<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>t.Log(<span class="hljs-string">&quot;right&quot;</span>)<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ï¼Œå¹¶ä¸”ç»™å®šäº†å…¥å‚å’Œå¸Œæœ›å¾—åˆ°çš„å€¼ï¼Œæœ€åç”¨å¾ªç¯æµ‹è¯•æ¯ä¸ªç”¨ä¾‹</p><h3 id="è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ğŸ®ï¼š"><a href="#è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ğŸ®ï¼š" class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ğŸ®ï¼š"></a>è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ğŸ®ï¼š</h3><p>é€šè¿‡ä¸Šé¢çš„æ ·ä¾‹æˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸ªå¤§æ¦‚çš„ç»“è®ºï¼šæˆ‘ä»¬ç¼–å†™çš„å•å…ƒæµ‹è¯•å°±æ˜¯ï¼Œè‡ªå·±è®¾å®šå‚æ•°å’Œé¢„æœŸç»“æœå€¼ï¼Œæ¥ç€è°ƒç”¨å‡½æ•°æ¥çœ‹èƒ½ä¸èƒ½è¾¾åˆ°é¢„æœŸï¼Œé€»è¾‘å¹¶ä¸å¤æ‚ï¼Œå¤æ‚çš„åè€Œæ˜¯ä¸Šé¢æåˆ°çš„é‚£å‡ ä¸ªè§„èŒƒã€‚</p><p>æ‰€ä»¥å¤§ç‰›å·²ç»åšå‡ºå·¥å…·æ¥äº†ï¼Œä¼˜ç§€çš„ç”Ÿæˆæµ‹è¯•ä»£ç çš„å·¥å…·ï¼š<code>gotests</code>ã€‚ä¸‹é¢æˆ‘ä»¬è®²ä¸‹ä»–çš„ä½¿ç”¨æ–¹æ³•ï¼š</p><p><strong>ç¬¬ä¸€æ­¥ï¼šä¸‹è½½gotestsåŒ…ï¼š</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">go</span> <span class="hljs-built_in">get</span> -<span class="hljs-keyword">u</span> github.<span class="hljs-keyword">com</span>/cweill/gotests/...<br></code></pre></td></tr></table></figure><p><strong>ç¬¬äºŒæ­¥ï¼šæ‰§è¡Œgotestså‘½ä»¤ï¼š</strong></p><p>gotestså‘½ä»¤æ‰§è¡Œæ ¼å¼ä¸ºï¼š<code>gotests [options] [PATH] [FILE] ...</code>ã€‚gotestså¯ä»¥ä¸º<code>PATH</code>ä¸‹çš„æ‰€æœ‰Goæºç æ–‡ä»¶ä¸­çš„å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ï¼Œä¹Ÿå¯ä»¥åªä¸ºæŸä¸ª<code>FILE</code>ä¸­çš„å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚</p><p>å¸¸ç”¨å‚æ•°ï¼š<code>-all:</code>ä¸ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å‡½æ•°ç”Ÿæˆæµ‹è¯•ä»£ç ã€‚<code>-wï¼š</code>å°†ç”Ÿæˆçš„æµ‹è¯•ä»£ç ç”Ÿæˆåˆ°æŒ‡å®šæ–‡ä»¶ä¸­ï¼Œè€Œä¸æ˜¯å‘½ä»¤è¡Œçª—å£ã€‚<code>-only:</code>æŒ‡å®šè¦å•ç‹¬ç”Ÿæˆå•å…ƒæµ‹è¯•çš„å‡½æ•°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">gotests -only &quot;Abs&quot; -w .<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># -onlyç”¨äºæŒ‡å®šé€‰å®šçš„è¦ç”Ÿæˆå•å…ƒæµ‹è¯•çš„å‡½æ•°</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># â€œ.â€ è¡¨ç¤ºç”Ÿæˆåœ¨è¯¥ç›®å½•ä¸‹</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment"># å¦‚æœæˆ‘ä»¬æ²¡æœ‰åˆ›å»ºç›¸åº”çš„ _test.goæ–‡ä»¶é‚£ä»–å°±ä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚æœæœ‰å°±ä¼šå¾€é‡Œç»§ç»­æ·»åŠ ï¼Œå½“ç„¶å‰ææ˜¯æˆ‘ä»¬æ²¡åœ¨é‚£ä¸ªæ–‡ä»¶ä¸­å·²ç»å†™äº†Testæ–‡ä»¶ï¼Œä¸ç„¶å°±ä¸ä¼šç”Ÿæˆäº†ã€‚</span></span><br></code></pre></td></tr></table></figure><p><strong>ç¬¬ä¸‰æ­¥ï¼Œæ·»åŠ æµ‹è¯•ç”¨ä¾‹ï¼š</strong></p><p>ç”Ÿæˆå®Œæµ‹è¯•ç”¨ä¾‹ï¼Œä½ åªéœ€è¦æ·»åŠ éœ€è¦æµ‹è¯•çš„è¾“å…¥å’Œé¢„æœŸçš„è¾“å‡ºå°±å¯ä»¥äº†ã€‚</p><p>ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œåä¼šå‡ºç°ä¸‹é¢çš„ä»£ç ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> Test<br><br><span class="hljs-keyword">import</span> <span class="hljs-string">&quot;testing&quot;</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAbs</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br><span class="hljs-keyword">type</span> args <span class="hljs-keyword">struct</span> &#123;<br>a <span class="hljs-type">int</span><br>&#125;<br>tests := []<span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>args args<br>want <span class="hljs-type">int</span><br>&#125;&#123;<br><span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Add test cases.</span><br>&#125;<br><span class="hljs-keyword">for</span> _, tt := <span class="hljs-keyword">range</span> tests &#123;<br>t.Run(tt.name, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br><span class="hljs-keyword">if</span> got := Abs(tt.args.a); got != tt.want &#123;<br>t.Errorf(<span class="hljs-string">&quot;Abs() = %v, want %v&quot;</span>, got, tt.want)<br>&#125;<br>&#125;)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬è¦å®Œæˆçš„å°±æ˜¯ä¸Šé¢çš„TODOéƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯æ·»åŠ å‚æ•°å’Œé¢„æœŸç»“æœã€‚<code>name</code> è¡¨ç¤ºè¿™ç»„æ ·ä¾‹çš„å¤‡æ³¨ï¼Œ<code>args</code>è¡¨ç¤ºå‡½æ•°çš„å…¥å‚ï¼Œ <code>want</code>è¡¨ç¤ºæƒ³è¦å¾—åˆ°çš„ç»“æœã€‚ä¾‹å¦‚ä¸‹é¢è¿™æ ·ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">TestAbs</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br><span class="hljs-keyword">type</span> args <span class="hljs-keyword">struct</span> &#123;<br>a <span class="hljs-type">int</span><br>&#125;<br>tests := []<span class="hljs-keyword">struct</span> &#123;<br>name <span class="hljs-type">string</span><br>args args<br>want <span class="hljs-type">int</span><br>&#125;&#123;<br>&#123;<br>name: <span class="hljs-string">&quot;test one&quot;</span>,<br>args: args&#123;<br>a: <span class="hljs-number">1</span>,<br>&#125;,<br>want: <span class="hljs-number">1</span>,<br>&#125;,<br>&#125;<br><span class="hljs-keyword">for</span> _, tt := <span class="hljs-keyword">range</span> tests &#123;<br>t.Run(tt.name, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(t *testing.T)</span></span> &#123;<br><span class="hljs-keyword">if</span> got := Abs(tt.args.a); got != tt.want &#123;<br>t.Errorf(<span class="hljs-string">&quot;Abs() = %v, want %v&quot;</span>, got, tt.want)<br>&#125;<br>&#125;)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ€§èƒ½æµ‹è¯•ï¼š"><a href="#æ€§èƒ½æµ‹è¯•ï¼š" class="headerlink" title="æ€§èƒ½æµ‹è¯•ï¼š"></a>æ€§èƒ½æµ‹è¯•ï¼š</h2><p>æ€§èƒ½æµ‹è¯•çš„å‡½æ•°Benchmarkå¼€å¤´ï¼Œå‡½æ•°å‚æ•°å¿…é¡»æ˜¯<code>*tesing.B</code>,å‡½æ•°å†…æˆ‘ä»¬ä½¿ç”¨<code>b.N</code>æ¥ä½œä¸ºå¾ªç¯æ¬¡æ•°ï¼ŒNä¼šåœ¨è¿è¡Œæ—¶åŠ¨æ€è°ƒæ•´ï¼Œä¸‹é¢å°†æ˜¯æˆ‘ä»¬ç”¨Mapå’ŒSortåŒ…æ¥åˆ¤æ–­å…ƒç´ çš„æ–¹æ³•ï¼Œå’Œæˆ‘ä»¬ä¸ºå…¶ç¼–å†™çš„æ€§èƒ½æµ‹è¯•å‡½æ•°ã€‚æ€»ç»“ä¸€å¥è¯ï¼Œæ€§èƒ½æµ‹è¯•å’Œä¸Šé¢çš„å•å…ƒæµ‹è¯•å·®ä¸å¤šï¼Œéƒ½æ˜¯åœ¨_test.goæ–‡ä»¶ä¸­ï¼Œåªæ˜¯å‡½æ•°åä»¥Benchmarkå¼€å¤´å’Œç”¨äº†<code>*testing.B</code>å‚æ•°ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// ä¸¤ç§åˆ¤æ–­Sliceä¸­å…ƒç´ æ˜¯å¦å­˜åœ¨çš„æ–¹æ³•ï¼š</span><br><br><span class="hljs-keyword">package</span> Test<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;sort&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">makemap</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>)</span></span> <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-keyword">struct</span>&#123;&#125; &#123;<br>tempMap := <span class="hljs-built_in">make</span>(<span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-keyword">struct</span>&#123;&#125;)<br><span class="hljs-keyword">for</span> _, v := <span class="hljs-keyword">range</span> arr &#123;<br>tempMap[v] = <span class="hljs-keyword">struct</span>&#123;&#125;&#123;&#125;<br>&#125;<br><span class="hljs-keyword">return</span> tempMap<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Findbymap</span><span class="hljs-params">(tempMap <span class="hljs-keyword">map</span>[<span class="hljs-type">int</span>]<span class="hljs-keyword">struct</span>&#123;&#125;, n <span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-keyword">if</span> _, ok := tempMap[n]; ok &#123;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Findbysort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>, n <span class="hljs-type">int</span>)</span></span> &#123;<br>sort.Ints(arr)<br><span class="hljs-keyword">if</span> pos := sort.SearchInts(arr, n); pos != <span class="hljs-built_in">len</span>(arr) &#123;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>&#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//æ€§èƒ½æµ‹è¯•ä»£ç </span><br><br><span class="hljs-keyword">package</span> Test<br><br><span class="hljs-keyword">import</span> (<br><span class="hljs-string">&quot;testing&quot;</span><br>)<br><br><span class="hljs-keyword">var</span> arr = []<span class="hljs-type">int</span>&#123;<span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">11</span>, <span class="hljs-number">22</span>, <span class="hljs-number">33</span>, <span class="hljs-number">44</span>, <span class="hljs-number">55</span>, <span class="hljs-number">66</span>, <span class="hljs-number">77</span>, <span class="hljs-number">88</span>, <span class="hljs-number">23</span>, <span class="hljs-number">34</span>, <span class="hljs-number">45</span>, <span class="hljs-number">56</span>, <span class="hljs-number">67</span>, <span class="hljs-number">78</span>, <span class="hljs-number">89</span>&#125;<br><span class="hljs-keyword">var</span> n = <span class="hljs-number">3</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BenchmarkBymap</span><span class="hljs-params">(b *testing.B)</span></span> &#123;<br>tempMap := makemap(arr)<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; b.N; i++ &#123;<br>Findbymap(tempMap, n)<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">BenchmarkBysort</span><span class="hljs-params">(b *testing.B)</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; b.N; i++ &#123;<br>Findbysort(arr, n)<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œå‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">æ–‡ä»¶æŒ‡å®šæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰Benchmarkå‡½æ•°å¦‚ä¸‹ï¼š</span><br>go test -bench=&quot;.*&quot;<br><span class="hljs-meta prompt_">#</span><span class="language-bash">å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šç‰¹å®šå‡½æ•°</span><br>go test -bench=&quot;BenchmarkBymap&quot;<br><br></code></pre></td></tr></table></figure><p>æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">pengxj@PEngxJdeMacBook-Pro test % go test -bench=&quot;.*&quot;<br>goos: darwin<br>goarch: arm64<br>pkg: test<br>BenchmarkBymap-8        243986680                4.892 ns/op<br>BenchmarkBysort-8       11873071                99.28 ns/op<br>PASS<br>ok      test    3.068s<br></code></pre></td></tr></table></figure><p>ç»“æœå¾—çŸ¥ï¼Œåœ¨è¦å¤šæ¬¡æŸ¥è¯¢çš„æƒ…å†µä¸‹ï¼Œæ„å»ºä¸€ä¸ªmapçš„æ•ˆç‡æ˜¯éå¸¸é«˜çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Go</category>
      
      <category>ä»£ç æµ‹è¯•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å•å…ƒæµ‹è¯•ä¸æ€§èƒ½æµ‹è¯•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>â›½å¸¸è§æ’åºç®—æ³•ä¸å®ç°ğŸ“£</title>
    <link href="/2022/08/09/%E5%B8%B8%E8%A7%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
    <url>/2022/08/09/%E5%B8%B8%E8%A7%81%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E4%B8%8E%E5%AE%9E%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<p>å­¦ä¹ å®Œæ•°æ®ç»“æ„ä¸ç®—æ³•çš„è¯¾å·²ç»æœ‰å¾ˆé•¿æ—¶é—´äº†ï¼Œæ’åºç®—æ³•å¿˜çš„ä¸ƒä¸ƒå…«å…«ï¼Œå¥½å¥½å¤ä¹ ä¸€ä¸‹å§</p><p>é¢å¯¹è¿™é“é«˜é¢‘é¢è¯•é¢˜ï¼Œä¸€å®šå¾—å¥½å¥½ç†è§£ä¸‹ã€‚åŒ…æ‹¬äº†å¯¼èˆªæµç¨‹å’ŒTCPè¿æ¥</p><span id="more"></span><h1 id="â›½å¸¸è§æ’åºç®—æ³•ä¸å®ç°ğŸ“£"><a href="#â›½å¸¸è§æ’åºç®—æ³•ä¸å®ç°ğŸ“£" class="headerlink" title="â›½å¸¸è§æ’åºç®—æ³•ä¸å®ç°ğŸ“£"></a>â›½å¸¸è§æ’åºç®—æ³•ä¸å®ç°ğŸ“£</h1><h2 id="æ¦‚è¿°ï¼š"><a href="#æ¦‚è¿°ï¼š" class="headerlink" title="æ¦‚è¿°ï¼š"></a>æ¦‚è¿°ï¼š</h2><p>æ’åºç®—æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š<strong>æ¯”è¾ƒç±»æ’åº</strong>å’Œ<strong>éæ¯”è¾ƒç±»æ’åº</strong></p><p><strong>æ¯”è¾ƒç±»æ’åºï¼š</strong>é€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œç”±äºå…¶æ—¶é—´å¤æ‚åº¦æ— æ³•çªç ´O(nlog<del>2</del>n)ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºéçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åºã€‚</p><p><strong>éæ¯”è¾ƒç±»æ’åº</strong>ï¼šä¸é€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œå®ƒå¯ä»¥çªç ´åŸºäºæ¯”è¾ƒæ’åºçš„æ—¶é—´ä¸‹ç•Œï¼Œä»¥çº¿æ€§æ—¶é—´è¿è¡Œï¼Œå› æ­¤ä¹Ÿç§°ä¸ºçº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åºã€‚ </p><p>å½“å‰å·¥ä¸šç•Œå’Œé¢è¯•æ—¶è€ƒå¯Ÿçš„æ¯”è¾ƒå¤šçš„éƒ½æ˜¯æ¯”è¾ƒç±»æ’åºï¼Œæ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬é‡ç‚¹æ¥å­¦ä¹ ä¸‹æ¯”è¾ƒç±»æ’åºä¸­å¸¸è§çš„ä¸¤ç±»æ’åºï¼š<strong>åˆçº§æ’åº</strong>å’Œ<strong>é«˜çº§æ’åº</strong></p><p><img src="https://pic.rmb.bdstatic.com/bjh/839422a30a824720938d3e4a35f2f5d1.png" alt="å¸¸è§æ’åºçš„æ—¶é—´å¤æ‚åº¦"></p><p><strong>åˆçº§æ’åºï¼š</strong>å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(n^2^)çš„æ’åºï¼Œè¿™äº›çš„é‡è¦æ€§ç›¸å¯¹ä¸é«˜ï¼Œå¤šä»¥äº†è§£ä¸ºä¸»ã€‚</p><p><strong>é«˜çº§æ’åº</strong>ï¼šå¹³å‡æ—¶é—´å¤æ‚åº¦ä¸ºO(nlog<del>2</del>n)çš„æ’åºï¼Œåœ¨å…¬å¸é¢è¯•å’Œä½¿ç”¨è¿™æ–¹é¢ä¸»è¦å°±æ˜¯è¿™å‡ ä¸ªï¼Œä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œæˆ‘ä»¬ä¸€å®šè¦ç†è§£ä»–ä»¬çš„åŸç†å¹¶ä¸”è‡ªå·±èƒ½å¤Ÿå®ç°è¿™ç±»æ’åºç®—æ³•ã€‚</p><h2 id="åˆçº§æ’åºï¼š"><a href="#åˆçº§æ’åºï¼š" class="headerlink" title="åˆçº§æ’åºï¼š"></a>åˆçº§æ’åºï¼š</h2><blockquote><p>æˆ‘ä»¬ä¸»è¦ç†Ÿæ‚‰ä¸‹é€‰æ‹©æ’åºã€æ’å…¥æ’åºã€å†’æ³¡æ’åº</p></blockquote><h3 id="é€‰æ‹©æ’åºï¼š"><a href="#é€‰æ‹©æ’åºï¼š" class="headerlink" title="é€‰æ‹©æ’åºï¼š"></a>é€‰æ‹©æ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)  å› ä¸ºæ¯æ¬¡éƒ½è¦å®Œæ•´åœ°éå†ä¸€æ¬¡æ— åºæ•°ç»„</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^) ä¸€æ ·çš„ï¼Œæ¯æ¬¡éƒ½æ˜¯è¦å®Œæ•´åœ°éå†ä¸€æ¬¡æ— åºæ•°ç»„</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)  ä¸ç”¨å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼šåœ¨ä¹±åºæ•°ç»„ä¸­éå†ï¼Œæ‰¾åˆ°æœ€å°å…ƒç´ ï¼Œæ”¾åˆ°æœ‰åºæ•°ç»„çš„æœ€åé¢ï¼Œå¦‚æ­¤åå¤æœ€åå°±èƒ½å¾—åˆ°æœ‰åºæ•°ç»„ã€‚æ­¥éª¤å°±æ˜¯æ¯æ¬¡éƒ½éå†ä¸€éæ— åºæ•°ç»„ï¼Œæ‰¾åˆ°æœ€å°å…ƒç´ ï¼Œç„¶åä¸æ— åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼ˆåŸç†ä¸Šæ˜¯æ”¾åˆ°æœ‰åºæ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ— åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h543464jifg20mj06w7l2.gif" alt="é€‰æ‹©æ’åº"></p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-keyword">for</span> i := <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">len</span>(arr)<span class="hljs-number">-1</span>; i++ &#123; <span class="hljs-comment">//æ¯æ¬¡éå†æ— åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®</span><br>min := arr[i]<br>pos := i<br>        <span class="hljs-comment">//æ‰¾åˆ°æœ€å°å…ƒç´ </span><br><span class="hljs-keyword">for</span> j := i + <span class="hljs-number">1</span>; j &lt; <span class="hljs-built_in">len</span>(arr); j++ &#123;<br><span class="hljs-keyword">if</span> arr[j] &lt; min &#123;<br>min = arr[j]<br>pos = j<br>&#125;<br>&#125;<br>        <span class="hljs-comment">//ä¸æ— åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ äº¤æ¢</span><br> arr[i],arr[pos]=arr[pos],arr[i]<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ’å…¥æ’åºï¼š"><a href="#æ’å…¥æ’åºï¼š" class="headerlink" title="æ’å…¥æ’åºï¼š"></a>æ’å…¥æ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(n)  æ•°ç»„ä¸ºæœ¬èº«æœ‰åºçš„æƒ…å†µ</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^) é€†åºçš„æƒ…å†µï¼Œæ¯æ¬¡éƒ½è¦ä¸€æ¬¡ä¸å‰é¢æœ‰åºæ•°ç»„å®Œæ•´çš„æ¯”è¾ƒ</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)  ä¸ç”¨å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼šå°†ä¹±åºæ•°ç»„ä¸­çš„å…ƒç´ æ’å…¥åˆ°æœ‰åºæ•°ç»„ä¸­ã€‚æ­¥éª¤æ˜¯æ¯æ¬¡é€‰å–æ— åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä»æœ‰åºæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ å¼€å§‹ä¸€ä¸€åˆ¤æ–­ï¼Œæ‰¾åˆ°ä½ç½®åï¼Œè…¾å‡ºæ’å…¥ä½ç½®åæ’å…¥ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5436dwi6zg20mj0e113f.gif" alt="æ’å…¥æ’åº"></p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>)</span></span>&#123;<br><span class="hljs-keyword">for</span> i:=<span class="hljs-number">1</span>;i&lt;<span class="hljs-built_in">len</span>(arr);i++&#123;  <span class="hljs-comment">// è¿™é‡Œæ¯æ¬¡çš„iä¸ºä¹±åºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡</span><br><span class="hljs-keyword">var</span>(<br>j <span class="hljs-type">int</span><br>temp=arr[i]  <span class="hljs-comment">//åé¢è¦ç§»åŠ¨å…ƒç´ è…¾å‡ºæ’å…¥çš„ç©ºé—´ï¼Œæ‰€ä»¥è¦å…ˆä¿å­˜ä¸‹æ¥</span><br>)<br><span class="hljs-comment">//æŸ¥æ‰¾æ’å…¥ä½ç½®</span><br><span class="hljs-keyword">for</span> j=i<span class="hljs-number">-1</span>;j&gt;=<span class="hljs-number">0</span>;j--&#123;   <span class="hljs-comment">// è¿™é‡Œçš„jæ˜¯æ¯æ¬¡çš„æœ‰åºæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡</span><br><span class="hljs-keyword">if</span> arr[i]&lt;arr[j]&#123; <br><span class="hljs-keyword">continue</span><br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">break</span>  <span class="hljs-comment">//j+1å°±æ˜¯è¦æ’å…¥çš„ä½ç½®äº†</span><br>&#125;<br>&#125;<br><span class="hljs-comment">//ç§»åŠ¨ä½ç½®ï¼Œè…¾å‡ºæ’å…¥ç©ºé—´</span><br><span class="hljs-keyword">for</span> ;i&gt;j+<span class="hljs-number">1</span>;i--&#123;<br>arr[i]=arr[i<span class="hljs-number">-1</span>]<br>&#125;<br>arr[j+<span class="hljs-number">1</span>]=temp<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å†’æ³¡æ’åºï¼š"><a href="#å†’æ³¡æ’åºï¼š" class="headerlink" title="å†’æ³¡æ’åºï¼š"></a>å†’æ³¡æ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)  æ•°ç»„ä¸ºæœ¬èº«æœ‰åºçš„æƒ…å†µ</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šæ•°ç»„ä¸ºé€†åºçš„çŠ¶æ€</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)  ä¸ç”¨å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼šæ¯è¿›è¡Œä¸€æ¬¡æ•´ä¸ªæ•°ç»„ï¼ˆé™¤å»æµ®å‡ºæ°´é¢çš„ï¼‰ä¸¤ä¸¤äº¤æ¢ï¼Œå°±ä¸€å®šä¼šæœ‰è‡³å°‘ä¸€ä¸ªå½“å‰å‰©ä½™æ•°ç»„ä¸­çš„æœ€å¤§å…ƒç´ ä¼šæµ®å‡ºæ°´é¢ã€‚æ­¥éª¤å°±æ˜¯åœ¨æ— åºä¸­ï¼Œä¸æ–­é‡å¤çš„è¿›è¡Œä¸€è¶Ÿä¸¤ä¸¤æ¯”è¾ƒäº¤æ¢ï¼Œæ¯æ¬¡ä¼šæµ®å‡ºä¸€ä¸ªè‡³å¤šä¸ªå…ƒç´ ï¼Œéšç€æµ®å‡ºå…ƒç´ çš„å¢å¤šï¼Œæ¯æ¬¡æ¯”è¾ƒçš„æ¬¡æ•°ä¹Ÿç›¸åº”å‡å°‘ã€‚</p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">sort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>)</span></span>&#123;<br><span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">len</span>(arr);i++&#123;<br><span class="hljs-keyword">for</span> j:=<span class="hljs-number">1</span>;j&lt;<span class="hljs-built_in">len</span>(arr)-i;j++&#123;<br><span class="hljs-keyword">if</span> arr[j]&lt;arr[j<span class="hljs-number">-1</span>]&#123;<br>arr[j<span class="hljs-number">-1</span>],arr[j]=arr[j],arr[j<span class="hljs-number">-1</span>]<br>&#125;<br>&#125;<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="é«˜çº§æ’åºï¼š"><a href="#é«˜çº§æ’åºï¼š" class="headerlink" title="é«˜çº§æ’åºï¼š"></a>é«˜çº§æ’åºï¼š</h2><h3 id="å¿«é€Ÿæ’åºï¼š"><a href="#å¿«é€Ÿæ’åºï¼š" class="headerlink" title="å¿«é€Ÿæ’åºï¼š"></a>å¿«é€Ÿæ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)  é€‰å–çš„pivotå¯ä»¥ï¼Œæ¯æ¬¡éƒ½èƒ½æŠŠæ•°ç»„åˆ†æˆç­‰ä»½çš„ä¸¤ä»½</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šO(n^2^)é€‰å–çš„pivotä¸è¡Œï¼Œåˆ†å‡ºçš„æ•°ç»„çš„å…ƒç´ æ•°é‡ä¸¥é‡ä¸å‡ç­‰</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(1)  ä¸ç”¨å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼Œè¿ç”¨äº†åˆ†æ²»çš„æ€æƒ³ï¼Œæ¯æ¬¡æˆ‘ä»¬éƒ½é€‰å–ä¸€ä¸ªpivotï¼Œå°†åŸæ•°ç»„åˆ†æˆå·¦åŠè¾¹æ•°ç»„å’Œå³åŠè¾¹æ•°ç»„ï¼Œå·¦å­æ•°ç»„éƒ½å°äºpivotï¼Œå³å­æ•°ç»„éƒ½å¤§äºpivotï¼Œå†é€’å½’å¤„ç†è¿™ä¸¤ä¸ªå·¦å³å­æ•°ç»„ã€‚æ­¥éª¤å°±æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œæ˜¯ä¸ºäº†æ–¹ä¾¿é€‰ç”¨äº†æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸ºpivotï¼ŒçœŸå®åº”ç”¨åœºæ™¯ä¸‹å¯èƒ½ä¼šæ ¹æ®æ•°æ®çš„å¤§è‡´æƒ…å†µé€‰æ‹©ç›¸åº”çš„pivotæ¥æé«˜æ•ˆç‡ï¼Œcounterçš„å€¼ç†è§£ä¸ºç»è¿‡åˆ†ç±»åå°äºpivotçš„å·¦å­æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ä½ç½®åŠ 1ï¼Œæ‰€ä»¥æˆ‘ä»¬éå†è¿‡ç¨‹ä¸­é‡åˆ°æ¯”pivotå°çš„å…ƒç´ å°±éƒ½å’Œcounteräº¤æ¢ï¼Œæ‰©å……å·¦å­æ•°ç»„ï¼Œéå†å®Œæˆåï¼Œcounterä½ç½®å§‹ç»ˆä»£è¡¨å·¦å­æ•°ç»„çš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œæ‰€ä»¥æœ€åpivotç›´æ¥ä¸counteräº¤æ¢ä½ç½®ï¼Œå³èƒ½å¾—åˆ°åˆ†å¥½ç±»çš„å·¦å³å­æ•°ç»„ã€‚å†é€’å½’å¤„ç†å·¦å³å­æ•°ç»„ã€‚</p><p>å†è®°ä¸€ä¸‹è‡ªå·±ç–‘æƒ‘çš„ç‚¹ï¼ˆä¸çŸ¥é“ä¸ºå•¥ç–‘æƒ‘ğŸ˜“ï¼‰</p><p><strong>å‰©ä¸‹ä¸¤ä¸ªçš„æƒ…å†µæ˜¯æ€ä¹ˆç»“æŸçš„ï¼Ÿ</strong></p><ol><li><p>å€’åºçš„æƒ…å†µï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼Œpivotè®¾ä¸ºç¬¬äºŒä¸ªå…ƒç´ ï¼Œéå†å®Œæ¯”å®ƒå°çš„å·¦å­æ•°ç»„çš„ä¸‹ä¸€ä½å³ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼ˆæ²¡æœ‰æ¯”å®ƒå°çš„å…ƒç´ ï¼Œcounteræ²¡å˜ï¼‰ï¼Œäº¤æ¢åå°±æ­£åºäº†ï¼Œè¿›å…¥ä¸‹é¢çš„æƒ…å†µã€‚</p></li><li><p>æ­£åºçš„æƒ…å†µï¼ŒæŒ‰ç…§æƒ¯ä¾‹ï¼Œpivotè®¾ä¸ºç¬¬äºŒä¸ªå…ƒç´ ï¼Œéå†ååªæœ‰ä¸€ä¸ªå…ƒç´ æ¯”å®ƒå°ï¼Œæ¯”å®ƒå°çš„å·¦å­æ•°ç»„çš„ä¸‹ä¸€ä½å³ä¸ºç¬¬äºŒä¸ªå…ƒç´ çš„ä½ç½®ï¼Œè¿™æ—¶æˆ‘ä»¬å†é€’å½’å¤„ç†è¿™ä¸¤ä¸ªå­æ•°ç»„ï¼Œæˆ‘ä»¬å…ˆçœ‹å³å­æ•°ç»„ï¼Œæˆ‘ä»¬çš„å·¦è¾¹ç•Œä¼šè®¾ä¸ºcounter+1ï¼Œæœ‰è¾¹ç•Œè¿˜æ˜¯highæ²¡æœ‰å˜ï¼Œè€Œæ­¤æ—¶counter+1å·²ç»å¤§äºhighäº†ï¼Œæ‰€ä»¥å°±ç»“æŸäº†ï¼Œæˆ‘ä»¬å†çœ‹å·¦å­æ•°ç»„ï¼Œæ­¤æ—¶å°±æ˜¯å‰©ä½™ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µäº†ã€‚</p></li><li><p>å‰©ä½™ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µï¼šåˆ¤æ–­ålowç­‰äºhighï¼Œç»“æŸ</p></li></ol><p><strong>å¤æ‚åº¦ä¸ºä»€ä¹ˆO(nlog<del>2</del>n)ï¼š</strong>é¦–å…ˆæ˜¯å‰é¢çš„nï¼Œå‰é¢çš„nä»£è¡¨æ˜¯æ¯ä¸€å±‚åœ¨åš<code>partition</code>çš„æ—¶å€™éƒ½è¦å¤„ç†â€œnâ€æ¬¡ï¼Œlog<del>2</del>nä»£è¡¨è°ƒç”¨æ ˆæœ‰å¤šé«˜ï¼Œæœ€åæƒ…å†µï¼Œè°ƒç”¨æ ˆçš„é«˜åº¦å°±ä¸ºnï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸ºO(n^2^)ã€‚</p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">quicksort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>,low <span class="hljs-type">int</span>,high <span class="hljs-type">int</span>)</span></span>&#123;<br><span class="hljs-keyword">if</span> low&gt;=high&#123;<br><span class="hljs-keyword">return</span><br>&#125;<br>fmt.Println(arr[low:high+<span class="hljs-number">1</span>])<br>pivot:=partition(arr,low,high)<br>quicksort(arr,low,pivot<span class="hljs-number">-1</span>)<br>quicksort(arr,pivot+<span class="hljs-number">1</span>,high)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">partition</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>,begin,end <span class="hljs-type">int</span>)</span></span> <span class="hljs-type">int</span>&#123;<br>pivot,counter:=arr[end],begin<br><span class="hljs-keyword">for</span> i:=begin;i&lt;end;i++&#123;<br><span class="hljs-keyword">if</span> arr[i]&lt;pivot&#123;<br>fmt.Println(arr[i],arr[counter])<br>arr[i],arr[counter]=arr[counter],arr[i]<br>counter++<br>&#125;<br>&#125;<br>arr[counter],arr[end]=arr[end],arr[counter]<br><span class="hljs-keyword">return</span> counter<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å½’å¹¶æ’åºï¼š"><a href="#å½’å¹¶æ’åºï¼š" class="headerlink" title="å½’å¹¶æ’åºï¼š"></a>å½’å¹¶æ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)  å½’å¹¶æ’åºæ¯æ¬¡éƒ½è¦åˆ†åˆ°æœ€å°ï¼Œå†åˆå¹¶ï¼Œæ‰€ä»¥å˜åŒ–ä¸å¤§</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šåŒä¸Š</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)  éœ€è¦å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼Œå…ˆåˆ‡å‰²æˆnä¸ªå­åºåˆ—ï¼Œæœ€å°ä¸º1ï¼Œç„¶åå†åˆå¹¶å­åºåˆ—ï¼ˆå½’å¹¶ï¼‰ï¼Œåœ¨åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¼šä½¿è¿™ä¸¤ä¸ªå­åºåˆ—åˆå¹¶æˆæ•´ä½“æœ‰åºçš„å­åºåˆ—ï¼Œä¸æ–­å°†æ•´ä½“æœ‰åºçš„å­åºåˆ—åˆå¹¶ï¼Œå¹¶ä¸”åˆå¹¶è¿‡ç¨‹å¤¹æœ‰æ’åºï¼Œæœ€ç»ˆå°±èƒ½å¾—åˆ°æœ‰åºçš„åºåˆ—ã€‚æ­¥éª¤å°±æ˜¯ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªååºéå†ï¼Œå…ˆæŠŠæ•°ç»„ä¸€ç›´åˆ‡åˆ†ï¼Œâ€œåœ¨æ ¹ç»“ç‚¹â€åˆå¹¶ï¼ŒæŠŠå·¦å³å­æ ‘ä¸­æ•´ä½“æœ‰åºçš„å­åºåˆ—åˆå¹¶å°±èƒ½æœ€ç»ˆå¾—åˆ°æ•´ä½“æœ‰åºçš„åºåˆ—</p><p><strong>å¤æ‚åº¦ä¸ºä»€ä¹ˆO(nlog<del>2</del>n)ï¼š</strong>å…ˆè¯´åé¢çš„log<del>2</del>nï¼Œå½’å¹¶çš„è°ƒç”¨æ ˆå°±å›ºå®šä¸ºlog<del>2</del>näº†ï¼Œä¸ä¼šåƒå¿«æ’é‚£æ ·æœ‰å˜åŒ–ï¼Œè€Œå‰é¢çš„nä»£è¡¨ç€å°±æ˜¯åœ¨æ¯ä¸€å±‚åˆå¹¶çš„æ—¶å€™éƒ½è¦å¤„ç†â€œnâ€æ¬¡ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h543b37d25g20mj0e1qcv.gif" alt="å½’å¹¶æ’åº"></p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">MergeSort</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>, low, high <span class="hljs-type">int</span>)</span></span> &#123;<br><span class="hljs-keyword">if</span> low &gt;= high &#123;  å¤§äºçš„æƒ…å†µæ˜¯è¶Šç•Œäº†ï¼Œç­‰äºçš„æƒ…å†µæ˜¯ä¸ç”¨å†åˆ†äº†<br><span class="hljs-keyword">return</span><br>&#125;<br>mid := (low + high) &gt;&gt; <span class="hljs-number">1</span><br>fmt.Println(mid)<br>MergeSort(arr, low, mid)<br>MergeSort(arr, mid+<span class="hljs-number">1</span>, high)<br>Merge(arr, low, high, mid)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">Merge</span><span class="hljs-params">(arr []<span class="hljs-type">int</span>, low, high, mid <span class="hljs-type">int</span>)</span></span> &#123;<br>left, right := low, mid+<span class="hljs-number">1</span><br>TempArr := <span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>, high-low+<span class="hljs-number">1</span>)<br>k := <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> left &lt;= mid &amp;&amp; right &lt;= high &#123;<br><span class="hljs-keyword">if</span> arr[left] &lt; arr[right] &#123;<br>TempArr[k] = arr[left]<br>k++<br>left++<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>TempArr[k] = arr[right]<br>k++<br>right++<br>&#125;<br>&#125;<br><span class="hljs-keyword">for</span> left &lt;= mid &#123;<br>TempArr[k] = arr[left]<br>k++<br>left++<br>&#125;<br><span class="hljs-keyword">for</span> right &lt;= high &#123;<br>TempArr[k] = arr[right]<br>k++<br>right++<br>&#125;<br><span class="hljs-built_in">copy</span>(arr[low:high+<span class="hljs-number">1</span>], TempArr)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å †æ’åºï¼š"><a href="#å †æ’åºï¼š" class="headerlink" title="å †æ’åºï¼š"></a>å †æ’åºï¼š</h3><blockquote><p>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)</p><p>æœ€ä¼˜æ—¶é—´å¤æ‚åº¦ï¼šO(nlog<del>2</del>n)  å †æ’åºæ—¶é—´ä¸»è¦åœ¨ç»´æŠ¤å †ä¸Šï¼Œå’Œæ•°ç»„æƒ…å†µæ— å…³</p><p>æœ€å·®æ—¶é—´å¤æ‚åº¦ï¼šåŒä¸Š</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)  éœ€è¦å¼€è¾Ÿæ–°æ•°ç»„</p></blockquote><p>ä¸€å¥è¯ç†è§£ï¼šç”¨åºåˆ—å…ˆç»´æŠ¤ä¸€ä¸ªå †(nlog<del>2</del>n)ï¼Œå†ç”¨å †å¼¹å‡ºå †é¡¶å…ƒç´ åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå®Œæˆæ’åºã€‚å †çš„ç»´æŠ¤æˆ‘ä»¬å¸¸ç”¨è¯­è¨€è‡ªå¸¦çš„æ–¹æ³•æ¥å®ç°ï¼Œä»¥Goä¸ºä¾‹å°±æ˜¯å®ç°æ¥å£çš„æ–¹æ³•ï¼Œå®ƒçš„åº•å±‚å®ç°é‡Œé¢é»˜è®¤å¼¹å‡ºæ—¶ä½¿ç”¨çš„æ–¹æ³•æ˜¯å †é¡¶ä¸æœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œå¼¹å‡ºæœ€åä¸€ä¸ªå…ƒç´ ï¼Œå†è¿›è¡Œå †çš„ç»´æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±è¦å®ç°çš„popæ–¹æ³•å°±æ˜¯è¦å¼¹å‡ºæœ€åä¸€ä¸ªå…ƒç´ ï¼ŒPushæ–¹æ³•ä¹Ÿä¸€æ ·ï¼Œé»˜è®¤æ”¾åœ¨æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå†è¿›è¡Œå †çš„ç»´æŠ¤</p><p><strong>å¤æ‚åº¦ä¸ºä»€ä¹ˆO(nlog<del>2</del>n)ï¼š</strong>åœ¨ç»´æŠ¤å †æ—¶ï¼Œå †çš„ç‰¹æ€§æ¯æ¬¡çš„æ’å…¥å’Œåˆ é™¤éƒ½éœ€è¦log<del>2</del>nï¼Œè€Œè¦æ’å…¥nä¸ªå…ƒç´ ï¼Œæ‰€ä»¥ä¸ºO(nlog<del>2</del>n)</p><p><strong>ä»£ç å®ç°ï¼ˆGoï¼‰ï¼š</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> myHeap []<span class="hljs-type">int</span><br><br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(heap *myHeap)</span></span>Len()<span class="hljs-type">int</span> &#123;<span class="hljs-keyword">return</span>(<span class="hljs-built_in">len</span>(*heap))&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(heap *myHeap)</span></span>Less(i,j <span class="hljs-type">int</span>)<span class="hljs-type">bool</span> &#123;<span class="hljs-keyword">return</span> (*heap)[i]&lt;(*heap)[j] &#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(heap *myHeap)</span></span>Swap(i,j <span class="hljs-type">int</span>) &#123;(*heap)[i],(*heap)[j]=(*heap)[j],(*heap)[i]&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(heap *myHeap)</span></span>Push(x <span class="hljs-keyword">interface</span>&#123;&#125;) &#123;*heap=<span class="hljs-built_in">append</span>(*heap,x.(<span class="hljs-type">int</span>))&#125;<br><span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(heap *myHeap)</span></span>Pop()<span class="hljs-keyword">interface</span>&#123;&#125;&#123;<br><span class="hljs-keyword">var</span> x=(*heap)[<span class="hljs-built_in">len</span>(*heap)<span class="hljs-number">-1</span>] <br>*heap=(*heap)[<span class="hljs-number">0</span>:<span class="hljs-built_in">len</span>(*heap)<span class="hljs-number">-1</span>]<br><span class="hljs-keyword">return</span> x<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>myheap:=&amp;myHeap&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">9</span>,<span class="hljs-number">5</span>,<span class="hljs-number">4</span>&#125;<br>a:=<span class="hljs-built_in">make</span>([]<span class="hljs-type">int</span>,<span class="hljs-built_in">len</span>(*myheap))<br>heap.Init(myheap)<br><span class="hljs-keyword">for</span> i:=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">len</span>(a);i++&#123;<br>a[i]=heap.Pop(myheap).(<span class="hljs-type">int</span>)<br>&#125;<br>fmt.Println(a)<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="å¿«é€Ÿæ’åºä¸å½’å¹¶æ’åºçš„æ¯”è¾ƒï¼š"><a href="#å¿«é€Ÿæ’åºä¸å½’å¹¶æ’åºçš„æ¯”è¾ƒï¼š" class="headerlink" title="å¿«é€Ÿæ’åºä¸å½’å¹¶æ’åºçš„æ¯”è¾ƒï¼š"></a>å¿«é€Ÿæ’åºä¸å½’å¹¶æ’åºçš„æ¯”è¾ƒï¼š</h3><p>å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åºçš„å¹³å‡æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(nlog<del>2</del>n)ï¼Œè€Œå¿«é€Ÿæ’åºçš„æœ€åæƒ…å†µæ˜¯O(n^2^)ï¼Œä½†å¿«æ’è¿˜æ˜¯ä¼˜äºå½’å¹¶ï¼Œå¿«æ’ä¼˜äºå½’å¹¶çš„åœ°æ–¹åœ¨å“ªï¼Ÿ</p><ol><li><p>å¿«é€Ÿæ’åºä¸­æ•ˆç‡çš„ä¸»è¦æ¥æºä¹‹ä¸€æ˜¯å¼•ç”¨ä½ç½®ï¼Œåœ¨å¼•ç”¨ä½ç½®ä¸­ï¼Œè®¡ç®—æœºç¡¬ä»¶ç»è¿‡ä¼˜åŒ–ï¼Œå› æ­¤è®¿é—®å½¼æ­¤ç›¸é‚»çš„å†…å­˜ä½ç½®å¾€å¾€æ¯”è®¿é—®åˆ†æ•£åœ¨æ•´ä¸ªå†…å­˜ä¸­çš„å†…å­˜ä½ç½®æ›´å¿«ã€‚quicksortä¸­çš„åˆ†åŒºæ­¥éª¤é€šå¸¸å…·æœ‰å¾ˆå¥½çš„å±€éƒ¨æ€§ï¼Œå› ä¸ºå®ƒè®¿é—®å‰é¢å’Œåé¢é™„è¿‘çš„è¿ç»­æ•°ç»„å…ƒç´ ã€‚å› æ­¤ï¼Œå¿«é€Ÿæ’åºå¾€å¾€æ¯”å…¶ä»–æ’åºç®—æ³•ï¼ˆå¦‚heapsortï¼‰æ‰§è¡Œå¾—æ›´å¥½ï¼Œå°½ç®¡å®ƒé€šå¸¸æ‰§è¡Œå¤§è‡´ç›¸åŒæ•°é‡çš„æ¯”è¾ƒå’Œäº¤æ¢ï¼Œå› ä¸ºåœ¨heapsortçš„æƒ…å†µä¸‹ï¼Œè®¿é—®æ›´åŠ åˆ†æ•£ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªåŸå› æ˜¯è®¡ç®—æœºç¡¬ä»¶ç»è¿‡ä¼˜åŒ–ï¼Œè®¿é—®å½¼æ­¤ç›¸é‚»çš„å†…å­˜ä½ç½®å¾€å¾€æ¯”è®¿é—®åˆ†æ•£åœ¨æ•´ä¸ªå†…å­˜ä¸­çš„å†…å­˜ä½ç½®æ›´å¿«ï¼Œæ‰€ä»¥å¿«é€Ÿæ’åºæˆ‘ä»¬åœ¨åˆ’åˆ†æ•°ç»„çš„æ—¶å€™ï¼Œå…ƒç´ éƒ½æ˜¯ç›¸é‚»çš„ï¼Œè€Œå½’å¹¶æ’åºåœ¨åˆå¹¶çš„æ—¶å€™æ˜¯å…ƒç´ è¾ƒä¸ºåˆ†æ•£ï¼Œæ‰€ä»¥åœ¨è¿™ä¸€ç‚¹ä¸Šå¿«æ’ä¼˜äºå½’å¹¶</p></li><li><p>å¦ä¸€ä¸ªæ™®ééƒ½çŸ¥é“çš„åŸå› å°±æ˜¯å¿«æ’æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨åŸæ•°ç»„ä¸Šæ“ä½œï¼Œè€Œå½’å¹¶æ’åºæˆ‘ä»¬åœ¨åˆå¹¶çš„æ—¶å€™éœ€è¦é‡æ–°å¼€è¾Ÿæ•°ç»„ï¼ˆç©ºé—´å¤æ‚åº¦ä¸ºO(n)ï¼‰ï¼Œè¿˜è¦è¿›è¡Œå¤šæ¬¡çš„èµ‹å€¼çš„æ“ä½œï¼Œæ‰€ä»¥åœ¨è¿™ä¸€ç‚¹ä¸Šè®©å¿«æ’ä¼˜äºå½’å¹¶ã€‚</p></li></ol><p><strong>å’Œå †æ’åºçš„ç›¸æ¯”ï¼š</strong>åœ¨ç»´æŠ¤å †çš„æ—¶å€™ï¼Œå †æ’é‡Œé¢æœ‰å¤§é‡è¿‘ä¹æ— æ•ˆçš„æ¯”è¾ƒï¼Œå› ä¸ºè¢«æ‹¿åˆ°å †é¡¶çš„é‚£ä¸ªå…ƒç´ å‡ ä¹è‚¯å®šæ˜¯å¾ˆå°çš„ï¼Œè€Œé è¿‘å †é¡¶çš„å…ƒç´ åˆå‡ ä¹è‚¯å®šæ˜¯å¾ˆå¤§çš„ï¼Œå°†ä¸€ä¸ªå¾ˆå°çš„æ•°å’Œä¸€ä¸ªå¾ˆå¤§çš„æ•°æ¯”è¾ƒï¼Œç»“æœå‡ ä¹è‚¯å®šæ˜¯â€œå°äºâ€çš„ï¼Œè¿™å°±æ„å‘³ç€é—®é¢˜çš„å¯èƒ½æ€§åªè¢«æ’é™¤æ‰äº†å¾ˆå°ä¸€éƒ¨åˆ†ã€‚</p><p>æ‰€ä»¥å †æ’è™½ç„¶å’Œå¿«æ’ä¸€æ ·å¤æ‚åº¦éƒ½æ˜¯O(nlog<del>2</del>n)ä½†å †æ’å¤æ‚åº¦çš„å¸¸ç³»æ•°æ›´å¤§</p>]]></content>
    
    
    <categories>
      
      <category>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</category>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æ•°æ®ç»“æ„ä¸ç®—æ³•</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ğŸ¤¯ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆï¼ŸğŸ¤¬</title>
    <link href="/2022/08/07/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%EF%BC%8C%E8%BF%99%E4%B8%AD%E9%97%B4%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/"/>
    <url>/2022/08/07/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%B1%95%E7%A4%BA%EF%BC%8C%E8%BF%99%E4%B8%AD%E9%97%B4%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88/</url>
    
    <content type="html"><![CDATA[<p>é¢å¯¹è¿™é“é«˜é¢‘é¢è¯•é¢˜ï¼Œä¸€å®šå¾—å¥½å¥½ç†è§£ä¸‹ã€‚åŒ…æ‹¬äº†å¯¼èˆªæµç¨‹å’ŒTCPè¿æ¥</p><span id="more"></span><h1 id="ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆ"><a href="#ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆ" class="headerlink" title="ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆ?"></a>ä»è¾“å…¥URLåˆ°é¡µé¢å±•ç¤ºï¼Œè¿™ä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆ?</h1><p><img src="https://static001.geekbang.org/resource/image/71/e3/714208d4e10499868688361130d1d2e3.jpg"></p><h2 id="ä¸‰ä¸ªè¿›ç¨‹ï¼š"><a href="#ä¸‰ä¸ªè¿›ç¨‹ï¼š" class="headerlink" title="ä¸‰ä¸ªè¿›ç¨‹ï¼š"></a>ä¸‰ä¸ªè¿›ç¨‹ï¼š</h2><p><strong>æµè§ˆå™¨è¿›ç¨‹ï¼š</strong>ä¸»è¦è´Ÿè´£ç”¨æˆ·çš„äº¤äº’ã€å­è¿›ç¨‹çš„æ§åˆ¶å’Œæ–‡ä»¶å­˜å‚¨çš„æœåŠ¡</p><p><strong>ç½‘ç»œè¿›ç¨‹</strong>ï¼šä¸»è¦è´Ÿè´£ä¸ºæµè§ˆå™¨è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹æä¾›ä¸‹è½½åŠŸèƒ½</p><p><strong>æ¸²æŸ“è¿›ç¨‹ï¼š</strong>å¯¹æ¥å—çš„javascriptï¼Œcssï¼Œhtmlã€å›¾ç‰‡ç­‰èµ„æºè§£ææˆå¯ä»¥æ˜¾ç¤ºå’Œäº¤äº’çš„ç•Œé¢</p><h2 id="æµç¨‹ï¼š"><a href="#æµç¨‹ï¼š" class="headerlink" title="æµç¨‹ï¼š"></a>æµç¨‹ï¼š</h2><ol><li>ç”¨æˆ·è¾“å…¥URLå›è½¦åï¼Œæµè§ˆå™¨è¿›ç¨‹å…ˆåˆ¤æ–­è¾“å…¥çš„å†…å®¹æ˜¯å¦ä¸ºæœç´¢å†…å®¹ï¼Œæ˜¯çš„è¯å°±ä¼šæ ¹æ®æµè§ˆå™¨çš„é»˜è®¤æœç´¢å¼•æ“ï¼Œç»„æˆæ–°çš„å¸¦æœ‰æœç´¢å†…å®¹çš„URLã€‚å¦‚æœè¾“å…¥çš„å†…å®¹ç¬¦åˆURLè§„åˆ™ï¼Œé‚£å°±ä¼šé€‰ç”¨ç›¸åº”çš„åè®®ï¼Œä¸€èˆ¬ç°åœ¨çš„ç½‘ç«™éƒ½æ˜¯HTTPSï¼Œç»„æˆæ–°çš„URLã€‚</li><li>æµè§ˆå™¨è¿›ç¨‹ä¼šé€šè¿‡è¿›ç¨‹é—´é€šä¿¡ï¼ˆIPCï¼‰ï¼Œå‘ç½‘ç»œè¿›ç¨‹å‘é€URLè¯·æ±‚ï¼Œç”±ç½‘ç»œè¿›ç¨‹çœŸæ­£è¿›è¡ŒURLè¯·æ±‚ã€‚</li><li>è·å¾—URLåï¼Œç½‘ç»œè¿›ç¨‹ä¸æ˜¯ç›´æ¥å°±å¼€å§‹è¯·æ±‚çš„æ­¥éª¤ï¼Œè€Œæ˜¯å…ˆæŸ¥æ‰¾æœ¬åœ°ç¼“å­˜æ˜¯å¦ç¼“å­˜äº†è¯¥èµ„æºã€‚å¦‚æœæœ‰æ‰¾åˆ°ç¼“å­˜èµ„æºåˆ™ç»“æŸè¯·æ±‚ï¼Œç›´æ¥æŠŠèµ„æºè¿”å›ç»™æµè§ˆå™¨è¿›ç¨‹ã€‚æ²¡æœ‰å†è¿›è¡Œæ¥ä¸‹æ¥çš„æ­¥éª¤ã€‚</li><li>URLè¯·æ±‚ç¬¬ä¸€æ­¥æ˜¯æ‰¾ç›®æ ‡æœåŠ¡å™¨çš„åœ°å€å’Œç«¯å£å·ï¼Œä¹Ÿå°±æ˜¯åŸŸåè§£æï¼Œé¦–å…ˆä¼šåœ¨æœ¬åœ°çš„åŸŸåè§£æç¼“å­˜ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰è¯¥åŸŸåçš„ç¼“å­˜è®°å½•ï¼Œæœ‰åˆ™ä¼šç›´æ¥ä½¿ç”¨è¯¥åœ°å€å’Œç«¯å£å·ï¼Œæœ¬åœ°ç¼“å­˜æ²¡æœ‰å†ä¼šå‘DNSæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè·å¾—æœåŠ¡å™¨åœ°å€å’Œç«¯å£å·ã€‚å¦‚æœè·å–åˆ°çš„åªæœ‰IPåœ°å€ï¼Œåˆ™ä¼šä½¿ç”¨é»˜è®¤çš„ç«¯å£å·ï¼ŒHTTPé»˜è®¤æ˜¯80è€ŒHTTPSé»˜è®¤çš„æ˜¯HTTPSã€‚å¦‚æœæ˜¯HTTPSåè®®ï¼Œè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªæ­¥éª¤ï¼šå»ºç«‹TLSè¿æ¥ã€‚</li><li>æ¥ä¸‹æ¥å°±æ˜¯ä½¿ç”¨IPåœ°å€ä¸æœåŠ¡å™¨è¿›è¡ŒTCPè¿æ¥</li></ol><h3 id="TCPè¿æ¥ï¼š"><a href="#TCPè¿æ¥ï¼š" class="headerlink" title="TCPè¿æ¥ï¼š"></a>TCPè¿æ¥ï¼š</h3><p><img src="https://pic.rmb.bdstatic.com/bjh/d5169b6fc8b3fad501c31afb19f037ff.jpeg" alt="TCPç»“æ„"></p><h4 id="ğŸ˜Šä¸‰æ¬¡æ¡æ‰‹ï¼š"><a href="#ğŸ˜Šä¸‰æ¬¡æ¡æ‰‹ï¼š" class="headerlink" title="ğŸ˜Šä¸‰æ¬¡æ¡æ‰‹ï¼š"></a>ğŸ˜Šä¸‰æ¬¡æ¡æ‰‹ï¼š</h4><p><strong>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š</strong> æ­¤æ¬¡è¿‡ç¨‹ä¸ºTCPå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†é¦–éƒ¨çš„åŒæ­¥ä½SYNè®¾ä¸º1ï¼Œè¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå¹¶ä¸ºåºå·å­—æ®µï¼ˆseqï¼‰è®¾ç½®ä¸€ä¸ªå€¼xï¼Œï¼ˆè¿™ä¸ªåºå·ä¼šç»™æ¶ˆè€—æ‰ï¼Œå³æ¥ä¸‹æ¥çš„æŠ¥æ–‡æ®µè¦ç”¨x+1ï¼Œå› ä¸ºTCPè§„å®šSYNè®¾ç½®ä¸º1åä¸å¯æºå¸¦æ•°æ®ï¼Œä½†ä¼šæ¶ˆè€—æ‰ä¸€ä¸ªåºå·ï¼‰ä½œä¸ºTCPå®¢æˆ·ç«¯æ‰€é€‰æ‹©çš„åˆå§‹åºå·ï¼Œå¹¶è¿›å…¥åŒæ­¥å·²å‘é€é˜¶æ®µã€‚</p><p><strong>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š</strong>TCPæœåŠ¡å™¨ç«¯æ¥å—åˆ°å®¢æˆ·ç«¯å‘æ¥è¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µåï¼Œå¦‚æœåŒæ„è¿æ¥ï¼Œä¼šå¾€å®¢æˆ·ç«¯å†å‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†é¦–éƒ¨çš„åŒæ­¥ä½SYNå’Œç¡®è®¤ä¸ºACKéƒ½è®¾ä¸º1ï¼Œè¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºè¿æ¥è¯·æ±‚ç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶ä¸ºåºå·å­—æ®µï¼ˆseqï¼‰è®¾ç½®ä¸€ä¸ªå€¼yï¼Œä½œä¸ºTCPæœåŠ¡å™¨è¿›ç¨‹æ‰€é€‰æ‹©çš„åˆå§‹åºå·ï¼Œç¡®è®¤å·å­—æ®µè®¾ä¸ºx+1ï¼Œè¿™æ˜¯å¯¹TCPå®¢æˆ·ç«¯æ‰€é€‰æ‹©çš„åˆå§‹åºå·çš„ç¡®è®¤ã€‚åŒæ—¶è¿›å…¥åŒæ­¥å·±æ¥å—é˜¶æ®µ</p><p><strong>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š</strong>TCPå®¢æˆ·ç«¯æ¥å—åˆ°è¯·æ±‚è¿æ¥ç¡®è®¤æŠ¥æ–‡æ®µåï¼Œä¼šå¾€æœåŠ¡å™¨ç«¯å†å‘é€ä¸€æ¬¡TCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†ç¡®è®¤ä½ACKè®¾ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶å°†åºå·è®¾ç½®ä¸ºx+1ï¼ˆTCPè§„å®šæ™®é€šçš„ç¡®è®¤æŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œå¦‚æœè¿™æ¬¡æŠ¥æ–‡æ®µä¸­æœ‰æºå¸¦æ•°æ®é‚£è¿™ä¸ªåºå·å°†ä¼šç»™æ¶ˆè€—æ‰ï¼Œå¦‚æœæ²¡æœ‰æºå¸¦ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡å‘é€TCPè¯·æ±‚æ—¶åˆ™è¿˜å¯ä»¥ç»§ç»­ç”¨è¿™ä¸ªx+1ï¼‰ï¼Œç¡®è®¤å·è®¾ç½®ä¸ºy+1,è¿™æ˜¯å¯¹æœåŠ¡å™¨çš„åˆå§‹åºå·çš„ç¡®è®¤ã€‚å‘é€å®Œæˆåï¼Œå®¢æˆ·ç«¯è¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡æ®µåä¹Ÿè¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡ï¼Œä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿ</strong></p><p>è¿™æ˜¯å› ä¸ºTCPä¸ºäº†ä¿è¯è¿æ¥çš„å¯é æ€§ï¼Œå§‹ç»ˆè®¤ä¸ºç½‘ç»œå±‚æ˜¯ä¸å¯é çš„ï¼Œå¦‚æœæ˜¯ä¸¤æ¬¡æ¡æ‰‹é‚£TCPæœåŠ¡å™¨ç«¯åœ¨å‘é€å®ŒTCPè¯·æ±‚è¿æ¥ç¡®è®¤æŠ¥æ–‡æ®µåå°±ä¼šè¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ï¼Œè¿™é‡Œå°±å­˜åœ¨ä¸€ç§å¯èƒ½ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µå‰ï¼Œå› ä¸ºç½‘ç»œé—®é¢˜ï¼Œå®¢æˆ·ç«¯ä¸€ç›´æ²¡æ¥å—åˆ°è¯·æ±‚è¿æ¥ç¡®è®¤æŠ¥æ–‡æ®µå·²ç»å‘é€äº†å¥½å‡ ä¸ªè¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µï¼Œè€Œç­‰åˆ°TCPæœåŠ¡å™¨ç«¯æ¥å—åˆ°TCPè¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µï¼ŒTCPå®¢æˆ·ç«¯æ¥å—åˆ°è¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µï¼Œå¹¶å®Œæˆäº†æ•°æ®ä¼ è¾“ï¼Œå››æ¬¡æŒ¥æ‰‹æ–­å¼€è¿æ¥åï¼Œä¹‹å‰é‚£äº›æ²¡èƒ½åˆ°è¾¾æœåŠ¡å™¨ç«¯çš„TCPè¯·æ±‚è¿æ¥æŠ¥æ–‡æ®µåˆå§—å§—æ¥è¿Ÿåˆ°è¾¾äº†æœåŠ¡å™¨ç«¯ï¼Œè¿™æ˜¯æˆ‘ä»¬å¦‚æœæˆ‘ä»¬é‡‡ç”¨çš„ä¸¤æ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨ç«¯å°±ä¼šè¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€ï¼Œè€Œå› ä¸ºå®¢æˆ·ç«¯å·²ç»è®¤ä¸ºè¿™æ¬¡è¿æ¥å·²ç»å®Œæˆäº†ï¼Œé‚£è¿™ä¸ªçŠ¶æ€å°±ä¼šä¸€ç›´å°¬ç­‰ç€ï¼Œæ²¡äººä¼ æ•°æ®ä¹Ÿæ²¡äººå‘Šè¯‰ä»–æ–­å¼€ï¼Œè¿™æ ·å°±å¯¼è‡´å ç”¨äº†æœåŠ¡å™¨ç«¯è®¸å¤šçš„èµ„æºã€‚</p><h4 id="ğŸ¤—å››æ¬¡æŒ¥æ‰‹ï¼š"><a href="#ğŸ¤—å››æ¬¡æŒ¥æ‰‹ï¼š" class="headerlink" title="ğŸ¤—å››æ¬¡æŒ¥æ‰‹ï¼š"></a>ğŸ¤—å››æ¬¡æŒ¥æ‰‹ï¼š</h4><p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½å¯ä»¥å‘èµ·æ–­å¼€è¿æ¥ï¼Œè¿™é‡Œä»¥å®¢æˆ·ç«¯ä¸ºä¾‹</p><p><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š</strong>æ­¤æ—¶å®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†ç»ˆæ­¢ä½FINå’Œç¡®è®¤ä½ACKè®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºè¯·æ±‚é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶å°†åºå·è®¾ç½®ä¸ºuï¼ˆuç­‰äºæœ€åä¸€æ¬¡å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ï¼Œå¹¶ä¸”TCPè§„å®šå³ä½¿è¯¥è¯·æ±‚é‡Šæ”¾æŠ¥æ–‡æ®µä¸æºå¸¦æ•°æ®ä¹Ÿä¼šæ¶ˆè€—ä¸€ä¸ªåºå·ï¼‰ï¼Œç¡®è®¤å·è®¾ç½®ä¸ºv(vç­‰äºå®¢æˆ·ç«¯ä¹‹å‰æ¥å—åˆ°çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·+1)ï¼ŒåŒæ—¶è¿›å…¥ç»ˆæ­¢ç­‰å¾…1çŠ¶æ€</p><p><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼š</strong>æœåŠ¡å™¨ç«¯æ¥å—åˆ°è¿æ¥é‡Šæ”¾å­—æ®µåï¼Œå†å‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†ACKè®¾ä¸º1ï¼Œè¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºæ™®é€šç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶å°†åºå·è®¾ç½®ä¸ºvï¼ˆä¸ä¸Šé¢çš„vç›¸ç­‰ï¼‰ç¡®è®¤å·è®¾ç½®ä¸ºu+1ï¼Œå¹¶è¿›å…¥å…³é—­ç­‰å¾…çŠ¶æ€ã€‚è¿™æ—¶æœåŠ¡å™¨ç«¯ä¼šé€šçŸ¥åº”ç”¨å±‚TCPå®¢æˆ·ç«¯è¦æ–­å¼€ä¸æœåŠ¡å™¨ç«¯çš„è¿æ¥ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„è¿™ä¸ªæ–¹å‘çš„è¿æ¥å°±é‡Šæ”¾äº†ï¼ˆç”±å…¨åŒå·¥å˜ä¸ºåŠåŒå·¥ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç»§ç»­æ¥å—æ•°æ®ï¼Œä½†ä¸å¯ä»¥å‘é€æ•°æ®äº†ï¼Œè¿™é‡Œåˆ«é”™è¯¯ç†è§£ä¸ºä¸èƒ½å‘é€ä»»ä½•ä¸œè¥¿äº†ï¼Œåªæ˜¯ä¸èƒ½ä¾èµ–å»ºç«‹çš„é€šé“å¯é çš„å‘é€æ•°æ®ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥å‘é€TCPæŠ¥æ–‡æ®µçš„ï¼‰ï¼Œå®¢æˆ·ç«¯æ¥å—åˆ°æ™®é€šç¡®è®¤æŠ¥æ–‡æ®µåè¿›å…¥ç»ˆæ­¢ç­‰å¾…2çŠ¶æ€ã€‚</p><p><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼š</strong>ç­‰åˆ°åº”ç”¨å±‚è¿›ç¨‹å‘é€å®Œæ•°æ®åï¼Œå®ƒå°±ä¼šé€šçŸ¥TCPæœåŠ¡å™¨æ®µè¿›ç¨‹å…³é—­TCPè¿æ¥ï¼ŒTCPæœåŠ¡ç«¯ä¼šå†å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†ç»ˆæ­¢ä½FINå’Œç¡®è®¤ä½è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶å°†åºå·è®¾ç½®ä¸ºw(wç­‰äºåæ¥æœåŠ¡å™¨ç«¯å¾€å®¢æˆ·ç«¯å‘é€çš„å‰©ä½™çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·+1)ï¼Œç¡®è®¤å·è®¾ç½®ä¸ºu+1(å¯¹ä¸€æ¬¡æŒ¥æ‰‹çš„æŠ¥æ–‡æ®µçš„å†æ¬¡ç¡®è®¤)ï¼ŒåŒæ—¶è¿›å…¥æœ€åç¡®è®¤çŠ¶æ€ã€‚</p><p><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š</strong>å®¢æˆ·ç«¯æ”¶åˆ°è¿æ¥é‡Šæ”¾å­—æ®µåï¼Œå†å‘æœåŠ¡å™¨ç«¯å‘é€ä¸€ä¸ªTCPæŠ¥æ–‡æ®µï¼Œé‡Œé¢å°†ç¡®è®¤ä½ACKè®¾ä¸º1,è¡¨æ˜è¯¥æŠ¥æ–‡æ®µä¸ºæ™®é€šç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶å°†åºå·è®¾ç½®ä¸ºu+1ï¼Œç¡®è®¤å·è®¾ä¸ºw+1ï¼ŒæœåŠ¡å™¨ç«¯æ¥å—åˆ°è¯¥ç¡®è®¤æŠ¥æ–‡æ®µåè¿›å…¥å…³é—­çŠ¶æ€ï¼Œè€Œå®¢æˆ·ç«¯è¿›å…¥æ—¶é—´ç­‰å¾…çŠ¶æ€ï¼Œåªæœ‰ç­‰2MSLï¼ˆMaximum Segment Lifetimeï¼Œæœ€é•¿æŠ¥æ–‡å¯¿å‘½ï¼‰åè¿›å…¥å…³é—­çŠ¶æ€ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ç­‰å¾…ï¼š</strong>è¿˜æ˜¯ä¸€æ ·ï¼ŒTCPå§‹ç»ˆè®¤ä¸ºç½‘ç»œå±‚æ˜¯ä¸å¯é çš„ï¼Œç¬¬å››æ¬¡æŒ¥æ‰‹å‘é€çš„TCPæŠ¥æ–‡æ®µå¯èƒ½å› ä¸ºæŸç§åŸå› æœªèƒ½åˆ°è¾¾æœåŠ¡å™¨ç«¯ï¼Œè€ŒæœåŠ¡å™¨ç«¯æ²¡æ¥å—åˆ°å®¢æˆ·ç«¯çš„ç¡®è®¤æŠ¥æ–‡å­—æ®µå°±ä¼šå‘èµ·è¶…æ—¶é‡ä¼ è¿æ¥é‡Šæ”¾å­—æ®µï¼Œè€Œè¿™æ—¶å®¢æˆ·ç«¯å·²ç»å…³é—­äº†ï¼ŒæœåŠ¡å™¨ç«¯ä¸å¯èƒ½å†æ¥å—åˆ°ç¡®è®¤æŠ¥æ–‡å­—æ®µï¼Œä¼šä¸€ç›´è¿›è¡Œè¶…æ—¶é‡ä¼ ï¼Œä¸€ç›´å¤„äºæœ€åç¡®è®¤çŠ¶æ€ï¼Œè€Œæ— æ³•è¿›å…¥å…³é—­çŠ¶æ€ã€‚è€Œä¸”ç»è¿‡äº†è¿™ä¸ª2MSLæ—¶é—´ï¼Œå°±å¯ä»¥ä½¿æœ¬æ¬¡è¿æ¥çš„æ‰€æœ‰å­—æ®µéƒ½æ¶ˆå¤±ï¼Œä¿è¯ä¸‹ä¸€æ¬¡è¿æ¥ä¸ä¼šæ”¶åˆ°æ—§çš„å­—æ®µã€‚</p><ol start="6"><li>TCPè¿æ¥å»ºç«‹åï¼Œæµè§ˆå™¨å°±ä¼šæ„å»ºè¯·æ±‚è¡Œå’Œè¯·æ±‚å¤´ç­‰ä¿¡æ¯ï¼Œå¹¶æŠŠå’Œè¯¥åŸŸåç›¸å…³çš„Cookieç­‰æ•°æ®é™„åŠ åˆ°è¯·æ±‚å¤´ä¸­ï¼Œç„¶åå‘æœåŠ¡å™¨å‘é€æ„å»ºå¥½çš„è¯·æ±‚ä¿¡æ¯ã€‚</li><li>æœåŠ¡å™¨æ¥å—åˆ°æ¶ˆæ¯åï¼Œå°±æ ¹æ®è¯·æ±‚ä¿¡æ¯ç”Ÿæˆå“åº”ä¿¡æ¯ï¼ˆåŒ…æ‹¬å“åº”è¡Œï¼Œå“åº”å¤´å’Œå“åº”ä½“ç­‰ä¿¡æ¯ï¼‰ï¼Œå¹¶å‘é€å›å®¢æˆ·ç«¯ã€‚</li><li>ç½‘ç»œè¿›ç¨‹æ¥å—åˆ°å“åº”ä¿¡æ¯åå°±å¼€å§‹è§£æå“åº”å¤´ä¿¡æ¯ï¼Œé¦–å…ˆæ˜¯åˆ¤æ–­çŠ¶æ€ç æ˜¯å¦3xxï¼Œæ˜¯å¦ä¸ºé‡å®šå‘ï¼Œå¦‚æœæ˜¯çš„è¯å°±è¯»å–å“åº”å¤´çš„Locationå­—æ®µä¸­çš„åœ°å€ä¿¡æ¯ï¼Œç„¶åå†å‘èµ·HTTPæˆ–HTTPSè¯·æ±‚ï¼Œä¸€åˆ‡ç”±ä»å¤´å¼€å§‹äº†ã€‚</li><li>å¤„ç†äº†è·³è½¬ä¿¡æ¯åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å¤„ç†å“åº”æ•°æ®ç±»å‹ï¼ŒURLè¯·æ±‚æœ‰æ—¶å¯èƒ½è¯·æ±‚çš„æ˜¯ä¸€ä¸ªä¸‹è½½ç±»å‹ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªæ­£å¸¸çš„HTMLç•Œé¢ï¼Œè¿™æ—¶æµè§ˆå™¨å°±ä¼šæ ¹æ®å“åº”å¤´ä¸­çš„Content-Typeæ¥å¤„ç†è¯·æ±‚ï¼Œå¦‚æœContent-Typeä¸ºä¸‹è½½ç±»å‹é‚£å°±å°†å®ƒäº¤ç»™æµè§ˆå™¨çš„ä¸‹è½½ç®¡ç†å™¨ï¼Œè€Œè¯¥URLçš„å¯¼èˆªåˆ°æ­¤å°±ç»“æŸäº†ã€‚ä½†å¦‚æœæ˜¯HTMLï¼Œé‚£å°±ä¼šç»§ç»­ä¸‹é¢çš„å¯¼èˆªæµç¨‹ã€‚æ¥ä¸‹æ¥å°±æ˜¯é€šçŸ¥æµè§ˆå™¨è¿›ç¨‹å¼€å§‹<strong>å‡†å¤‡æ¸²æŸ“</strong>ã€‚</li><li>æµè§ˆå™¨è¿›ç¨‹æ”¶åˆ°é€šçŸ¥åï¼ŒChromeçš„æ–¹æ¡ˆæ˜¯å¦‚æœå½“å‰æµè§ˆå™¨ä¸‹å·²ç»æœ‰åŒä¸€ç«™ç‚¹ï¼ˆåŒä¸€åŸŸåï¼ŒåŒä¸€åè®®ï¼‰çš„æ¸²æŸ“è¿›ç¨‹ï¼Œé‚£å°±ä¼šå¤ç”¨å…¶æ¸²æŸ“è¿›ç¨‹ï¼Œå¦åˆ™åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„æ¸²æŸ“è¿›ç¨‹ï¼Œæ¸²æŸ“è¿›ç¨‹å‡†å¤‡å¥½ä¹‹åè¿˜ä¸èƒ½è¿›å…¥æ–‡æ¡£è§£æé˜¶æ®µï¼Œå› ä¸ºæ­¤æ—¶çš„æ–‡æ¡£æ•°æ®è¿˜åœ¨ç½‘ç»œè¿›ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰æäº¤ç»™æ¸²æŸ“è¿›ç¨‹ã€‚</li><li>æäº¤æ–‡æ¡£é˜¶æ®µï¼Œæäº¤å“åº”ä¿¡æ¯ä¸­çš„å“åº”ä½“éƒ¨åˆ†ï¼Œ<strong>æäº¤æ–‡æ¡£</strong>çš„å‘½ä»¤ç”±æµè§ˆå™¨è¿›ç¨‹å‘å‡ºï¼Œæ¸²æŸ“è¿›ç¨‹æ¥æ”¶åˆ°é€šçŸ¥åï¼Œä¼šå’Œç½‘ç»œè¿›ç¨‹å»ºç«‹ä¼ è¾“æ•°æ®çš„â€œç®¡é“â€ï¼Œç­‰åˆ°æ–‡æ¡£å…¨éƒ¨æäº¤åï¼Œæ¸²æŸ“è¿›ç¨‹ä¼šç»™æµè§ˆå™¨è¿›ç¨‹å‘é€<strong>ç¡®è®¤æäº¤</strong>çš„ä¿¡æ¯ã€‚</li><li>æµè§ˆå™¨æ¥å—åˆ°<strong>ç¡®è®¤æäº¤</strong>çš„æ¶ˆæ¯åï¼Œå°±ä¼š<strong>æ›´æ–°æµè§ˆå™¨ç•Œé¢çŠ¶æ€</strong>ï¼ŒåŒ…æ‹¬äº†å®‰å…¨çŠ¶æ€ï¼Œåœ°å€æ çš„URLã€å‰è¿›åé€€çš„å†å²çŠ¶æ€ï¼Œå¹¶æ›´æ–°webç•Œé¢ã€‚</li><li>ä¹‹åå°±æ˜¯æ¸²æŸ“è¿›ç¨‹äº†ï¼Œä¸€æ—¦æ¸²æŸ“è¿›ç¨‹ç»“æŸï¼Œå°±ä¼šå¾€æµè§ˆå™¨è¿›ç¨‹å‘é€ä¿¡æ¯ï¼Œæ”¶åˆ°ä¿¡æ¯åï¼Œæµè§ˆå™¨å°±ä¼šåœæ­¢æ ‡ç­¾å›¾æ ‡ä¸ŠåŠ è½½åŠ¨ç”»</li></ol>]]></content>
    
    
    <categories>
      
      <category>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</category>
      
      <category>ç½‘ç»œ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç½‘ç»œ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ğŸ˜ƒæå®šDocker--è¿›é˜¶ä½¿ç”¨</title>
    <link href="/2022/07/30/%E6%90%9E%E5%AE%9ADocker--%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/07/30/%E6%90%9E%E5%AE%9ADocker--%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ˜ƒæå®šDockerâ€“è¿›é˜¶ä½¿ç”¨"><a href="#ğŸ˜ƒæå®šDockerâ€“è¿›é˜¶ä½¿ç”¨" class="headerlink" title="ğŸ˜ƒæå®šDockerâ€“è¿›é˜¶ä½¿ç”¨"></a>ğŸ˜ƒæå®šDockerâ€“è¿›é˜¶ä½¿ç”¨</h1><p>åœ¨å¿«é€Ÿå…¥é—¨å­¦ä¹ å®Œåï¼Œæˆ‘ä»¬å¼€å§‹æ¥å­¦ä¹ äº›çœŸå®å·¥ä½œåœºæ™¯ä¸‹ï¼Œéœ€è¦äº†è§£å­¦ä¹ çš„æŠ€æœ¯ã€‚</p><span id="more"></span><p>åœ¨å¿«é€Ÿå…¥é—¨é‚£ä¸€èŠ‚æˆ‘ä»¬ä½¿ç”¨çš„é•œåƒéƒ½æ˜¯ä»å…¬å…±çš„dockerä»“åº“æ‹‰å–çš„ï¼Œè€Œå¯¹äºä¸€äº›çœŸå®ä½¿ç”¨çš„åœºæ™¯ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å°†æ•´ä¸ªé¡¹ç›®çš„ç¯å¢ƒéƒ½é…ç½®åˆ°ä¸€ä¸ªé•œåƒä¸­ï¼Œç»™ä½¿ç”¨è€…ä¸€ä¸ªå¼€ç®±å³ç”¨çš„ä½“éªŒã€‚è¿™é‡Œå°±éœ€è¦é•œåƒæ„å»ºçš„æŠ€æœ¯ã€‚é€šå¸¸æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p><ul><li><code>docker commit</code>ï¼šä»å·²æœ‰å®¹å™¨åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚</li><li><code>docker build</code>ï¼šé…åˆ Dockerfile æ–‡ä»¶åˆ›å»ºé•œåƒã€‚</li></ul><h2 id="Commitå‘½ä»¤åˆ›å»ºé•œåƒï¼š"><a href="#Commitå‘½ä»¤åˆ›å»ºé•œåƒï¼š" class="headerlink" title="Commitå‘½ä»¤åˆ›å»ºé•œåƒï¼š"></a>Commitå‘½ä»¤åˆ›å»ºé•œåƒï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker commit [OPTIONS] å®¹å™¨å [åˆ›å»ºåçš„é•œåƒå[:TAG]]<br></code></pre></td></tr></table></figure><p> <strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>-a</strong>ï¼šé•œåƒä½œè€…</li><li><strong>-m</strong>ï¼šæäº¤æ—¶çš„è¯´æ˜</li><li><strong>-p</strong>ï¼šåœ¨å®¹å™¨commitæ—¶ï¼Œå°†å®¹å™¨æš‚åœ</li><li>TAGè™½ç„¶æ˜¯å¯é€‰ï¼Œä½†å¼ºçƒˆå»ºè®®è¿˜æ˜¯åŠ ä¸Šæ¯”è¾ƒå¥½</li></ul><h3 id="ä¸€ä¸ªæ —å­ğŸ’­"><a href="#ä¸€ä¸ªæ —å­ğŸ’­" class="headerlink" title="ä¸€ä¸ªæ —å­ğŸ’­"></a>ä¸€ä¸ªæ —å­ğŸ’­</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">1.å…ˆæ‹‰å–ä¸€ä¸ªé•œåƒ<br>docker pull centos:7<br>2.åˆ›å»ºä¸€ä¸ªå®¹å™¨<br>docker run -di --name centos centos:7<br>3.è¿›å…¥å®¹å™¨<br>docker <span class="hljs-built_in">exec</span> -it centos bash<br>4.é…ç½®Goç¯å¢ƒï¼Œå’Œmysqlåˆ°é‡Œé¢ï¼ˆdocker <span class="hljs-built_in">cp</span> æ‹·è´ã€è§£å‹ï¼‰<br>5.åˆ›å»ºé•œåƒ<br>docker commit -a <span class="hljs-string">&quot;PEngxJ&quot;</span> -m <span class="hljs-string">&quot;Go and mysql&quot;</span> centos mycentos:7<br>6.æ ¹æ®è‡ªå·±çš„é•œåƒåˆ›å»ºå®¹å™¨<br>docker run -di --name mycentos mycentos:7 <br><br></code></pre></td></tr></table></figure><h2 id="Dockerfileæ–¹å¼ï¼š"><a href="#Dockerfileæ–¹å¼ï¼š" class="headerlink" title="Dockerfileæ–¹å¼ï¼š"></a>Dockerfileæ–¹å¼ï¼š</h2><blockquote><p>æ€»ä½“æ¥è¯´å°±æ˜¯æŠŠä¸Šé¢ä¸€ä¸ªä¸ªçš„æ­¥éª¤å†™åˆ°ä¸€ä¸ªDockerfileæ–‡ä»¶ä¸­ï¼Œç„¶åè¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå®ƒå°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬å®Œæˆæ‰€æœ‰æ­¥éª¤ï¼Œç„¶ååˆ›å»ºç›¸åº”çš„å®¹å™¨ã€‚</p></blockquote><p>åœ¨ä½¿ç”¨è¯¥æ–¹å¼å‰ï¼Œæˆ‘ä»¬å¾—å…ˆå­¦ä¸€å­¦Dockerfileçš„å¸¸ç”¨å‘½ä»¤</p><h3 id="FROMï¼š"><a href="#FROMï¼š" class="headerlink" title="FROMï¼š"></a>FROMï¼š</h3><p><strong>æŒ‡å®šè¯¥é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒæ„å»ºçš„</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">eg:<br>FROM centos:7<br></code></pre></td></tr></table></figure><h3 id="RUN"><a href="#RUN" class="headerlink" title="RUN:"></a>RUN:</h3><p><strong>æ‰§è¡Œåé¢è·Ÿç€çš„å‘½ä»¤è¡Œå‘½ä»¤</strong>,æœ‰ä»¥ä¸‹ä¸¤ç§æ ¼å¼ï¼š</p><p>shellæ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">RUN</span><span class="language-bash"> &lt;å‘½ä»¤è¡Œå‘½ä»¤&gt;</span><br><span class="hljs-comment">#&lt;å‘½ä»¤è¡Œå‘½ä»¤&gt;å’Œåœ¨ç»ˆç«¯ä¸Šçš„å‘½ä»¤ä¸€æ ·</span><br>eg:<br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;RUN&#x27;</span> &gt; /usr/local/run.text</span><br></code></pre></td></tr></table></figure><p>execæ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">RUN</span><span class="language-bash"> [<span class="hljs-string">&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;</span>,<span class="hljs-string">&quot;å‚æ•°1&quot;</span>,<span class="hljs-string">&quot;å‚æ•°2&quot;</span>]</span><br>egï¼š<br><span class="hljs-keyword">RUN</span><span class="language-bash"> [<span class="hljs-string">&quot;./main.go&quot;</span>,<span class="hljs-string">&quot;hello&quot;</span>,<span class="hljs-string">&quot;world&quot;</span>]</span><br><span class="hljs-comment">#ç›¸å½“äº RUN ./main.go hello world</span><br></code></pre></td></tr></table></figure><p>**æ³¨æ„:**Dockerfileçš„æŒ‡ä»¤æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šåœ¨dockerä¸Šæ–°å»ºä¸€å±‚ï¼ˆä¹‹å‰é•œåƒåˆ†å±‚çš„æ¦‚å¿µï¼‰ï¼Œæ‰€ä»¥è¿‡å¤šæ— æ„ä¹‰çš„å±‚å¿…ä¼šå¯¼è‡´ç”Ÿæˆçš„é•œåƒçš„è†¨èƒ€ã€‚æ‰€ä»¥å¸¸é‡‡ç”¨ä»¥ä¸‹æ–¹å¼ï¼š</p><p>ä¸ç”¨ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> centos<br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum -y install wget</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> wget -O redis.tar.gz <span class="hljs-string">&quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;</span></span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> tar -xvf redis.tar.gz</span><br></code></pre></td></tr></table></figure><p>è€Œç”¨ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> centos<br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum -y install wget \</span><br><span class="language-bash">    &amp;&amp; wget -O redis.tar.gz <span class="hljs-string">&quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;</span> \</span><br><span class="language-bash">    &amp;&amp; tar -xvf redis.tar.gz</span><br></code></pre></td></tr></table></figure><h3 id="COPY"><a href="#COPY" class="headerlink" title="COPY:"></a>COPY:</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">COPY</span><span class="language-bash"> [--<span class="hljs-built_in">chown</span>=&lt;user&gt;:&lt;group&gt;] &lt;æºè·¯å¾„1&gt;...  &lt;ç›®æ ‡è·¯å¾„&gt;</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> [--<span class="hljs-built_in">chown</span>=&lt;user&gt;:&lt;group&gt;] [<span class="hljs-string">&quot;&lt;æºè·¯å¾„1&gt;&quot;</span>,...  <span class="hljs-string">&quot;&lt;ç›®æ ‡è·¯å¾„&gt;&quot;</span>]</span><br></code></pre></td></tr></table></figure><p>[â€“chown&#x3D;&lt;user&gt;:&lt;group&gt;]ï¼šå¯é€‰å‚æ•°ï¼Œç”¨æˆ·æ”¹å˜å¤åˆ¶åˆ°å®¹å™¨å†…æ–‡ä»¶çš„æ‹¥æœ‰è€…å’Œå±ç»„</p><p>**&lt;æºè·¯å¾„&gt;**ï¼šæºæ–‡ä»¶æˆ–è€…æºç›®å½•ï¼Œè¿™é‡Œå¯ä»¥æ˜¯é€šé…ç¬¦è¡¨è¾¾å¼ï¼Œå…¶é€šé…ç¬¦è§„åˆ™è¦æ»¡è¶³ Go çš„ filepath.Match è§„åˆ™ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">COPY</span><span class="language-bash"> hom* /mydir/</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> hom?.txt /mydir/</span><br></code></pre></td></tr></table></figure><p>**&lt;ç›®æ ‡è·¯å¾„&gt;**ï¼šå®¹å™¨å†…çš„æŒ‡å®šè·¯å¾„ï¼Œè¯¥è·¯å¾„ä¸ç”¨äº‹å…ˆå»ºå¥½ï¼Œè·¯å¾„ä¸å­˜åœ¨çš„è¯ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p><h3 id="ADD"><a href="#ADD" class="headerlink" title="ADD:"></a>ADD:</h3><p>ADD æŒ‡ä»¤å’Œ COPY çš„ä½¿ç”¨æ ¼ç±»ä¼¼ï¼ˆåŒæ ·éœ€æ±‚ä¸‹ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ COPYï¼‰ã€‚åŠŸèƒ½ä¹Ÿç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„å¦‚ä¸‹ï¼š</p><p>åŒºåˆ«ï¼šADDå‘½ä»¤ï¼Œå¦‚æœå¤åˆ¶çš„å†…å®¹æ˜¯å‹ç¼©åŒ…çš„è¯ï¼Œåˆ™å®ƒä¼šè‡ªåŠ¨è§£å‹ï¼Œå½“ç„¶è¿™æ ·ä¹Ÿå¸¦æ¥ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹å°±æ˜¯å®ƒä¸èƒ½ç”¨æ¥å¤åˆ¶å‹ç¼©åŒ…</p><h3 id="CMD"><a href="#CMD" class="headerlink" title="CMD:"></a>CMD:</h3><p>å’ŒRUNä¸€æ ·ç”¨ä¸æ‰§è¡Œå‘½ä»¤ï¼Œä¸è¿‡ä»–ä»¬å„è‡ªçš„æ‰§è¡Œæ—¶é—´ä¸åŒã€‚RUNåœ¨<code>docker build</code>çš„æ—¶å€™æ‰§è¡Œï¼Œè€ŒCMDæ˜¯åœ¨<code>docker run</code>æ—¶æ‰§è¡Œçš„ã€‚</p><p>ä»‹äºè¿™ç‚¹å®ƒå¸¸ç”¨äºä¸ºå¯åŠ¨çš„å®¹å™¨æŒ‡å®šé»˜è®¤çš„å¯åŠ¨ç¨‹åºï¼Œå¦‚æœæƒ³è®©å®¹å™¨ä¸€ç›´è¿è¡Œç€é‚£å°±å¿…é¡»å¾—è®©è¿™ä¸ªç¨‹åºåœ¨<strong>å‰å°è¿è¡Œ</strong>ï¼Œä¸ç„¶æ ¹æ®dockerçš„è§„åˆ™å½“å‘½ä»¤è¿è¡Œç»“æŸådockerå°±é€€å‡ºäº†ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ol><li>CMD æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºå¯è¢« docker run å‘½ä»¤è¡Œå‚æ•°ä¸­æŒ‡å®šè¦è¿è¡Œçš„ç¨‹åºæ‰€è¦†ç›–ã€‚</li></ol><p>egï¼š<code>docker run --name nginx -P nginx echo &#39;hello&#39;</code>å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œé‚£å°±ä¼šä½¿Dockerfileä¸­CMDçš„å¤±æ•ˆã€‚</p><ol start="2"><li>å¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</li></ol><p>æ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">CMD</span><span class="language-bash"> &lt;shell å‘½ä»¤&gt; </span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;&lt;å¯æ‰§è¡Œæ–‡ä»¶æˆ–å‘½ä»¤&gt;&quot;</span>,<span class="hljs-string">&quot;&lt;param1&gt;&quot;</span>,<span class="hljs-string">&quot;&lt;param2&gt;&quot;</span>,...] </span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;&lt;param1&gt;&quot;</span>,<span class="hljs-string">&quot;&lt;param2&gt;&quot;</span>,...]  <span class="hljs-comment"># è¯¥å†™æ³•æ˜¯ä¸º ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºæä¾›é»˜è®¤å‚æ•°</span></span><br></code></pre></td></tr></table></figure><p>æ¨èä½¿ç”¨ç¬¬äºŒç§æ ¼å¼ï¼Œæ‰§è¡Œè¿‡ç¨‹æ¯”è¾ƒæ˜ç¡®ã€‚ç¬¬ä¸€ç§æ ¼å¼å®é™…ä¸Šåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šè‡ªåŠ¨è½¬æ¢æˆç¬¬äºŒç§æ ¼å¼è¿è¡Œï¼Œå¹¶ä¸”é»˜è®¤å¯æ‰§è¡Œæ–‡ä»¶æ˜¯ shã€‚</p><h3 id="ENTRYPOINT"><a href="#ENTRYPOINT" class="headerlink" title="ENTRYPOINT:"></a>ENTRYPOINT:</h3><p>å’Œä¸Šé¢CMDç±»å‹ï¼Œåœ¨<code>docker run</code>æ—¶æ‰§è¡Œå‘½ä»¤ï¼Œä½†ä¸åŒçš„æ˜¯å®ƒä¸ä¼šè¢«<code>docker run</code>è·Ÿç€çš„å‚æ•°ä¸­çš„å‘½ä»¤æ‰€è¦†ç›–ï¼Œè€Œæ˜¯æŠŠè¿™äº›â€œå‘½ä»¤â€åšä¸ºå‚æ•°ç»™ENTRYPOINTè®¾ç½®çš„å‘½ä»¤ä½¿ç”¨ã€‚</p><p>å½“ç„¶, å¦‚æœè¿è¡Œ docker run æ—¶ä½¿ç”¨äº† â€“entrypoint é€‰é¡¹ï¼Œå°†è¦†ç›– ENTRYPOINT æŒ‡ä»¤æŒ‡å®šçš„ç¨‹åºã€‚</p><p><strong>ä¼˜ç‚¹</strong>ï¼šåœ¨æ‰§è¡Œ docker run çš„æ—¶å€™å¯ä»¥æŒ‡å®š ENTRYPOINT è¿è¡Œæ‰€éœ€çš„å‚æ•°ã€‚ï¼ˆENTRYPOINTè®¾ç½®å®šå‚åï¼Œåé¢æˆ‘ä»¬å¯ä»¥åœ¨docker runæ—¶è‡ªå·±æŒ‡å®šå˜å‚ï¼Œå¯ä»¥çœ‹åé¢ä¾‹å­ï¼‰</p><p><strong>æ³¨æ„</strong>ï¼šå¦‚æœ Dockerfile ä¸­å¦‚æœå­˜åœ¨å¤šä¸ª ENTRYPOINT æŒ‡ä»¤ï¼Œä»…æœ€åä¸€ä¸ªç”Ÿæ•ˆã€‚</p><p>æ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;&lt;executeable&gt;&quot;</span>,<span class="hljs-string">&quot;&lt;param1&gt;&quot;</span>,<span class="hljs-string">&quot;&lt;param2&gt;&quot;</span>,...]</span><br></code></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><p>å‡è®¾å·²é€šè¿‡ Dockerfile æ„å»ºäº† nginx:test é•œåƒï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> nginx<br><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;nginx&quot;</span>, <span class="hljs-string">&quot;-c&quot;</span>] <span class="hljs-comment"># å®šå‚</span></span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;/etc/nginx/nginx.conf&quot;</span>] <span class="hljs-comment"># å˜å‚ </span></span><br></code></pre></td></tr></table></figure><p>1ã€ä¸ä¼ å‚è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run  nginx:<span class="hljs-built_in">test</span></span><br></code></pre></td></tr></table></figure><p>å®¹å™¨å†…ä¼šé»˜è®¤è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ä¸»è¿›ç¨‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nginx -c /etc/nginx/nginx.conf<br></code></pre></td></tr></table></figure><p>2ã€ä¼ å‚è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">docker run nginx:<span class="hljs-built_in">test</span> <span class="hljs-string">&quot;/etc/nginx/new.conf&quot;</span></span><br></code></pre></td></tr></table></figure><p>å®¹å™¨å†…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ä¸»è¿›ç¨‹(&#x2F;etc&#x2F;nginx&#x2F;new.conf:å‡è®¾å®¹å™¨å†…å·²æœ‰æ­¤æ–‡ä»¶)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">nginx -c /etc/nginx/new.conf<br></code></pre></td></tr></table></figure><h3 id="ENV"><a href="#ENV" class="headerlink" title="ENV:"></a>ENV:</h3><p>è®¾ç½®ç¯å¢ƒå˜é‡</p><p>æ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">ENV</span> &lt;key&gt; &lt;value&gt;<br><span class="hljs-keyword">ENV</span> &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...<br></code></pre></td></tr></table></figure><h3 id="LABLE"><a href="#LABLE" class="headerlink" title="LABLE:"></a>LABLE:</h3><p>LABEL æŒ‡ä»¤ç”¨æ¥ç»™é•œåƒæ·»åŠ ä¸€äº›å…ƒæ•°æ®ï¼ˆmetadataï¼‰ï¼Œä»¥é”®å€¼å¯¹çš„å½¢å¼ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">LABEL</span><span class="language-bash"> &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span><br></code></pre></td></tr></table></figure><p>eg:</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">LABEL</span><span class="language-bash"> image.authors=<span class="hljs-string">&quot;runoob&quot;</span></span><br></code></pre></td></tr></table></figure><h3 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE:"></a>EXPOSE:</h3><p>ä»…ä»…æ˜¯å£°æ˜ç«¯å£å¹¶ä¸ä¼šæ‰“å¼€</p><p>ä½œç”¨ï¼š</p><ul><li>å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„ã€‚ï¼ˆåœ¨docker runæ—¶ -pï¼‰</li><li>åœ¨è¿è¡Œæ—¶ä½¿ç”¨éšæœºç«¯å£æ˜ å°„æ—¶ï¼Œä¹Ÿå°±æ˜¯ docker run -P æ—¶ï¼Œä¼šè‡ªåŠ¨éšæœºæ˜ å°„ EXPOSE çš„ç«¯å£ã€‚</li></ul><p>æ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">EXPOSE</span> &lt;ç«¯å£<span class="hljs-number">1</span>&gt; [&lt;ç«¯å£<span class="hljs-number">2</span>&gt;...]<br></code></pre></td></tr></table></figure><h3 id="WORKDIR"><a href="#WORKDIR" class="headerlink" title="WORKDIR:"></a>WORKDIR:</h3><p>æŒ‡å®šå·¥ä½œç›®å½•ã€‚ç”¨ WORKDIR æŒ‡å®šçš„å·¥ä½œç›®å½•ï¼Œä¼šåœ¨æ„å»ºé•œåƒçš„æ¯ä¸€å±‚ä¸­éƒ½å­˜åœ¨ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œdockerä¼šè‡ªåŠ¨åˆ›å»ºã€‚</p><p>ä½œç”¨ï¼š</p><p>WORKDIRæŒ‡ä»¤ä¸ºDockerfileä¸­åœ¨å…¶ä¸‹é¢çš„ä»»ä½•RUNã€CMDã€ENTRYPOINTã€COPYå’ŒADDæŒ‡ä»¤è®¾ç½®å·¥ä½œç›®å½•ã€‚</p><p><strong>æ€ä¹ˆç†è§£å·¥ä½œç›®å½•ï¼š</strong></p><p>åœ¨ä¸Šé¢çš„RUNæˆ‘ä»¬è¯´è¿‡ï¼Œæ¯æ¬¡çš„RUNéƒ½ä¼šåœ¨dockerä¸Šæ–°å»ºä¸€å±‚ï¼Œæ‰€ä»¥å°±ä¼šå¯¼è‡´åé¢çš„å‘½ä»¤ä¸çŸ¥é“å‰é¢çš„å‘½ä»¤çš„æƒ…å†µã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">cd</span> /app</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello&quot;</span> &gt; world.txt</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬æ„é”®å®Œåä¼šå‘ç°åœ¨ç›®å½•&#x2F;appä¸‹æ‰¾ä¸åˆ°world.txtï¼Œè€Œä¼šåœ¨ä¸€ä¸ªå…¶å®ƒçš„åœ°æ–¹æ‰¾åˆ°è¿™ä¸ªä¸œè¥¿ï¼Œè¿™å°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ï¼Œå› ä¸ºä¸‹ä¸€ä¸ª<code>RUN</code>æ ¹æœ¬ä¸ä¼šåœ¨<code>/app</code>ç›®å½•ä¸‹ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å°±è¦ç”¨åˆ°<strong>WORKDIR</strong>äº†ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;hello&quot;</span> &gt; world.txt</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä½ çš„ <code>WORKDIR</code> æŒ‡ä»¤ä½¿ç”¨çš„ç›¸å¯¹è·¯å¾„ï¼Œé‚£ä¹ˆæ‰€åˆ‡æ¢çš„è·¯å¾„ä¸ä¹‹å‰çš„ <code>WORKDIR</code> æœ‰å…³ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /a</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> b</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> c</span><br><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">pwd</span></span><br></code></pre></td></tr></table></figure><h3 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME:"></a>VOLUME:</h3><p>å®šä¹‰&#x3D;&#x3D;åŒ¿å&#x3D;&#x3D;æ•°æ®å·</p><p>æ ¼å¼ï¼š</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">VOLUME</span><span class="language-bash"> [<span class="hljs-string">&quot;&lt;å®¹å™¨è·¯å¾„1&gt;&quot;</span>, <span class="hljs-string">&quot;&lt;å®¹å™¨è·¯å¾„2&gt;&quot;</span>...]</span><br><span class="hljs-keyword">VOLUME</span><span class="language-bash"> &lt;å®¹å™¨è·¯å¾„&gt;</span><br></code></pre></td></tr></table></figure><p>ä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡åœ¨<code>docker run</code>æ—¶æ·»åŠ <code>-v</code>å‚æ•°æ¥æŒ‡å®šæŒ‚è½½ç›®å½•</p><h3 id="docker-build"><a href="#docker-build" class="headerlink" title="docker build:"></a>docker build:</h3><p>å¸¸ç”¨çš„å‚æ•°ï¼š</p><ul><li><code>-t</code>ï¼šé•œåƒçš„åå­—åŠæ ‡ç­¾ï¼Œé€šå¸¸ name:tag æˆ–è€… name æ ¼å¼ï¼›å¯ä»¥åœ¨ä¸€æ¬¡æ„å»ºä¸­ä¸ºä¸€ä¸ªé•œåƒè®¾ç½®å¤šä¸ªæ ‡ç­¾ã€‚</li><li><code>-f</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„Dockerfileè·¯å¾„ï¼›</li></ul><h3 id="ä¸€ä¸ªæ —å­ğŸ¤–ï¼š"><a href="#ä¸€ä¸ªæ —å­ğŸ¤–ï¼š" class="headerlink" title="ä¸€ä¸ªæ —å­ğŸ¤–ï¼š"></a>ä¸€ä¸ªæ —å­ğŸ¤–ï¼š</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> centos:<span class="hljs-number">7</span><br><span class="hljs-keyword">ADD</span><span class="language-bash"> go1.18.4.linux-amd64.tar.gz /usr/local/go</span><br>&amp;&amp; Goweb /usr/home/<br><span class="hljs-keyword">ENV</span> PATH=$PATH:/usr/local/go/bin <br><span class="hljs-keyword">LABEL</span><span class="language-bash"> author=<span class="hljs-string">&quot;PEngxJ&quot;</span></span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /usr/home/</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> go run /usr/home/Goweb/main.go</span><br></code></pre></td></tr></table></figure><h2 id="é•œåƒè¿ç§»ï¼š"><a href="#é•œåƒè¿ç§»ï¼š" class="headerlink" title="é•œåƒè¿ç§»ï¼š"></a>é•œåƒè¿ç§»ï¼š</h2><h3 id="å¤‡ä»½ä¸æ¢å¤çš„æ–¹å¼ï¼š"><a href="#å¤‡ä»½ä¸æ¢å¤çš„æ–¹å¼ï¼š" class="headerlink" title="å¤‡ä»½ä¸æ¢å¤çš„æ–¹å¼ï¼š"></a>å¤‡ä»½ä¸æ¢å¤çš„æ–¹å¼ï¼š</h3><p><strong>å¤‡ä»½ï¼š</strong></p><p>è¯­æ³•ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">docker save <span class="hljs-selector-attr">[OPTIONS]</span> IMAGE <span class="hljs-selector-attr">[IMAGE...]</span><br></code></pre></td></tr></table></figure><ul><li>-o :è¾“å‡ºåˆ°çš„æ–‡ä»¶</li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker save -o myubuntu.tar ubuntu:v3<br></code></pre></td></tr></table></figure><p><strong>æ¢å¤ï¼š</strong></p><p>è¯­æ³•:</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">docker <span class="hljs-keyword">load</span> [<span class="hljs-keyword">OPTIONS</span>]<br></code></pre></td></tr></table></figure><ul><li>-i : æŒ‡å®šå¯¼å…¥çš„æ–‡ä»¶ï¼Œä»£æ›¿ STDINã€‚</li><li>-q : ç²¾ç®€è¾“å‡ºä¿¡æ¯ã€‚</li></ul><p>ä¾‹å­ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker load -i myubuntu.tar<br></code></pre></td></tr></table></figure><h3 id="ä¸Šä¼ è‡³ç§äººä¸å…±æœ‰çš„æ–¹å¼ï¼š"><a href="#ä¸Šä¼ è‡³ç§äººä¸å…±æœ‰çš„æ–¹å¼ï¼š" class="headerlink" title="ä¸Šä¼ è‡³ç§äººä¸å…±æœ‰çš„æ–¹å¼ï¼š"></a>ä¸Šä¼ è‡³ç§äººä¸å…±æœ‰çš„æ–¹å¼ï¼š</h3><p>å¾—å…ˆæ³¨å†Œä¸€ä¸ªåœ¨dockerhubä¸Šçš„å·ã€‚ç„¶åä½¿ç”¨<code>docker login</code>ç™»å½•ï¼Œ<code>docker logout</code>é€€å‡ºã€‚</p><h4 id="å…¬å…±ä»“åº“ï¼š"><a href="#å…¬å…±ä»“åº“ï¼š" class="headerlink" title="å…¬å…±ä»“åº“ï¼š"></a>å…¬å…±ä»“åº“ï¼š</h4><p><strong>ä¸Šä¼ ï¼š</strong></p><ol><li><p>docker tag : æ ‡è®°æœ¬åœ°é•œåƒã€‚</p><p>è¯­æ³•ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker tag IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]<br></code></pre></td></tr></table></figure><p>ä¾‹å­ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> tag hello-world:latest peng7066/test-hello-world:<span class="hljs-number">1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></li><li><p>docker pushï¼šä¸Šä¼ é•œåƒã€‚</p><p>è¯­æ³•:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker push NAME[:TAG]<br></code></pre></td></tr></table></figure><p>ä¾‹å­ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">docker</span> push peng7066/test-hello-world:<span class="hljs-number">1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure></li></ol><p><strong>æ‹‰å–ï¼š</strong></p><ol><li>docker pullï¼šæ‹‰å–é•œåƒ</li></ol><h4 id="ç§æœ‰ä»“åº“ï¼š"><a href="#ç§æœ‰ä»“åº“ï¼š" class="headerlink" title="ç§æœ‰ä»“åº“ï¼š"></a>ç§æœ‰ä»“åº“ï¼š</h4><p><strong>é…ç½®ç§æœ‰ä»“åº“è®¤è¯ï¼š</strong></p><ol><li><p>ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼š</p><ol><li><p>åˆ›å»ºè¯ä¹¦ç›®å½•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mkdir -p /usr/local/registry/certs<br></code></pre></td></tr></table></figure></li><li><p>ç”Ÿæˆè‡ªç­¾åè¯ä¹¦å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">openssl req -newkey rsa:2048 -nodes -sha256 -keyout /usr/local/registry/domain.key -x509 -days 365 -out /usr/local/registry/certs/domain.crt<br></code></pre></td></tr></table></figure><ul><li><code>openssl req</code>ï¼šåˆ›å»ºè¯ä¹¦ç­¾åè¯·æ±‚ç­‰åŠŸèƒ½ï¼›</li><li><code>-newkey</code>ï¼šåˆ›å»ºCSRè¯ä¹¦ç­¾åæ–‡ä»¶å’ŒRSAç§é’¥æ–‡ä»¶ï¼›</li><li><code>rsa:2048</code>ï¼šæŒ‡å®šåˆ›å»ºçš„RSAç§é’¥é•¿åº¦ä¸º2048ï¼›</li><li><code>-nodes</code>ï¼šå¯¹ç§é’¥ä¸è¿›è¡ŒåŠ å¯†ï¼›</li><li><code>-sha256</code>ï¼šä½¿ç”¨SHA256ç®—æ³•</li><li><code>-keyout</code>ï¼šåˆ›å»ºçš„ç§é’¥æ–‡ä»¶åç§°åŠä½ç½®</li><li><code>-x509</code>ï¼šè‡ªç­¾å‘è¯ä¹¦æ ¼å¼</li><li><code>-days</code>ï¼šè¯ä¹¦æœ‰æ•ˆæœŸ</li><li><code>-out</code>ï¼šæŒ‡å®šCSRè¾“å‡ºæ–‡ä»¶åç§°åŠä½ç½®</li></ul><p>é€šè¿‡openssl å…ˆç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼Œè¿è¡Œå‘½ä»¤åéœ€è¦å¡«å†™ä¸€äº›è¯ä¹¦ä¿¡æ¯ï¼Œé‡Œé¢æœ€å…³é”®çš„éƒ¨åˆ†æ˜¯ï¼š<code>Common Name (eg,your name or your server&#39;s hostname) []:81.70.10.115</code>ï¼Œè¿™é‡Œæ³¨æ„å¡«å†™çš„è¦æ˜¯è‡ªå·±æœåŠ¡å™¨çš„åœ°å€ã€‚</p></li></ol></li><li><p>ç”Ÿæˆé‰´æƒå¯†ç æ–‡ä»¶ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">åˆ›å»ºå­˜å‚¨é‰´æƒå¯†ç æ–‡ä»¶çš„ç›®å½•</span><br>mkdir -p /usr/local/registry/auth<br><span class="hljs-meta prompt_"># </span><span class="language-bash">å¦‚æœæ²¡æœ‰htpasswd åŠŸèƒ½éœ€è¦å®‰è£… htpasswd</span><br>yum install -y httpd<br><span class="hljs-meta prompt_">#</span><span class="language-bash">åˆ›å»ºç”¨æˆ·å’Œå¯†ç </span><br>htpasswd -Bbn root 1234 &gt; /usr/local/registry/auth/htpasswd<br></code></pre></td></tr></table></figure><blockquote><p>htpasswd æ˜¯ apache http çš„åŸºæœ¬è®¤è¯æ–‡ä»¶ï¼Œä½¿ç”¨htpasswd å‘½ä»¤å¯ä»¥ç”Ÿæˆç”¨æˆ·åŠå¯†ç æ–‡ä»¶</p></blockquote></li><li><p>æ‹‰å–é•œåƒåä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶<code>daemon.json</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/docker/daemon.json<br></code></pre></td></tr></table></figure><p>æ·»åŠ ä»¥ä¸‹å­—æ®µï¼ŒæŒ‡æ˜æˆ‘ä»¬çš„ç§æœ‰é•œåƒä»“åº“çš„åœ°å€</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs prolog"><span class="hljs-string">&quot;insecure-registries&quot;</span>: [<span class="hljs-string">&quot;81.70.10.115:5000&quot;</span>]<br></code></pre></td></tr></table></figure></li><li><p>åˆ›å»ºç§æœ‰ä»“åº“å®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -di --name registry -p 5000:5000 \<br>-v /mydata/docker_registry:/var/lib/registry \<br>-v /usr/local/registry/certs:/certs \<br>-v /usr/local/registry/auth:/auth \<br>-e &quot;REGISTRY_AUTH=htpasswd&quot; \<br>-e &quot;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&quot; \<br>-e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \<br>-e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \<br>-e REGISTRY_HTTP_TLE_KEY=/certs/domain.key \<br>registry<br></code></pre></td></tr></table></figure></li><li><p>ç™»å½•</p><p>è¿™æ—¶è¦æŒ‡å®šä»“åº“çš„åœ°å€</p><p><code>docker login 81.70.10.115:5000</code></p><p>ç„¶åå°±å¯ä»¥æ­£å¸¸åœ°<code>docker push</code>äº†</p><p>é€€å‡ºæ—¶ä¹Ÿè¦æŒ‡å®šä»“åº“çš„åœ°å€</p><p><code>docker logout 81.70.10.115:5000</code></p></li></ol><h2 id="ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š"><a href="#ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š"></a>ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š</h2><blockquote><p>é»˜è®¤çš„dockerç½‘ç»œæ¨¡å¼æœ‰ä¸‰ç§ï¼šbridgeï¼Œhostï¼Œnone</p><p>è‡ªå®šä¹‰çš„ç½‘ç»œå°±æ˜¯bridgeçš„æ”¹è¿›ç‰ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®¹å™¨çš„åç§°ç›´æ¥æ¥é€šè®¯ï¼Œè€Œä¸æ˜¯æ¯æ¬¡å¯åŠ¨éƒ½ä¼šæ”¹å˜çš„ipåœ°å€</p></blockquote><table><thead><tr><th>ç½‘ç»œæ¨¡å¼</th><th>ç®€ä»‹</th></tr></thead><tbody><tr><td>Bridge</td><td>åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œdocker daemon(å®ˆæŠ¤è¿›ç¨‹)åˆ›å»ºäº†ä¸€ä¸ªä»¥å¤ªç½‘æ¡¥<code>docker0</code>ï¼Œæ–°å»ºçš„å®¹å™¨ä¼šè‡ªåŠ¨æ¡¥æ¥åˆ°è¿™ä¸ªæ¥å£ï¼Œ<strong>å…·ä½“æµç¨‹æ˜¯ï¼š</strong>å®ˆæŠ¤è¿›ç¨‹ä¼šåˆ›å»ºä¸€å¯¹å¯¹ç­‰è™šæ‹Ÿè®¾å¤‡æ¥å£ï¼Œå°†å…¶ä¸­ä¸€ç«¯è®¾ä¸ºå®¹å™¨çš„<code>eth0</code>æ¥å£ï¼Œä¸€ç«¯ä¿å­˜åœ¨å®¿ä¸»æœºçš„å‘½åç©ºé—´ä¸­ã€‚å®¹å™¨åˆ›å»ºæ—¶é»˜è®¤ä½¿ç”¨è¯¥æ¨¡å¼ã€‚å®ƒåˆ†é…ipçš„è§„åˆ™æ˜¯æ ¹æ®å®¹å™¨çš„å¯åŠ¨é¡ºåºé€’å¢åˆ†é…çš„ï¼Œå°±ä¼šå‡ºç°ä¸Šé¢è¯´çš„æƒ…å†µï¼Œipåœ°å€ä¼šå˜åŠ¨ã€‚</td></tr><tr><td>Host</td><td>å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ipç­‰ã€‚<strong>è€Œæ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„ipå’Œç«¯å£</strong></td></tr><tr><td>none</td><td>å®¹å™¨æœ‰ç‹¬ç«‹çš„Network namespace,ä½†å¹¶æ²¡æœ‰è¿›è¡Œä»»ä½•ç½‘ç»œè®¾ç½®</td></tr></tbody></table><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5unw810twj20ol0dtdh8.jpg" alt="bridge"></p><h3 id="åˆ›å»ºç½‘ç»œï¼š"><a href="#åˆ›å»ºç½‘ç»œï¼š" class="headerlink" title="åˆ›å»ºç½‘ç»œï¼š"></a>åˆ›å»ºç½‘ç»œï¼š</h3><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker network create [OPTIONS] ç½‘ç»œåç§°<br></code></pre></td></tr></table></figure><p>é‡è¦å‚æ•°ï¼š</p><ul><li><code>-d</code>ï¼šå®šä¹‰ç½‘ç»œçš„é©±åŠ¨ç¨‹åºï¼Œé»˜è®¤ä¸ºbridge</li></ul><h3 id="ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š-1"><a href="#ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š-1" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š"></a>ä½¿ç”¨è‡ªå®šä¹‰ç½‘ç»œï¼š</h3><p>è¯­æ³•ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run --net ç½‘ç»œåç§° é•œåƒåç§°<br></code></pre></td></tr></table></figure><h3 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ:"></a>å…¶å®ƒ:</h3><p><strong>æ–­å¼€ï¼š</strong></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">docker network disconnect <br></code></pre></td></tr></table></figure><blockquote><p>è¿˜æœ‰ä¸ªé›†ç¾¤çš„éƒ¨åˆ†ï¼Œæœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>æ‰“æ€ªå‡çº§</category>
      
      <category>æå®šdocker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ğŸ®rediså…¥é—¨--ç®€å•å‘½ä»¤</title>
    <link href="/2022/07/28/redis%E5%85%A5%E9%97%A8--%E7%AE%80%E5%8D%95%E5%91%BD%E4%BB%A4/"/>
    <url>/2022/07/28/redis%E5%85%A5%E9%97%A8--%E7%AE%80%E5%8D%95%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰å­¦è¿‡ä¸€æ®µæ—¶é—´çš„redisï¼Œä½†ç¢äºå›«å›µåæ£ï¼Œè€Œä¸”æ²¡åšæ€»ç»“ï¼Œåæ¥åˆæ²¡æ€ä¹ˆç”¨ï¼Œæ‰€ä»¥å¿˜çš„ä¸ƒä¸ƒå…«å…«äº†ï¼Œè¿™æ¬¡è¦æ•´ä½“å¥½å¥½çš„å­¦ä¸€å­¦redisï¼Œé¦–å…ˆä»ç®€å•å‘½ä»¤å¼€å§‹ã€‚</p><span id="more"></span><h1 id="â›½rediså…¥é—¨â€“ç®€å•å‘½ä»¤ğŸ™‚"><a href="#â›½rediså…¥é—¨â€“ç®€å•å‘½ä»¤ğŸ™‚" class="headerlink" title="â›½rediså…¥é—¨â€“ç®€å•å‘½ä»¤ğŸ™‚"></a>â›½rediså…¥é—¨â€“ç®€å•å‘½ä»¤ğŸ™‚</h1><h2 id="äº”ç§æ•°æ®ç±»å‹ï¼š"><a href="#äº”ç§æ•°æ®ç±»å‹ï¼š" class="headerlink" title="äº”ç§æ•°æ®ç±»å‹ï¼š"></a>äº”ç§æ•°æ®ç±»å‹ï¼š</h2><h3 id="é”®å‘½ä»¤ï¼š"><a href="#é”®å‘½ä»¤ï¼š" class="headerlink" title="é”®å‘½ä»¤ï¼š"></a>é”®å‘½ä»¤ï¼š</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/keys-del.html">DEL key</a></td><td>åˆ é™¤é”®</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-dump.html">DUMP key</a></td><td>åºåˆ—åŒ–é”®å¯¹åº”çš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-exists.html">EXISTS key</a></td><td>åˆ¤æ–­é”®æ˜¯å¦å­˜åœ¨</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-expire.html">EXPIRE key</a> seconds</td><td>è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-expireat.html">EXPIREAT key timestamp</a></td><td>è®¾ç½®é”®åœ¨å…·ä½“çš„ä¸€ä¸ªæ—¶é—´è¿‡æœŸï¼Œå‚æ•°æ˜¯æ—¶é—´æˆ³çš„å½¢å¼</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-pexpire.html">PEXPIRE key milliseconds</a></td><td>è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´ï¼Œå‚æ•°ä»¥æ¯«ç§’ä¸ºå•ä½</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-pexpireat.html">PEXPIREAT key milliseconds-timestamp</a></td><td>è®¾ç½®é”®åœ¨å…·ä½“çš„ä¸€ä¸ªæ—¶é—´è¿‡æœŸï¼Œå‚æ•°æ˜¯æ¯«ç§’æ—¶é—´æˆ³çš„å½¢å¼</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-keys.html">KEYS pattern</a></td><td>åŒ¹é…ç¬¦åˆçš„KEY</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-move.html">MOVE key db</a></td><td>å°†é”®ç§»åˆ°å…¶å®ƒçš„æ•°æ®åº“</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-persist.html">PERSIST key</a></td><td>å°†KEYçš„è¿‡æœŸæ—¶é—´å»æ‰ï¼Œæ°¸ä¹…ä¿å­˜</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-pttl.html">PTTL key</a></td><td>è¿”å›Keyçš„æœ‰æ•ˆæ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-ttl.html">TTL key</a></td><td>åŒä¸Šï¼Œä»¥ç§’ä¸ºå•ä½</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-randomkey.html">RANDOMKEY</a></td><td>éšæœºè¿”å›ä¸€ä¸ªKey</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-rename.html">RENAME key newkey</a></td><td>é‡å‘½åï¼Œå¦‚æœnewkeyå·²ç»å­˜åœ¨ï¼Œåˆ™ä¼šè¦†ç›–</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-renamenx.html">RENAMENX key newkey</a></td><td>é‡å‘½åï¼Œä¸è¿‡åªæœ‰newkeyä¸å­˜åœ¨æ—¶æ‰ä¼šæˆåŠŸ</td></tr><tr><td>[SCAN cursor <a href="https://www.runoob.com/redis/keys-scan.html">MATCH pattern] [COUNT count]</a></td><td>éå†é”®ï¼Œæ¯æ¬¡è¿”å›ä¸€ä¸ª</td></tr><tr><td><a href="https://www.runoob.com/redis/keys-type.html">TYPE key</a></td><td>è¿”å›Keyçš„ç±»å‹</td></tr></tbody></table><h3 id="String-å­—ç¬¦ä¸²-ï¼š"><a href="#String-å­—ç¬¦ä¸²-ï¼š" class="headerlink" title="String(å­—ç¬¦ä¸²)ï¼š"></a>String(å­—ç¬¦ä¸²)ï¼š</h3><ul><li>stringæ˜¯redisä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªkeyå¯¹åº”ä¸€ä¸ªvalueã€‚</li><li>string ç±»å‹æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ã€‚æ„æ€æ˜¯å®ƒå¯ä»¥å­˜å‚¨ä»»ä½•æ•°æ®ï¼Œæ¯”å¦‚jpgå›¾ç‰‡å’Œåºåˆ—åŒ–åçš„å¯¹è±¡ã€‚</li><li>æœ€å¤šå¯ä»¥å­˜å‚¨512MB</li></ul><h4 id="å¢ï¼š"><a href="#å¢ï¼š" class="headerlink" title="å¢ï¼š"></a>å¢ï¼š</h4><table><thead><tr><th>å¢</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/strings-set.html">SET key value</a></td><td>è®¾ç½®æŒ‡å®šKEYçš„å€¼ï¼ŒKEYä¸å­˜åœ¨åˆ™æ˜¯æ·»åŠ ï¼Œå­˜åœ¨åˆ™æ˜¯ä¿®æ”¹è¦†ç›–</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-mset.html">MSET key value key value </a></td><td>åŒæ—¶è®¾ç½®å¤šä¸ªå€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-setbit.html">SETBIT key offset value</a></td><td>è®¾ç½®keyä¸Šä¸€ä¸ªä½çš„å€¼ï¼ˆ0æˆ–1ï¼‰</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-setex.html">SETEX key seconds value</a></td><td>è®¾ç½®ä¸€ä¸ªå€¼ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-psetex.html">PSETEX key milliseconds value</a></td><td>è®¾ç½®ä¸€ä¸ªå€¼ï¼Œå¹¶è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´çš„å•ä½æ¯«ç§’</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-setnx.html">SETNX key value</a></td><td>å½“KEYè¿˜æœªè¢«ä½¿ç”¨æ—¶ï¼Œåœ¨è¿™ä¸ªkeyä¸Šè®¾ä¸€ä¸ªå€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-msetnx.html">MSETNX key value key value </a></td><td>åŒæ—¶è®¾ç½®å¤šä¸ªå€¼ï¼Œåªæœ‰æ¯ä¸ªKEYéƒ½æœªè¢«ä½¿ç”¨æ—¶æˆåŠŸæ‰§è¡Œ</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incr.html">INCR key</a></td><td>ä¸ºæ•°å€¼åŠ 1</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incrby.html">INCRBY key increment</a></td><td>ä¸ºæ•°å€¼åŠ ä¸Šincrement</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incrbyfloat.html">INCRBYFLOAT key increment</a></td><td>å°† key æ‰€å‚¨å­˜çš„å€¼åŠ ä¸Šç»™å®šçš„æµ®ç‚¹å¢é‡å€¼ï¼ˆincrementï¼‰</td></tr></tbody></table><h4 id="åˆ ï¼š"><a href="#åˆ ï¼š" class="headerlink" title="åˆ ï¼š"></a>åˆ ï¼š</h4><table><thead><tr><th>åˆ </th><th>-</th></tr></thead><tbody><tr><td>DEL KEY</td><td>åˆ æŸ¥ä¸€ä¸ªé”®</td></tr><tr><td>å€Ÿé‰´ä¸Šé¢çš„è¿‡æœŸ</td><td></td></tr></tbody></table><h4 id="æŸ¥ï¼š"><a href="#æŸ¥ï¼š" class="headerlink" title="æŸ¥ï¼š"></a>æŸ¥ï¼š</h4><table><thead><tr><th>æŸ¥</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/strings-get.html">GET key</a></td><td>è·å–keyå¯¹åº”çš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-mget.html">MGET key1 key2</a></td><td>è·å–å¤šä¸ªkeyå¯¹åº”çš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-getrange.html">GETRANGE key start end</a></td><td>è·å–keyå€¼å¯¹åº”åŒºé—´çš„å­å­—ç¬¦ä¸²</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-getbit.html">GETBIT key offset</a></td><td>è·å–keyä¸Šä¸€ä¸ªä½çš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-strlen.html">STRLEN key</a></td><td>è·å–keyå¯¹åº”çš„å€¼çš„é•¿åº¦</td></tr></tbody></table><h4 id="æ”¹ï¼š"><a href="#æ”¹ï¼š" class="headerlink" title="æ”¹ï¼š"></a>æ”¹ï¼š</h4><table><thead><tr><th>æ”¹</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/strings-setrange.html">SETRANGE key offset value</a></td><td>ç”¨valueå€¼ä»offsetå¼€å§‹è¦†ç›–å†™</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incr.html">INCR key</a></td><td>ä¸ºæ•°å€¼åŠ 1</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incrby.html">INCRBY key increment</a></td><td>ä¸ºæ•°å€¼åŠ ä¸Šincrement</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-incrbyfloat.html">INCRBYFLOAT key increment</a></td><td>å°† key æ‰€å‚¨å­˜çš„å€¼åŠ ä¸Šç»™å®šçš„æµ®ç‚¹å¢é‡å€¼ï¼ˆincrementï¼‰</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-decr.html">DECR key</a></td><td>ä¸ºæ•°å€¼å‡1</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-decrby.html">DECRBY key decrement</a></td><td>ä¸ºæ•°å€¼å‡decremen</td></tr><tr><td><a href="https://www.runoob.com/redis/strings-append.html">APPEND key value</a></td><td>å¦‚æœ key å·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œ APPEND å‘½ä»¤å°†æŒ‡å®šçš„ value è¿½åŠ åˆ°è¯¥ key åŸæ¥å€¼ï¼ˆvalueï¼‰çš„æœ«å°¾ã€‚</td></tr></tbody></table><h3 id="Hash-å“ˆå¸Œ-ï¼š"><a href="#Hash-å“ˆå¸Œ-ï¼š" class="headerlink" title="Hash(å“ˆå¸Œ)ï¼š"></a>Hash(å“ˆå¸Œ)ï¼š</h3><h4 id="å¢ï¼š-1"><a href="#å¢ï¼š-1" class="headerlink" title="å¢ï¼š"></a>å¢ï¼š</h4><table><thead><tr><th>å¢</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/hashes-hset.html">HSET key field value</a></td><td>è®¾ç½®keyä¸Šä¸€ä¸ªé”®å€¼å¯¹</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hmset.html">HMSET key field1 value1 field2 value2 </a></td><td>è®¾ç½®keyä¸Šçš„å¤šä¸ªé”®å€¼å¯¹</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hsetnx.html">HSETNX key field value</a></td><td>å½“keyä¸Šçš„fieldå­—æ®µè¿˜æœªè®¾ç½®æ—¶ï¼Œæ·»åŠ è¯¥é”®å€¼å¯¹</td></tr></tbody></table><h4 id="åˆ ï¼š-1"><a href="#åˆ ï¼š-1" class="headerlink" title="åˆ ï¼š"></a>åˆ ï¼š</h4><table><thead><tr><th>åˆ </th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/hashes-hdel.html">HDEL key field1 field2</a></td><td>åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªkeyä¸­çš„å­—æ®µ</td></tr></tbody></table><h4 id="æŸ¥ï¼š-1"><a href="#æŸ¥ï¼š-1" class="headerlink" title="æŸ¥ï¼š"></a>æŸ¥ï¼š</h4><table><thead><tr><th>æŸ¥</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/hashes-hget.html">HGET key field</a></td><td>è·å–keyä¸­çš„å­—æ®µfieldçš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hmget.html">HMGET key field1 field2</a></td><td>è·å–keyä¸­å¤šä¸ªå­—æ®µfieldçš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hgetall.html">HGETALL key</a></td><td>è·å–åœ¨å“ˆå¸Œè¡¨ä¸­æŒ‡å®š key çš„æ‰€æœ‰å­—æ®µå’Œå€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hkeys.html">HKEYS key</a></td><td>è·å–æ‰€æœ‰å“ˆå¸Œè¡¨ä¸­çš„å­—æ®µ</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hvals.html">HVALS key</a></td><td>è·å–å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hlen.html">HLEN key</a></td><td>è·å–å“ˆå¸Œè¡¨ä¸­å­—æ®µçš„æ•°é‡</td></tr><tr><td>[HSCAN key cursor <a href="https://www.runoob.com/redis/hashes-hscan.html">MATCH pattern] [COUNT count]</a></td><td>è¿­ä»£å“ˆå¸Œè¡¨ä¸­çš„é”®å€¼å¯¹ã€‚patternæ˜¯å¯¹åº”fieldçš„</td></tr></tbody></table><h4 id="æ”¹ï¼š-1"><a href="#æ”¹ï¼š-1" class="headerlink" title="æ”¹ï¼š"></a>æ”¹ï¼š</h4><table><thead><tr><th>æ”¹</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/hashes-hincrby.html">HINCRBY key field increment</a></td><td>ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„æŒ‡å®šå­—æ®µçš„æ•´æ•°å€¼åŠ ä¸Šå¢é‡ increment</td></tr><tr><td><a href="https://www.runoob.com/redis/hashes-hincrbyfloat.html">HINCRBYFLOAT key field increment</a></td><td>ä¸ºå“ˆå¸Œè¡¨ key ä¸­çš„æŒ‡å®šå­—æ®µçš„æµ®ç‚¹æ•°å€¼åŠ ä¸Šå¢é‡ increment</td></tr></tbody></table><h3 id="List-åˆ—è¡¨-ï¼š"><a href="#List-åˆ—è¡¨-ï¼š" class="headerlink" title="List(åˆ—è¡¨)ï¼š"></a>List(åˆ—è¡¨)ï¼š</h3><h4 id="å¢ï¼š-2"><a href="#å¢ï¼š-2" class="headerlink" title="å¢ï¼š"></a>å¢ï¼š</h4><table><thead><tr><th>å¢</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/lists-lpush.html">LPUSH key value1 value2</a></td><td>å¾€é˜Ÿå¤´æ’å…¥å¤šä¸ªå€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-lpushx.html">LPUSHX key value</a></td><td>å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°å·²å­˜åœ¨çš„åˆ—è¡¨å¤´éƒ¨</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-rpush.html">RPUSH key value1 value2</a></td><td>åœ¨åˆ—è¡¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-rpushx.html">RPUSHX key value</a></td><td>ä¸ºå·²å­˜åœ¨çš„åˆ—è¡¨æ·»åŠ å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-linsert.html">LINSERT key BEFORE|AFTER pivot value</a></td><td>åœ¨åˆ—è¡¨ä¸­ä¸pivotç›¸ç­‰çš„å…ƒç´ å‰æˆ–è€…åæ’å…¥å…ƒç´ </td></tr></tbody></table><h4 id="åˆ ï¼š-2"><a href="#åˆ ï¼š-2" class="headerlink" title="åˆ ï¼š"></a>åˆ ï¼š</h4><table><thead><tr><th>åˆ </th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/lists-lpop.html">LPOP key</a></td><td>ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ </td></tr><tr><td><a href="https://www.runoob.com/redis/lists-rpop.html">RPOP key</a></td><td>ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›å€¼ä¸ºç§»é™¤çš„å…ƒç´ </td></tr><tr><td><a href="https://www.runoob.com/redis/lists-blpop.html">BLPOP key1 key2 timeout</a></td><td>ç§»å‡ºå¹¶è·å–åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-brpop.html">BRPOP key1 key2  timeout</a></td><td>åŒä¸Šï¼Œä¸è¿‡æ˜¯ç§»é™¤æœ€åä¸€ä¸ªå…ƒç´ </td></tr><tr><td><a href="https://www.runoob.com/redis/lists-rpoplpush.html">RPOPLPUSH source destination</a></td><td>ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†è¯¥å…ƒç´ æ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨å¹¶è¿”å›</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-brpoplpush.html">BRPOPLPUSH source destination timeout</a></td><td>ä»åˆ—è¡¨ä¸­å¼¹å‡ºä¸€ä¸ªå€¼ï¼Œå°†å¼¹å‡ºçš„å…ƒç´ æ’å…¥åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨ä¸­å¹¶è¿”å›å®ƒï¼› å¦‚æœåˆ—è¡¨æ²¡æœ‰å…ƒç´ ä¼šé˜»å¡åˆ—è¡¨ç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-lrem.html">LREM key count value</a></td><td>ç§»é™¤åˆ—è¡¨ä¸­ä¸valueç›¸ç­‰çš„ï¼Œcountç»å¯¹å€¼ä¸ªå…ƒç´ ï¼Œcountå¤§äº0è¡¨ç¤ºä»å¯¹å¤´å¼€å§‹çš„countä¸ªå…ƒç´ ï¼Œcountå°äº0è¡¨ç¤ºä»é˜Ÿå°¾å¼€å§‹çš„countä¸ªå…ƒç´ ï¼Œcount&#x3D;0åˆ™æ˜¯åˆ é™¤å…¨éƒ¨ç›¸ç­‰çš„</td></tr></tbody></table><h4 id="æŸ¥ï¼š-2"><a href="#æŸ¥ï¼š-2" class="headerlink" title="æŸ¥ï¼š"></a>æŸ¥ï¼š</h4><table><thead><tr><th>æŸ¥</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/lists-lindex.html">LINDEX key index</a></td><td>é€šè¿‡ç´¢å¼•è·å–åˆ—è¡¨ä¸­çš„å…ƒç´ </td></tr><tr><td><a href="https://www.runoob.com/redis/lists-llen.html">LLEN key</a></td><td>è·å–åˆ—è¡¨é•¿åº¦</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-lrange.html">LRANGE key start stop</a></td><td>è·å–åˆ—è¡¨æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ </td></tr></tbody></table><h4 id="æ”¹ï¼š-2"><a href="#æ”¹ï¼š-2" class="headerlink" title="æ”¹ï¼š"></a>æ”¹ï¼š</h4><table><thead><tr><th>æ”¹</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/lists-lset.html">LSET key index value</a></td><td>é€šè¿‡ç´¢å¼•è®¾ç½®åˆ—è¡¨å…ƒç´ çš„å€¼</td></tr><tr><td><a href="https://www.runoob.com/redis/lists-ltrim.html">LTRIM key start stop</a></td><td>å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œä¸åœ¨æŒ‡å®šåŒºé—´ä¹‹å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚</td></tr></tbody></table><h3 id="Set-é›†åˆ-ï¼š"><a href="#Set-é›†åˆ-ï¼š" class="headerlink" title="Set(é›†åˆ)ï¼š"></a>Set(é›†åˆ)ï¼š</h3><h4 id="å¢ï¼š-3"><a href="#å¢ï¼š-3" class="headerlink" title="å¢ï¼š"></a>å¢ï¼š</h4><table><thead><tr><th>å¢</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sets-sadd.html">SADD key member1 member2</a></td><td>å‘é›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr></tbody></table><h4 id="åˆ ï¼š-3"><a href="#åˆ ï¼š-3" class="headerlink" title="åˆ ï¼š"></a>åˆ ï¼š</h4><table><thead><tr><th>åˆ </th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sets-srem.html">SREM key member1 member2</a></td><td>ç§»é™¤é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-spop.html">SPOP key</a></td><td>ç§»é™¤å¹¶è¿”å›é›†åˆä¸­çš„ä¸€ä¸ªéšæœºå…ƒç´ </td></tr><tr><td><a href="https://www.runoob.com/redis/sets-smove.html">SMOVE source destination member</a></td><td>å°† member å…ƒç´ ä» source é›†åˆç§»åŠ¨åˆ° destination é›†åˆ</td></tr></tbody></table><h4 id="æŸ¥ï¼š-3"><a href="#æŸ¥ï¼š-3" class="headerlink" title="æŸ¥ï¼š"></a>æŸ¥ï¼š</h4><table><thead><tr><th>æŸ¥</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sets-scard.html">SCARD key</a></td><td>è·å–é›†åˆçš„æˆå‘˜æ•°</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sdiff.html">SDIFF key1 key2</a></td><td>è¿”å›ç¬¬ä¸€ä¸ªé›†åˆä¸å…¶ä»–é›†åˆä¹‹é—´çš„å·®å¼‚</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sdiffstore.html">SDIFFSTORE destination key1 key2</a></td><td>è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„å·®é›†å¹¶å­˜å‚¨åœ¨ destination ä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sinter.html">SINTER key1 key2</a></td><td>è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›†</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sinterstore.html">SINTERSTORE destination key1 key2</a></td><td>è¿”å›ç»™å®šæ‰€æœ‰é›†åˆçš„äº¤é›†å¹¶å­˜å‚¨åœ¨ destination ä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sunion.html">SUNION key1 key2</a></td><td>è¿”å›æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sunionstore.html">SUNIONSTORE destination key1 key2</a></td><td>æ‰€æœ‰ç»™å®šé›†åˆçš„å¹¶é›†å­˜å‚¨åœ¨ destination é›†åˆä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-sismember.html">SISMEMBER key member</a></td><td>åˆ¤æ–­ member å…ƒç´ æ˜¯å¦æ˜¯é›†åˆ key çš„æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-smembers.html">SMEMBERS key</a></td><td>è¿”å›é›†åˆä¸­çš„æ‰€æœ‰æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sets-srandmember.html">SRANDMEMBER key count</a></td><td>è¿”å›é›†åˆä¸­ä¸€ä¸ªæˆ–å¤šä¸ªéšæœºæ•°</td></tr><tr><td>[SSCAN key cursor <a href="https://www.runoob.com/redis/sets-sscan.html">MATCH pattern] [COUNT count]</a></td><td>è¿­ä»£é›†åˆä¸­çš„å…ƒç´ </td></tr></tbody></table><h3 id="zset-sorted-set-æœ‰åºé›†åˆ-ï¼š"><a href="#zset-sorted-set-æœ‰åºé›†åˆ-ï¼š" class="headerlink" title="zset(sorted set:æœ‰åºé›†åˆ)ï¼š"></a>zset(sorted set:æœ‰åºé›†åˆ)ï¼š</h3><h4 id="å¢ï¼š-4"><a href="#å¢ï¼š-4" class="headerlink" title="å¢ï¼š"></a>å¢ï¼š</h4><table><thead><tr><th>å¢</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zadd.html">ZADD key score1 member1 score2 member2</a></td><td>å‘æœ‰åºé›†åˆæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜ï¼Œæˆ–è€…æ›´æ–°å·²å­˜åœ¨æˆå‘˜çš„åˆ†æ•°</td></tr></tbody></table><h4 id="åˆ ï¼š-4"><a href="#åˆ ï¼š-4" class="headerlink" title="åˆ ï¼š"></a>åˆ ï¼š</h4><table><thead><tr><th>åˆ </th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrem.html">ZREM key member member </a></td><td>ç§»é™¤æœ‰åºé›†åˆä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªæˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zremrangebylex.html">ZREMRANGEBYLEX key min max</a></td><td>ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„å­—å…¸åŒºé—´çš„æ‰€æœ‰æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zremrangebyrank.html">ZREMRANGEBYRANK key start stop</a></td><td>ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„æ’ååŒºé—´çš„æ‰€æœ‰æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zremrangebyscore.html">ZREMRANGEBYSCORE key min max</a></td><td>ç§»é™¤æœ‰åºé›†åˆä¸­ç»™å®šçš„åˆ†æ•°åŒºé—´çš„æ‰€æœ‰æˆå‘˜</td></tr></tbody></table><h4 id="æŸ¥ï¼š-4"><a href="#æŸ¥ï¼š-4" class="headerlink" title="æŸ¥ï¼š"></a>æŸ¥ï¼š</h4><table><thead><tr><th>æŸ¥</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zcard.html">ZCARD key</a></td><td>è·å–æœ‰åºé›†åˆçš„æˆå‘˜æ•°</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zcount.html">ZCOUNT key min max</a></td><td>è®¡ç®—åœ¨æœ‰åºé›†åˆä¸­æŒ‡å®šåŒºé—´åˆ†æ•°çš„æˆå‘˜æ•°</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zlexcount.html">ZLEXCOUNT key min max</a></td><td>åœ¨æœ‰åºé›†åˆä¸­è®¡ç®—æŒ‡å®šå­—å…¸åŒºé—´å†…æˆå‘˜æ•°é‡</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrange.html">ZRANGE key start stop WITHSCORES</a></td><td>é€šè¿‡ç´¢å¼•åŒºé—´è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrevrange.html">ZREVRANGE key start stop WITHSCORES</a></td><td>è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šåŒºé—´å†…çš„æˆå‘˜ï¼Œé€šè¿‡ç´¢å¼•ï¼Œåˆ†æ•°ä»é«˜åˆ°ä½</td></tr><tr><td>[ZRANGEBYSCORE key min max <a href="https://www.runoob.com/redis/sorted-sets-zrangebyscore.html">WITHSCORES] [LIMIT offset count]</a></td><td>é€šè¿‡åˆ†æ•°è¿”å›æœ‰åºé›†åˆæŒ‡å®šåŒºé—´å†…çš„æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrevrangebyscore.html">ZREVRANGEBYSCORE key max min WITHSCORES</a></td><td>è¿”å›æœ‰åºé›†ä¸­æŒ‡å®šåˆ†æ•°åŒºé—´å†…çš„æˆå‘˜ï¼Œåˆ†æ•°ä»é«˜åˆ°ä½æ’åº</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrangebylex.html">ZRANGEBYLEX key min max LIMIT offset count</a></td><td>é€šè¿‡å­—å…¸åŒºé—´è¿”å›æœ‰åºé›†åˆçš„æˆå‘˜</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zinterstore.html">ZINTERSTORE destination numkeys key key </a></td><td>è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„äº¤é›†å¹¶å°†ç»“æœé›†å­˜å‚¨åœ¨æ–°çš„æœ‰åºé›†åˆ destination ä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zunionstore.html">ZUNIONSTORE destination numkeys key key</a></td><td>è®¡ç®—ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰åºé›†çš„å¹¶é›†ï¼Œå¹¶å­˜å‚¨åœ¨æ–°çš„ key ä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrank.html">ZRANK key member</a></td><td>è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„ç´¢å¼•</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zrevrank.html">ZREVRANK key member</a></td><td>è¿”å›æœ‰åºé›†åˆä¸­æŒ‡å®šæˆå‘˜çš„æ’åï¼Œæœ‰åºé›†æˆå‘˜æŒ‰åˆ†æ•°å€¼é€’å‡(ä»å¤§åˆ°å°)æ’åº</td></tr><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zscore.html">ZSCORE key member</a></td><td>è¿”å›æœ‰åºé›†ä¸­ï¼Œæˆå‘˜çš„åˆ†æ•°å€¼</td></tr><tr><td>[ZSCAN key cursor <a href="https://www.runoob.com/redis/sorted-sets-zscan.html">MATCH pattern] [COUNT count]</a></td><td>è¿­ä»£æœ‰åºé›†åˆä¸­çš„å…ƒç´ ï¼ˆåŒ…æ‹¬å…ƒç´ æˆå‘˜å’Œå…ƒç´ åˆ†å€¼ï¼‰</td></tr></tbody></table><h4 id="æ”¹ï¼š-3"><a href="#æ”¹ï¼š-3" class="headerlink" title="æ”¹ï¼š"></a>æ”¹ï¼š</h4><table><thead><tr><th>æ”¹</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/sorted-sets-zincrby.html">ZINCRBY key increment member</a></td><td>æœ‰åºé›†åˆä¸­å¯¹æŒ‡å®šæˆå‘˜çš„åˆ†æ•°åŠ ä¸Šå¢é‡ increment</td></tr></tbody></table><h2 id="åŸºæ•°ç»Ÿè®¡ï¼š"><a href="#åŸºæ•°ç»Ÿè®¡ï¼š" class="headerlink" title="åŸºæ•°ç»Ÿè®¡ï¼š"></a>åŸºæ•°ç»Ÿè®¡ï¼š</h2><blockquote><p>Redis HyperLogLog æ˜¯ç”¨æ¥åšåŸºæ•°ç»Ÿè®¡çš„ç®—æ³•ï¼ŒHyperLogLog çš„ä¼˜ç‚¹æ˜¯ï¼Œåœ¨è¾“å…¥å…ƒç´ çš„æ•°é‡æˆ–è€…ä½“ç§¯éå¸¸éå¸¸å¤§æ—¶ï¼Œè®¡ç®—åŸºæ•°æ‰€éœ€çš„ç©ºé—´æ€»æ˜¯å›ºå®š çš„ã€å¹¶ä¸”æ˜¯å¾ˆå°çš„ã€‚</p><p>ä»€ä¹ˆæ˜¯åŸºæ•°?</p><p>æ¯”å¦‚æ•°æ®é›† {1, 3, 5, 7, 5, 7, 8}ï¼Œ é‚£ä¹ˆè¿™ä¸ªæ•°æ®é›†çš„åŸºæ•°é›†ä¸º {1, 3, 5 ,7, 8}, åŸºæ•°(ä¸é‡å¤å…ƒç´ )ä¸º5ã€‚ åŸºæ•°ä¼°è®¡å°±æ˜¯åœ¨è¯¯å·®å¯æ¥å—çš„èŒƒå›´å†…ï¼Œå¿«é€Ÿè®¡ç®—åŸºæ•°ã€‚</p></blockquote><table><thead><tr><th>-</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/hyperloglog-pfadd.html">PFADD key element element</a></td><td>æ·»åŠ æŒ‡å®šå…ƒç´ åˆ° HyperLogLog ä¸­</td></tr><tr><td><a href="https://www.runoob.com/redis/hyperloglog-pfcount.html">PFCOUNT key key</a></td><td>è¿”å›ç»™å®š HyperLogLog çš„åŸºæ•°å€¼ï¼Œå¦‚æœå¤šä¸ª HyperLogLog åˆ™è¿”å›åŸºæ•°ä¼°å€¼ä¹‹å’Œã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/hyperloglog-pfmerge.html">PFMERGE destkey sourcekey sourcekey </a></td><td>å°†å¤šä¸ª HyperLogLog åˆå¹¶ä¸ºä¸€ä¸ª HyperLogLog</td></tr></tbody></table><h2 id="å‘å¸ƒè®¢é˜…ï¼š"><a href="#å‘å¸ƒè®¢é˜…ï¼š" class="headerlink" title="å‘å¸ƒè®¢é˜…ï¼š"></a>å‘å¸ƒè®¢é˜…ï¼š</h2><blockquote><p>Redis å‘å¸ƒè®¢é˜… (pub&#x2F;sub) æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€… (pub) å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€… (sub) æ¥æ”¶æ¶ˆæ¯ã€‚</p></blockquote><table><thead><tr><th>-</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/pub-sub-subscribe.html">SUBSCRIBE channel channel </a></td><td>è®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/pub-sub-psubscribe.html">PSUBSCRIBE pattern pattern</a></td><td>è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“</td></tr><tr><td>[PUNSUBSCRIBE <a href="https://www.runoob.com/redis/pub-sub-punsubscribe.html">pattern [pattern â€¦]]</a></td><td>é€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“</td></tr><tr><td><a href="https://www.runoob.com/redis/pub-sub-publish.html">PUBLISH channel message</a></td><td>å°†ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“</td></tr><tr><td>[UNSUBSCRIBE <a href="https://www.runoob.com/redis/pub-sub-unsubscribe.html">channel [channel â€¦]]</a></td><td>æŒ‡é€€è®¢ç»™å®šçš„é¢‘é“</td></tr><tr><td><a href="https://www.runoob.com/redis/pub-sub-pubsub.html">PUBSUB channels pattern</a></td><td>Pattern æœ‰åˆ™è¿”å›è·Ÿpatternç›¸å…³çš„ï¼Œæ²¡æœ‰åˆ™è¿”å›å…¨éƒ¨</td></tr></tbody></table><h2 id="äº‹åŠ¡ï¼š"><a href="#äº‹åŠ¡ï¼š" class="headerlink" title="äº‹åŠ¡ï¼š"></a>äº‹åŠ¡ï¼š</h2><blockquote><p>å•ä¸ª Redis å‘½ä»¤çš„æ‰§è¡Œæ˜¯åŸå­æ€§çš„ï¼Œä½† Redis æ²¡æœ‰åœ¨äº‹åŠ¡ä¸Šå¢åŠ ä»»ä½•ç»´æŒåŸå­æ€§çš„æœºåˆ¶ï¼Œæ‰€ä»¥ Redis äº‹åŠ¡çš„æ‰§è¡Œå¹¶ä¸æ˜¯åŸå­æ€§çš„ã€‚</p><p>äº‹åŠ¡å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ‰“åŒ…çš„æ‰¹é‡æ‰§è¡Œè„šæœ¬ï¼Œä½†æ‰¹é‡æŒ‡ä»¤å¹¶éåŸå­åŒ–çš„æ“ä½œï¼Œä¸­é—´æŸæ¡æŒ‡ä»¤çš„å¤±è´¥ä¸ä¼šå¯¼è‡´å‰é¢å·²åšæŒ‡ä»¤çš„å›æ»šï¼Œä¹Ÿä¸ä¼šé€ æˆåç»­çš„æŒ‡ä»¤ä¸åšã€‚</p></blockquote><table><thead><tr><th>-</th><th>-</th></tr></thead><tbody><tr><td><a href="https://www.runoob.com/redis/transactions-multi.html">MULTI</a></td><td>æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/transactions-exec.html">EXEC</a></td><td>æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/transactions-discard.html">DISCARD</a></td><td>å–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡å—å†…çš„æ‰€æœ‰å‘½ä»¤ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/transactions-watch.html">WATCH key key</a></td><td>ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ã€‚</td></tr><tr><td><a href="https://www.runoob.com/redis/transactions-unwatch.html">UNWATCH</a></td><td>å–æ¶ˆ WATCH å‘½ä»¤å¯¹æ‰€æœ‰ key çš„ç›‘è§†ã€‚</td></tr></tbody></table><h2 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h2><blockquote><p>Redis Stream æ˜¯ Redis 5.0 ç‰ˆæœ¬æ–°å¢åŠ çš„æ•°æ®ç»“æ„ã€‚</p><p>Redis Stream ä¸»è¦ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMQï¼ŒMessage Queueï¼‰ï¼ŒRedis æœ¬èº«æ˜¯æœ‰ä¸€ä¸ª Redis å‘å¸ƒè®¢é˜… (pub&#x2F;sub) æ¥å®ç°æ¶ˆæ¯é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œä½†å®ƒæœ‰ä¸ªç¼ºç‚¹å°±æ˜¯æ¶ˆæ¯æ— æ³•æŒä¹…åŒ–ï¼Œå¦‚æœå‡ºç°ç½‘ç»œæ–­å¼€ã€Redis å®•æœºç­‰ï¼Œæ¶ˆæ¯å°±ä¼šè¢«ä¸¢å¼ƒã€‚</p><p>ç®€å•æ¥è¯´å‘å¸ƒè®¢é˜… (pub&#x2F;sub) å¯ä»¥åˆ†å‘æ¶ˆæ¯ï¼Œä½†æ— æ³•è®°å½•å†å²æ¶ˆæ¯ã€‚</p><p>è€Œ Redis Stream æä¾›äº†æ¶ˆæ¯çš„æŒä¹…åŒ–å’Œä¸»å¤‡å¤åˆ¶åŠŸèƒ½ï¼Œå¯ä»¥è®©ä»»ä½•å®¢æˆ·ç«¯è®¿é—®ä»»ä½•æ—¶åˆ»çš„æ•°æ®ï¼Œå¹¶ä¸”èƒ½è®°ä½æ¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„è®¿é—®ä½ç½®ï¼Œè¿˜èƒ½ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚</p></blockquote><table><thead><tr><th>-</th><th>-</th></tr></thead><tbody><tr><td>XADD key ID field value [field value â€¦]</td><td><strong>key</strong> ï¼šé˜Ÿåˆ—åç§°ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»º <strong>ID</strong> ï¼šæ¶ˆæ¯ idï¼Œæˆ‘ä»¬ä½¿ç”¨ * è¡¨ç¤ºç”± redis ç”Ÿæˆï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œä½†æ˜¯è¦è‡ªå·±ä¿è¯é€’å¢æ€§ã€‚ <strong>field value</strong> ï¼š è®°å½•ã€‚</td></tr><tr><td>XTRIM key MAXLEN</td><td><strong>key</strong> ï¼šé˜Ÿåˆ—åç§° <strong>MAXLEN</strong> ï¼šé•¿åº¦</td></tr><tr><td>XDEL key ID [ID â€¦]</td><td><strong>key</strong>ï¼šé˜Ÿåˆ—åç§° <strong>ID</strong> ï¼šæ¶ˆæ¯ ID</td></tr><tr><td>XLEN key</td><td>ä½¿ç”¨ XLEN è·å–æµåŒ…å«çš„å…ƒç´ æ•°é‡ï¼Œå³æ¶ˆæ¯é•¿åº¦</td></tr><tr><td>XRANGE key start end [COUNT count]</td><td><strong>key</strong> ï¼šé˜Ÿåˆ—å <strong>start</strong> ï¼šå¼€å§‹å€¼ï¼Œ <strong>-</strong> è¡¨ç¤ºæœ€å°å€¼ <strong>end</strong> ï¼šç»“æŸå€¼ï¼Œ <strong>+</strong> è¡¨ç¤ºæœ€å¤§å€¼ <strong>count</strong> ï¼šæ•°é‡</td></tr><tr><td>XREVRANGE key end start [COUNT count]</td><td><strong>key</strong> ï¼šé˜Ÿåˆ—å <strong>end</strong> ï¼šç»“æŸå€¼ï¼Œ <strong>+</strong> è¡¨ç¤ºæœ€å¤§å€¼ <strong>start</strong> ï¼šå¼€å§‹å€¼ï¼Œ <strong>-</strong> è¡¨ç¤ºæœ€å°å€¼ <strong>count</strong> ï¼šæ•°é‡</td></tr><tr><td>XREAD [COUNT count] [BLOCK milliseconds] STREAMS key [key â€¦] id [id â€¦]</td><td><strong>count</strong> ï¼šæ•°é‡ <strong>milliseconds</strong> ï¼šå¯é€‰ï¼Œé˜»å¡æ¯«ç§’æ•°ï¼Œæ²¡æœ‰è®¾ç½®å°±æ˜¯éé˜»å¡æ¨¡å¼ <strong>key</strong> ï¼šé˜Ÿåˆ—å <strong>id</strong> ï¼šæ¶ˆæ¯ ID</td></tr><tr><td>XGROUP [CRETE KEY groupname id-or-$]</td><td><strong>key</strong> ï¼šé˜Ÿåˆ—åç§°ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»º <strong>groupname</strong> ï¼šç»„åã€‚ <strong>$</strong> ï¼š è¡¨ç¤ºä»å°¾éƒ¨å¼€å§‹æ¶ˆè´¹ï¼Œåªæ¥å—æ–°æ¶ˆæ¯ï¼Œå½“å‰ Stream æ¶ˆæ¯ä¼šå…¨éƒ¨å¿½ç•¥ã€‚</td></tr><tr><td>XREADGROUP GROUP group consumer [COUNT count] [BLOCK milliseconds] [NOACK] STREAMS key [key â€¦] ID [ID â€¦]</td><td><strong>group</strong> ï¼šæ¶ˆè´¹ç»„å <strong>consumer</strong> ï¼šæ¶ˆè´¹è€…åã€‚ <strong>count</strong> ï¼š è¯»å–æ•°é‡ã€‚ <strong>milliseconds</strong> ï¼š é˜»å¡æ¯«ç§’æ•°ã€‚ <strong>key</strong> ï¼š é˜Ÿåˆ—åã€‚ <strong>ID</strong> ï¼š æ¶ˆæ¯ IDã€‚</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>æ‰“æ€ªå‡çº§</category>
      
      <category>redis</category>
      
    </categories>
    
    
    <tags>
      
      <tag>redis</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>âš’è®¤è¯ä¸æˆæƒ--cookie|session|token|JWT</title>
    <link href="/2022/07/27/%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/"/>
    <url>/2022/07/27/%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83/</url>
    
    <content type="html"><![CDATA[<p>ç”¨æˆ·è®¤è¯ä¸æˆæƒæ˜¯ä¸€ä¸ªç³»ç»Ÿæœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä»¬ä¸€èµ·äº†è§£ä¸‹å¸¸è§çš„è§£å†³æ–¹æ¡ˆçš„ç‰¹æ€§ä¸ä»–ä»¬ç›¸äº’é—´çš„å·®åˆ«ï¼Œæœ€åæ˜¯JWTåœ¨Goä¸Šçš„ä½¿ç”¨æ¡ˆä¾‹ã€‚</p><span id="more"></span><h1 id="ğŸ˜€è®¤è¯ä¸æˆæƒï¼š"><a href="#ğŸ˜€è®¤è¯ä¸æˆæƒï¼š" class="headerlink" title="ğŸ˜€è®¤è¯ä¸æˆæƒï¼š"></a>ğŸ˜€è®¤è¯ä¸æˆæƒï¼š</h1><blockquote><p>å¸¸è§çš„è§£å†³æ–¹æ¡ˆæœ‰cookieã€sessionã€token</p><p>åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°æœ‰äººç”¨äº†ä¸€ä¸ªå¾ˆç§’çš„ä¾‹å­æ¥æè¿°è¿™ä¸‰ä¸ªä¸œè¥¿ğŸ‘ï¼šåœ¨å­¦æ ¡æˆ–å…¬å¸ï¼Œå…¥å­¦å…¥èŒçš„é‚£ä¸€å¤©ï¼Œä¼šå½•å…¥ä½ çš„èº«ä»½ã€è´¦æˆ·ä¿¡æ¯ï¼Œç„¶åç»™ä½ å‘ä¸ªå¡ï¼Œä»Šååœ¨å›­åŒºå†…ï¼Œä½ çš„é—¨ç¦ã€æ‰“å¡ã€æ¶ˆè´¹éƒ½åªéœ€è¦è¿™å¼ å¡ã€‚</p></blockquote><h2 id="ğŸ˜Cookieï¼š"><a href="#ğŸ˜Cookieï¼š" class="headerlink" title="ğŸ˜Cookieï¼š"></a>ğŸ˜Cookieï¼š</h2><h3 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><ul><li>ä¿å­˜åœ¨å®¢æˆ·ç«¯</li><li>ä¸å¯è·¨åŸŸï¼Œæ¯ä¸ªCookieä¼šè¢«ç»‘å®šåœ¨å•ä¸€åŸŸåä¸‹ï¼Œæ— æ³•åœ¨åˆ«çš„åŸŸåä¸‹ä½¿ç”¨</li></ul><h3 id="å±æ€§ï¼ˆ1-â‘¥ï¼‰ï¼š"><a href="#å±æ€§ï¼ˆ1-â‘¥ï¼‰ï¼š" class="headerlink" title="å±æ€§ï¼ˆ1+â‘¥ï¼‰ï¼š"></a>å±æ€§ï¼ˆ1+â‘¥ï¼‰ï¼š</h3><ul><li><p><strong>é”®å€¼å¯¹</strong>ï¼šåœ¨Cookieä¸­è®¾ç½®è‡ªå®šä¹‰çš„å€¼ï¼Œegï¼š<code>id=&quot;123456&quot;</code></p></li><li><p><strong>Cookieçš„åŸŸï¼š</strong>åœ¨å“åº”é¦–éƒ¨çš„Set-Cookieæ·»åŠ domainå±æ€§ï¼Œæ¥æ§åˆ¶å“ªäº›ç«™ç‚¹èƒ½çœ‹åˆ°è¿™ä¸ªCookieã€‚egï¼š<code>Set-Cookie: name=&quot;Peng&quot;;domain=&quot;m.zhuanzhuan.58.com&quot;</code>ï¼Œå¦‚æœç”¨æˆ·è®¿é—®çš„æ˜¯m.zhuanzhuan.58.comï¼Œæˆ–è€…m.zhuanzhuan.58.com&#x2F;user åˆ™éƒ½å¯ä»¥ï¼Œè€Œå¦‚æœæ˜¯<a href="http://www.aaa.com(ézhuanzhuan.58.com)å°±ä¸ä¼šçœ‹åˆ°è¿™ä¸ªcookie./">www.aaa.com(ézhuanzhuan.58.com)å°±ä¸ä¼šçœ‹åˆ°è¿™ä¸ªCookieã€‚</a></p></li><li><p><strong>Cookieçš„è·¯å¾„Pathï¼š</strong>é€šè¿‡æ·»åŠ Pathå±æ€§å¯ä»¥åœ¨ç‰¹å®šçš„è·¯å¾„ï¼ˆè¿™ä¸ªå±æ€§è®¾ç½®çš„Urlå’Œå¸¦æœ‰è¿™ä¸ªå‰ç¼€çš„Urlè·¯å¾„éƒ½æ˜¯æœ‰æ•ˆçš„ï¼‰ä¸‹è·å¾—Cookieã€‚</p></li><li><p><strong>Secureï¼š</strong>è®¾ç½®äº†å±æ€§Secureï¼Œ<code>Set-Cookie: name=&quot;Peng&quot;;domain=&quot;m.zhuanzhuan.58.com&quot;;Secure</code>ï¼Œåˆ™è¿™ä¸ªCookieåªæœ‰åœ¨httpsåè®®åŠ å¯†çš„æƒ…å†µä¸‹æ‰ä¼šå‘é€ç»™å®¢æˆ·ç«¯</p></li><li><p>**HTTP only:**è®¾ç½®è¯¥å±æ€§åï¼Œåˆ™æ— æ³•é€šè¿‡JSè„šæœ¬æ¥è·å¾—Cookieã€‚</p></li><li><p><strong>Expiresï¼š</strong>è®¾ç½®Cookieçš„è¿‡æœŸæ—¶é—´ï¼ŒGMTæ ¼å¼ï¼Œåˆ°è¾¾è¯¥æ—¶é—´åCookieä¼šè‡ªåŠ¨å¤±æ•ˆã€‚</p></li><li><p><strong>max-ageï¼š</strong>åœ¨HTTP1.1ä¸­å®šä¹‰çš„ï¼Œä¼˜å…ˆçº§é«˜äºExpiresï¼Œè¡¨ç¤ºCookieçš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ï¼Œå½“å€¼ä¸ºæ­£æ•°æ—¶è¡¨ç¤ºå†è¿‡å»nç§’åè¯¥Cookieå¤±æ•ˆï¼Œå½“å€¼ä¸ºè´Ÿæ•°æ—¶ï¼Œè¡¨ç¤ºè¯¥Cookieä¸ºä¸´æ—¶Cookieï¼Œåœ¨æµè§ˆå™¨é€€å‡ºåè¯¥Cookieåˆ™å¤±æ•ˆï¼Œå¦‚æœå€¼ä¸º0åˆ™è¡¨ç¤ºå–æ¶ˆè¯¥Cookieã€‚é»˜è®¤ä¸º-1ã€‚</p></li></ul><h3 id="è¿‡ç¨‹ï¼š"><a href="#è¿‡ç¨‹ï¼š" class="headerlink" title="è¿‡ç¨‹ï¼š"></a>è¿‡ç¨‹ï¼š</h3><p><img src="https://pic.rmb.bdstatic.com/bjh/9005b6a0f0e19e96d433046bbf434448.png"></p><ol><li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼ˆæˆ–å…¶å®ƒè®¤è¯æ–¹å¼ï¼‰åˆ°æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨è®¤è¯æˆåŠŸåï¼Œå°±ä¼šåˆ©ç”¨Set-cookieçš„å¤´éƒ¨å­—æ®µï¼Œå°†Cookieè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯ä¸‹ä¸€æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œè¯·æ±‚é¦–éƒ¨åˆ™ä¼šå¸¦ä¸Šè¿™ä¸ªCookie</li><li>æœåŠ¡å™¨é€šè¿‡å®¢æˆ·ç«¯å‘æ¥çš„Cookieï¼Œä¾¿èƒ½çŸ¥é“å‘å‡ºè¯¥è¯·æ±‚çš„ç”¨æˆ·ï¼Œå¹¶å†³å®šæ˜¯å¦é€šè¿‡</li></ol><h2 id="Session-ğŸ˜œ"><a href="#Session-ğŸ˜œ" class="headerlink" title="Session:ğŸ˜œ"></a>Session:ğŸ˜œ</h2><blockquote><p>å¯¹åº”äºSessionå°±æ˜¯ï¼Œå…¶å®ä½ çš„å¡ä¸Šåªå­˜äº†ä¸€ä¸ªidï¼ˆå¯èƒ½æ˜¯ä½ çš„å­¦å·ï¼‰ï¼Œåˆ·çš„æ—¶å€™ç‰©ä¸šç³»ç»Ÿå°±ä¼šå»æŸ¥ä½ çš„ä¿¡æ¯ã€è´¦æˆ·ï¼Œå†å†³å®šâ€œè¿™ä¸ªé—¨ä½ èƒ½ä¸èƒ½è¿›â€â€œè¿™ä¸ªé¸¡è…¿å»å“ªä¸ªè´¦æˆ·æ‰£é’±â€</p></blockquote><h3 id="ç‰¹ç‚¹ï¼š-1"><a href="#ç‰¹ç‚¹ï¼š-1" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><ul><li>æœ‰é‡è¦ä¿¡æ¯ï¼ˆç”¨æˆ·ä¿¡æ¯ï¼ŒSessionçŠ¶æ€ç­‰ï¼‰çš„Sessionä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œè€Œä¼šç”Ÿæˆä¸€ä¸ªSessionIdç»™å®¢æˆ·ç«¯ä¿å­˜ã€‚</li><li>ä¸€èˆ¬åŸºäºCookieå®ç°ã€‚</li></ul><h3 id="è¿‡ç¨‹ï¼š-1"><a href="#è¿‡ç¨‹ï¼š-1" class="headerlink" title="è¿‡ç¨‹ï¼š"></a>è¿‡ç¨‹ï¼š</h3><p><img src="https://pic3.zhimg.com/80/v2-18bd4826103a35c3ef4d99742ad1bd12_1440w.jpg"></p><ol><li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼ˆæˆ–å…¶å®ƒè®¤è¯æ–¹å¼ï¼‰åˆ°æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨è®¤è¯æˆåŠŸåï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆä¸€ä¸ªSessionï¼Œä¿å­˜åœ¨æ–‡ä»¶æˆ–è€…å†…å­˜æˆ–ç¼“å­˜ä¸­ï¼Œç„¶åè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªSessionIdï¼ŒSessionIdä¼šè¢«å®¢æˆ·ç«¯ä¿å­˜åœ¨Cookieä¸Šã€‚</li><li>å®¢æˆ·ç«¯ä¸‹ä¸€æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šè‡ªåŠ¨å¸¦ä¸ŠCookieï¼ŒCookieä¸­ä¼šæºå¸¦SessionIdã€‚</li><li>æœåŠ¡å™¨æ¥å—åˆ°Cookieåï¼Œæ£€æŸ¥SessionIdçš„æœ‰æ•ˆæ€§åï¼Œå†³å®šæ˜¯å¦é€šè¿‡ã€‚</li></ol><h2 id="ğŸ˜‹Tokenï¼š"><a href="#ğŸ˜‹Tokenï¼š" class="headerlink" title="ğŸ˜‹Tokenï¼š"></a>ğŸ˜‹Tokenï¼š</h2><blockquote><p>å¯¹åº”äºTokenå°±æ˜¯ï¼Œåœ¨æ¯”è¾ƒæ—©ä¹‹å‰ï¼Œåœ¨æ²¡æœ‰æ ¡å›­å¡æŠ€æœ¯ä»¥å‰ï¼Œæˆ‘ä»¬éƒ½é å­¦ç”Ÿè¯ã€‚é—¨å«å°å“¥ç›´æ¥å¯¹ç…§æˆ‘å’Œå­¦ç”Ÿè¯ä¸Šçš„è„¸ï¼Œç¡®è®¤å­¦ç”Ÿè¯æœ‰æ•ˆæœŸã€å¹´çºªç­‰ä¿¡æ¯ï¼Œå°±å¯ä»¥æ”¾è¡Œäº†ã€‚</p></blockquote><h3 id="ç‰¹ç‚¹ï¼š-2"><a href="#ç‰¹ç‚¹ï¼š-2" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><ul><li>æœåŠ¡å™¨ä¸ç”¨å†å­˜å‚¨ä¿¡æ¯ï¼Œå‡å°‘æœåŠ¡å™¨çš„å‹åŠ›ã€‚</li><li>Tokenä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ŒæœåŠ¡å™¨åªéœ€æ£€éªŒTokençš„æœ‰æ•ˆæ€§</li></ul><h3 id="è¿‡ç¨‹ï¼š-2"><a href="#è¿‡ç¨‹ï¼š-2" class="headerlink" title="è¿‡ç¨‹ï¼š"></a>è¿‡ç¨‹ï¼š</h3><p><img src="https://pic2.zhimg.com/80/v2-45c53c27a611d78c489a25f3496c7625_1440w.jpg"></p><ol><li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼ˆæˆ–å…¶å®ƒè®¤è¯æ–¹å¼ï¼‰åˆ°æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨è®¤è¯æˆåŠŸåï¼Œåœ¨æœåŠ¡å™¨ç«¯ç”Ÿæˆä¸€ä¸ªTokenï¼Œè¿™é‡Œå±•ç¤ºçš„æ˜¯é€šè¿‡Cookieä¼ å›token,tokené‡Œé¢åŒ…æ‹¬äº†åŸºæœ¬çš„ç”¨æˆ·ä¿¡æ¯ã€‚</li><li>å®¢æˆ·ç«¯ä¿å­˜Tokenåï¼Œä¸‹æ¬¡è¯·æ±‚æ—¶ä¼šå¸¦ä¸ŠToken</li><li>æœåŠ¡å™¨æ£€éªŒTokençš„æœ‰æ•ˆæ€§åï¼Œå†³å®šæ˜¯å¦é€šè¿‡ã€‚</li></ol><p><strong>è€ƒè™‘åˆ°ç¼–ç ï¼Œé˜²ç¯¡æ”¹ç­‰é—®é¢˜æˆ‘ä»¬ç›´æ¥è®²Tokençš„ä¸€ä¸ªå®è·µJWTï¼ˆJson Web Tokenï¼‰</strong></p><h2 id="JWT"><a href="#JWT" class="headerlink" title="JWT:"></a>JWT:</h2><p><img src="https://pic.rmb.bdstatic.com/bjh/f5b29a28f7c421c77022122c1d291c6c.png" alt="image-20220722172608892"></p><center>ä¸€ä¸ªå®Œæ•´çš„JWTçš„ç»“æ„</center><h3 id="ç‰¹ç‚¹ï¼š-3"><a href="#ç‰¹ç‚¹ï¼š-3" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><ul><li>ç»§æ‰¿ä¸Šé¢Tokençš„ä¼˜åŠ¿ï¼Œè¿›ä¸€æ­¥åœ°æ”¹å–„äº†ç¼–ç ï¼Œé˜²ç¯¡æ”¹çš„é—®é¢˜ã€‚</li></ul><h3 id="ä¸‰å¤§ç»„æˆï¼š"><a href="#ä¸‰å¤§ç»„æˆï¼š" class="headerlink" title="ä¸‰å¤§ç»„æˆï¼š"></a>ä¸‰å¤§ç»„æˆï¼š</h3><p><strong>Headerï¼š</strong></p><p>Headerä¸»è¦ä¿å­˜äº†è¿™ä¸ªJWTçš„å…ƒæ•°æ®ï¼Œä¸»è¦å°±æ˜¯ä¸¤ä¸ªéƒ¨åˆ†:<code>alg</code>å’Œ<code>typ</code>ï¼Œ<code>alg</code>å±æ€§è¡¨ç¤ºç­¾åçš„ç®—æ³•(algorithm),é»˜è®¤æ˜¯HMAC SHA256 ç®€å†™ä¸ºHS256ï¼Œ<code>typ</code>è¡¨ç¤ºTokençš„ç±»å‹ï¼ŒJWTåˆ™ä¸ºJWTã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;alg&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;HS256&quot;</span><span class="hljs-punctuation">,</span><br><span class="hljs-attr">&quot;typ&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;JWT&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p><strong>Payloadï¼š</strong></p><p>Payloadåˆ™æ˜¯å­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼ŒJWTè§„å®šäº†7ä¸ªå®˜æ–¹å­—æ®µï¼Œä¾›é€‰ç”¨ã€‚</p><ul><li>iss (issuer)ï¼šç­¾å‘äºº</li><li>exp (expiration time)ï¼šè¿‡æœŸæ—¶é—´</li><li>sub (subject)ï¼šä¸»é¢˜</li><li>aud (audience)ï¼šå—ä¼—</li><li>nbf (Not Before)ï¼šç”Ÿæ•ˆæ—¶é—´</li><li>iat (Issued At)ï¼šç­¾å‘æ—¶é—´</li><li>jti (JWT ID)ï¼šç¼–å·</li></ul><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±åŠ å…¥ä¸€äº›ç§æœ‰å­—æ®µã€‚</p><p><strong>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼š</strong>è™½è¯´æˆ‘ä»¬åé¢æœ‰ç­¾åçš„ç¯èŠ‚ï¼Œä½†é‚£åªæ˜¯ä¸ºäº†é˜²æ­¢ç¯¡æ”¹ï¼Œä¸Šé¢ä¸¤ä¸ªéƒ¨åˆ†æˆ‘ä»¬é‡‡ç”¨çš„base64UrlEncodeç¼–ç æ–¹æ³•æ˜¯å¯ä»¥é€šè¿‡é˜²ç¼–ç å‡ºæ¥çš„ï¼Œæ‰€ä»¥é‡è¦æ•°æ®ä¸èƒ½æ”¾åœ¨Payloadä¸­ã€‚</p><p><strong>Signature:</strong></p><p>åœ¨ä¸Šé¢Tokençš„éƒ¨åˆ†ä½ å¯èƒ½å°±æœ‰å¯Ÿè§‰åˆ°ï¼Œæˆ‘ä»¬è¿™æ¬¡æ˜¯å°†ç”¨æˆ·çš„ä¿¡æ¯æ”¾åœ¨Tokené‡Œé¢ä¿å­˜åˆ°Cookieä¸­çš„ï¼Œè¿™é‡Œå°±å­˜åœ¨æˆ‘ä»¬çš„Tokenä¿¡æ¯è¢«è¯»å–ï¼Œè¢«äººç”¨æ¥ä¼ªè£…çš„å¯èƒ½æ€§ï¼Œæ‰€ä»¥å°±åŠ äº†ç­¾åè¿™ä¸€æ­¥éª¤ï¼ŒæœåŠ¡å™¨è‡ªå·±ä¿å­˜äº†ä¸€æŠŠå¯†é’¥ï¼Œè¿™æ ·å°±ç®—åˆ«äººçªƒå–äº†ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•è¿›è¡Œç­¾åï¼Œè¿›è¡Œä¼ªè£…ã€‚</p><p><strong>é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥ï¼ˆsecretï¼‰ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·</strong>ã€‚ç„¶åï¼Œä½¿ç”¨ Header é‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">HMACSHA256</span>(<br>  base64UrlEncode(header) + &quot;.&quot; +<br>  <span class="hljs-built_in">base64UrlEncode</span>(payload),<br>  secret)<br></code></pre></td></tr></table></figure><p>ç®—å‡ºç­¾åä»¥åï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨â€ç‚¹â€ï¼ˆ<code>.</code>ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚</p><h3 id="è¿‡ç¨‹ï¼š-3"><a href="#è¿‡ç¨‹ï¼š-3" class="headerlink" title="è¿‡ç¨‹ï¼š"></a>è¿‡ç¨‹ï¼š</h3><ol><li>ç”¨æˆ·è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç ï¼ˆæˆ–å…¶å®ƒè®¤è¯æ–¹å¼ï¼‰åˆ°æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨è®¤è¯æˆåŠŸåï¼Œç”Ÿæˆä¸€ä¸ªJWTï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°†ä¼šä¿å­˜JWTã€‚</li><li>å®¢æˆ·ç«¯ä¸‹ä¸€æ¬¡å‘èµ·è¯·æ±‚æ—¶ä¼šå¸¦ä¸ŠJWT</li><li>æœåŠ¡å™¨ç”¨è‡ªå·±çš„ç§é’¥è§£æå®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„JWTï¼Œå†³å®šæ˜¯å¦é€šè¿‡</li></ol><h2 id="JWTåœ¨Goä¸­çš„ä½¿ç”¨æ¡ˆä¾‹ï¼š"><a href="#JWTåœ¨Goä¸­çš„ä½¿ç”¨æ¡ˆä¾‹ï¼š" class="headerlink" title="JWTåœ¨Goä¸­çš„ä½¿ç”¨æ¡ˆä¾‹ï¼š"></a>JWTåœ¨Goä¸­çš„ä½¿ç”¨æ¡ˆä¾‹ï¼š</h2><p>é¦–å…ˆgo get ä¸€ä¸‹âœ¨</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">go</span> get github.com/dgrijalva/jwt-<span class="hljs-keyword">go</span><br></code></pre></td></tr></table></figure><h3 id="è·å–JWTï¼š"><a href="#è·å–JWTï¼š" class="headerlink" title="è·å–JWTï¼š"></a>è·å–JWTï¼š</h3><p>æ ¹æ®å‰é¢çš„è®²è§£ï¼Œæˆ‘ä»¬å·²ç»äº†è§£åˆ°JWTçš„æ•°æ®ç»“æ„ï¼Œå®ƒå°±æ˜¯ç”±ä¸¤ä¸ªç¼–ç è¿‡çš„jsonæ–‡ä»¶åŠ ä¸€ä¸ªç­¾åç»„æˆã€‚é‚£æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ‹¼è£…è¿™ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p><p><strong>Headerï¼š</strong></p><p>è¿™ä¸ªéƒ¨åˆ†åŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µéƒ½ä¸ç”¨æˆ‘ä»¬å¡«ï¼Œä¼šç”±ä½ é€‰æ‹©çš„ç­¾åç®—æ³•è‡ªåŠ¨å¡«å†™å¥½ã€‚</p><p><strong>Payloadï¼š</strong>ï¼ˆè·å¾—Tokenå¯¹è±¡ï¼‰</p><p>é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹<code>jwt.StandardClaims</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Go"><span class="hljs-keyword">type</span> StandardClaims <span class="hljs-keyword">struct</span> &#123;<br>Audience  <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;aud,omitempty&quot;`</span><br>ExpiresAt <span class="hljs-type">int64</span>  <span class="hljs-string">`json:&quot;exp,omitempty&quot;`</span><br>Id        <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;jti,omitempty&quot;`</span><br>IssuedAt  <span class="hljs-type">int64</span>  <span class="hljs-string">`json:&quot;iat,omitempty&quot;`</span><br>Issuer    <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;iss,omitempty&quot;`</span><br>NotBefore <span class="hljs-type">int64</span>  <span class="hljs-string">`json:&quot;nbf,omitempty&quot;`</span><br>Subject   <span class="hljs-type">string</span> <span class="hljs-string">`json:&quot;sub,omitempty&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°è¿™å°±æ˜¯æˆ‘ä»¬ä¸Šé¢æ‰€è¯´çš„å®˜æ–¹æä¾›çš„å‡ ä¸ªå¯é€‰çš„å­—æ®µï¼Œåœ¨Goä¸­æˆ‘ä»¬ä½¿ç”¨å¸¸ç”¨çš„æ–¹æ³•â€“ç»“æ„ä½“ç»„åˆæ¥å®ç°æ·»åŠ æˆ‘ä»¬æƒ³è¦çš„å­—æ®µï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Claims <span class="hljs-keyword">struct</span> &#123;<br>UserId <span class="hljs-type">int64</span><br>jwt.StandardClaims<br>&#125;<br></code></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬æŠŠè¿™äº›å­—æ®µå¡«å……å®Œæ•´ï¼Œå°±å¯ä»¥å¾—åˆ°Tokenäº†ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs css">claims := &amp;Claims&#123;<br>    UserId: user.UserInfoId,<br>    StandardClaims: jwt.StandardClaims&#123;<br>        ExpiresAt: expirationTime.<span class="hljs-built_in">Unix</span>(),<br>        IssuedAt:  time.<span class="hljs-built_in">Now</span>().<span class="hljs-built_in">Unix</span>(),<br>        Issuer:    <span class="hljs-string">&quot;douyin_pro_131&quot;</span>,<br>        Subject:   <span class="hljs-string">&quot;L_B__&quot;</span>,<br>    &#125;&#125;<br>token := jwt.<span class="hljs-built_in">NewWithClaims</span>(jwt.SigningMethodHS256, claims)<br><br></code></pre></td></tr></table></figure><p><strong>Signature:</strong></p><p>ä¸Šé¢è·å¾—Tokenå¯¹è±¡åï¼Œè°ƒç”¨<code>jwt.SignedString()</code>ï¼Œå¹¶ä¼ å…¥è‡ªå·±æœåŠ¡å™¨ä¿å­˜çš„å¯†é’¥ï¼ˆä¸€ä¸ª <code>byte[]</code>ï¼‰ï¼Œå°±ä¼šè‡ªåŠ¨å®ŒæˆSignatureéƒ¨åˆ†çš„ç¼–å†™å’Œå¯¹ä¸Šé¢ä¸‰ä¸ªéƒ¨åˆ†åˆ†åˆ«è¿›è¡Œbase64urlç¼–ç ï¼Œå†æ•´åˆæˆä¸€ä¸ªæœ€ç»ˆçš„å­—ç¬¦ä¸²è¿”å›ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go">jwtKey:=[]<span class="hljs-type">byte</span>(<span class="hljs-string">&quot;æˆ‘çš„å¯†é’¥&quot;</span>)<br>tokenString,err:=token.SignedString(jwtKey)<br></code></pre></td></tr></table></figure><h3 id="éªŒè¯JWTï¼š"><a href="#éªŒè¯JWTï¼š" class="headerlink" title="éªŒè¯JWTï¼š"></a>éªŒè¯JWTï¼š</h3><p>ä»¥å¸¸ç”¨çš„Webæ¡†æ¶Ginä¸ºä¾‹ï¼Œæˆ‘ä»¬ä¼šæŠŠè¿™ä¸ªéƒ¨åˆ†æ”¾åˆ°ä¸­é—´ä»¶é‚£é‡Œä½¿ç”¨ã€‚</p><p>è§£æTokenï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">ParseToken</span><span class="hljs-params">(tokenString <span class="hljs-type">string</span>)</span></span> (*MyClaims, <span class="hljs-type">error</span>) &#123;<br>    <span class="hljs-comment">// éªŒè¯tokenæ˜¯å¦æ˜¯æˆ‘ä»¬è‡ªå·±ç­¾å‘çš„</span><br>token, err := jwt.ParseWithClaims(tokenString, &amp;MyClaims&#123;&#125;, <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(token *jwt.Token)</span></span> (i <span class="hljs-keyword">interface</span>&#123;&#125;, err <span class="hljs-type">error</span>) &#123;<br><span class="hljs-keyword">return</span> jwtKey, <span class="hljs-literal">nil</span><br>&#125;)<br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, err<br>&#125;<br><span class="hljs-keyword">if</span> claims, ok := token.Claims.(*MyClaims); ok &amp;&amp; token.Valid &#123; <span class="hljs-comment">// æ ¡éªŒtoken</span><br><span class="hljs-keyword">return</span> claims, <span class="hljs-literal">nil</span><br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>, errors.New(<span class="hljs-string">&quot;invalid token&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><p>ç”¨äºä¸­é—´ä»¶ä¸­ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">JWTAuthMiddleware</span><span class="hljs-params">()</span></span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br><span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(c *gin.Context)</span></span> &#123;<br><span class="hljs-comment">// å®¢æˆ·ç«¯æºå¸¦Tokenæœ‰ä¸‰ç§æ–¹å¼ 1.æ”¾åœ¨è¯·æ±‚å¤´ 2.æ”¾åœ¨è¯·æ±‚ä½“ 3.æ”¾åœ¨URI</span><br><span class="hljs-comment">// è¿™é‡Œå‡è®¾Tokenæ”¾åœ¨Headerçš„Authorizationä¸­ï¼Œå¹¶ä½¿ç”¨Bearerå¼€å¤´</span><br><span class="hljs-comment">// è¿™é‡Œçš„å…·ä½“å®ç°æ–¹å¼è¦ä¾æ®ä½ çš„å®é™…ä¸šåŠ¡æƒ…å†µå†³å®š</span><br>authHeader := c.Query(<span class="hljs-string">&quot;token&quot;</span>)<br>fmt.Println(authHeader)<br><span class="hljs-keyword">if</span> authHeader == <span class="hljs-string">&quot;&quot;</span> &#123;<br>authHeader = c.PostForm(<span class="hljs-string">&quot;token&quot;</span>)<br>fmt.Println(authHeader)<br>&#125;<br><br><span class="hljs-keyword">if</span> authHeader == <span class="hljs-string">&quot; &quot;</span> &#123;<br>c.JSON(http.StatusOK, service.UserResponse&#123;<br>Response: service.Response&#123;StatusCode: <span class="hljs-number">1</span>&#125;,<br>&#125;)<br>c.Abort()<br><span class="hljs-keyword">return</span><br>&#125;<br><br>mc, err := app.ParseToken(authHeader)  <span class="hljs-comment">//å°±æ˜¯è°ƒç”¨ä¸Šé¢çš„ParseToken</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>c.JSON(http.StatusOK, service.UserResponse&#123;<br>Response: service.Response&#123;StatusCode: <span class="hljs-number">1</span>&#125;,<br>&#125;)<br>c.Abort()<br><span class="hljs-keyword">return</span><br>&#125;<br>fmt.Println(mc.UserId)<br><span class="hljs-comment">// å°†å½“å‰è¯·æ±‚çš„usernameä¿¡æ¯ä¿å­˜åˆ°è¯·æ±‚çš„ä¸Šä¸‹æ–‡cä¸Š</span><br>c.Set(<span class="hljs-string">&quot;user_id&quot;</span>, mc.UserId)<br>c.Next() <span class="hljs-comment">// åç»­çš„å¤„ç†å‡½æ•°å¯ä»¥ç”¨è¿‡c.Get(&quot;user_id&quot;)æ¥è·å–å½“å‰è¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯</span><br><br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="JWTçš„ä¸€äº›é—®é¢˜ï¼š"><a href="#JWTçš„ä¸€äº›é—®é¢˜ï¼š" class="headerlink" title="JWTçš„ä¸€äº›é—®é¢˜ï¼š"></a>JWTçš„ä¸€äº›é—®é¢˜ï¼š</h3><ol><li><p>JWT çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œç”±äºæœåŠ¡å™¨ä¸ä¿å­˜ session çŠ¶æ€ï¼Œå› æ­¤æ— æ³•åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åºŸæ­¢æŸä¸ª tokenï¼Œæˆ–è€…æ›´æ”¹ token çš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåœ¨åˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚</p></li><li><p>JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚</p></li><li><p>ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚</p></li></ol>]]></content>
    
    
    <categories>
      
      <category>Go</category>
      
      <category>å¸¸ç”¨ä¸­é—´ä»¶</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®¤è¯ä¸æˆæƒ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æå®šDocker--å¿«é€Ÿå…¥é—¨</title>
    <link href="/2022/07/19/Docker%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8/"/>
    <url>/2022/07/19/Docker%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%BF%AB%E9%80%9F%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ‰DockerğŸ‰"><a href="#ğŸ‰DockerğŸ‰" class="headerlink" title="ğŸ‰DockerğŸ‰"></a>ğŸ‰DockerğŸ‰</h1><p>ä¹‹å‰è€æ˜¯å¬åˆ«äººè®²dockeréƒ¨ç½²çš„å„ç§ä¼˜ç‚¹ï¼Œä½†ä¹‹å‰å•å•å°±æ„Ÿè§‰ç¡®å®æŒºå¥½çš„ï¼Œæ²¡å»æ·±å…¥å­¦ä¹ ï¼Œè¿™æ®µæ—¶é—´æœ‰ç©ºæ‰€ä»¥æ‰“ç®—æŠŠè¿™æŠŠåˆ©å™¨ç»™æ¡èµ·æ¥ï¼</p><span id="more"></span><blockquote><p>å®¹å™¨ï¼šæ“ä½œç³»ç»Ÿçº§åˆ«çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚</p></blockquote><p>ç®€å²ï¼šå‰é¢æ˜¯dotCloudï¼Œç”¨äº†linuxçš„å®¹å™¨åŒ–æŠ€æœ¯ï¼Œä¸­é€”å‘ç°æ´»ä¸ä¸‹å»äº†ï¼Œå°±å˜æˆå¼€æºçš„äº†ï¼Œæ´»äº†ä¹‹åå°±æ”¹åä¸ºdockeräº†ï¼Œåé¢ä¸ºäº†è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ŒæŠ•å…¥äº†Goçš„æ€€æŠ±ï¼Œç”¨äº†Goæ„å»ºçš„å¼•æ“ã€‚</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs routeros">å¤ä¹ ä¸€ç‚¹æ–°è™šæ‹Ÿæœºé…ç½‘ç»œçš„çŸ¥è¯†ï¼š<br><br>vim /etc/sysconfig/network-scripts/ifcfg-ens32 (32,ä¹Ÿå¯èƒ½æ˜¯33)<br><br>ä¿®æ”¹çš„å‚æ•°ï¼š<br><span class="hljs-attribute">BOOTPROTO</span>=dhcp  (ä½¿ç”¨åŠ¨æ€IPè¿˜æ˜¯é™æ€IPï¼Œdhcpæ”¹ä¸ºstatic åŠ¨æ€æ”¹ä¸ºé™æ€)<br><span class="hljs-attribute">ONBOOT</span>=<span class="hljs-literal">no</span> (<span class="hljs-literal">no</span>æ”¹ä¸º<span class="hljs-literal">yes</span> å¼€æœºè‡ªå¯)<br><span class="hljs-attribute">IPADDR</span>=192.168.91.100 (IPåœ°å€ï¼Œä»VMwareçš„è™šæ‹Ÿç½‘ç»œè®¾ç½®é‡Œçœ‹)<br><span class="hljs-attribute">NETMASK</span>=255.255.255.0 (å­ç½‘æ©ç )<br><span class="hljs-attribute">GATEWAY</span>=192.168.91.2 (ç½‘å…³ï¼Œé»˜è®¤å°±æ˜¯ IPåœ°å€ .2 )<br><span class="hljs-attribute">DNS1</span>=192.168.91.2 (è‡ªå·±çš„ç½‘å…³)<br><span class="hljs-attribute">DNS2</span>=144.144.144.44 (ä¸­å›½ç§»åŠ¨ï¼Œè”é€š é€šç”¨çš„ 144.144.144.144)<br><span class="hljs-attribute">DNS3</span>=8.8.8.8(å…¨çƒé€šç”¨çš„,Googleçš„)<br><br></code></pre></td></tr></table></figure><h2 id="ğŸ–å®‰è£…ï¼š"><a href="#ğŸ–å®‰è£…ï¼š" class="headerlink" title="ğŸ–å®‰è£…ï¼š"></a>ğŸ–å®‰è£…ï¼š</h2><ol><li><p><code>sudo yum install -y yum-utils </code>: å®‰è£…yum-utilsè¿™ä¸ªåŒ…ï¼Œæˆ‘ä»¬æ‰å¯ä»¥ç”¨å®ƒé‡Œé¢çš„å·¥å…·:<code>yum-config-manager</code>æ¥æŒ‡å®šä¸‹è½½æº</p></li><li><p><code>sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</code>ï¼šè®¾ç½®ä¸ºé˜¿é‡Œçš„ä¸‹è½½æº</p></li><li><p><code> sudo yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin</code>  docker-ce ï¼šdockerå¼•æ“ç¤¾åŒºç‰ˆã€docker-ce-cliï¼šdockerå¼•æ“å‘½ä»¤è¡Œç•Œé¢ containerd.ioï¼šå®ˆæŠ¤è¿›ç¨‹</p></li><li><p><code>docker -v</code>ï¼šæŸ¥çœ‹ç‰ˆæœ¬ï¼Œçœ‹æ˜¯å¦æˆåŠŸã€‚</p></li><li><p><code>docker run hello-world</code>:æµ‹è¯•èƒ½å¦æ­£å¸¸ä½¿ç”¨</p></li><li><p>é…ç½®é•œåƒåŠ é€Ÿï¼š1.<code>vim /etc/docker/daemon.json</code> </p><ol start="2"><li><p>æ·»åŠ åˆ°é‡Œé¢</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs prolog">&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<span class="hljs-string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p>å¯ç”¨é…ç½®ã€é‡å¯docker</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis">sudo <span class="hljs-params">system</span>ctl daemon-reload<br>sudo <span class="hljs-params">system</span>ctl restart docker<br></code></pre></td></tr></table></figure></li></ol></li></ol><h2 id="ğŸ˜±Docker-æ¶æ„åŠå·¥ä½œåŸç†ï¼š"><a href="#ğŸ˜±Docker-æ¶æ„åŠå·¥ä½œåŸç†ï¼š" class="headerlink" title="ğŸ˜±Docker æ¶æ„åŠå·¥ä½œåŸç†ï¼š"></a>ğŸ˜±Docker æ¶æ„åŠå·¥ä½œåŸç†ï¼š</h2><p>ä¸‰ä¸ªä¸œè¥¿:</p><ul><li>Clientï¼š<strong>å®¿ä¸»æœº</strong>çš„å‘½ä»¤è¡Œç•Œé¢</li><li>Docker_Hostï¼šDockerå¼•æ“<ul><li>Docker daemonï¼š<strong>å®ˆæŠ¤è¿›ç¨‹</strong>ï¼Œå°±åƒä¸€ä¸ªä¸­æ¢ä¸€æ ·ï¼ŒClientçš„å‘½ä»¤å‘åˆ°è¿™é‡Œï¼Œå¹¶ç”±å®ƒæ¥è¿›è¡Œç›¸åº”çš„æ“ä½œï¼Œæ¯”å¦‚ä»è¿œç¨‹ä»“åº“ï¼ˆRegistryï¼‰æ‹‰å–é•œåƒï¼Œå°†æ‹‰å–çš„é•œåƒç”Ÿæˆå®¹å™¨</li><li>imagesï¼šé•œåƒï¼ˆæ¨¡æ¿ï¼Œç±»ä¼¼è¯­è¨€ä¸­çš„ä¸€ä¸ªç±»ï¼‰</li><li>Containersï¼šå®¹å™¨ ï¼ˆçœŸæ­£å·¥ä½œçš„ç©æ„ï¼Œç±»ä¼¼ç”¨ä¸Šé¢çš„ç±»åˆ›å»ºçš„ä¸€ä¸ªå¯¹è±¡ï¼‰</li></ul></li><li>Registryï¼šè¿œç¨‹ä»“åº“</li></ul><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h5un93x8qfj20hz0a4q3x.jpg"></p><h3 id="Clientå®¢æˆ·ç«¯ï¼š"><a href="#Clientå®¢æˆ·ç«¯ï¼š" class="headerlink" title="Clientå®¢æˆ·ç«¯ï¼š"></a>Clientå®¢æˆ·ç«¯ï¼š</h3><h3 id="é•œåƒåˆ†å±‚ï¼š"><a href="#é•œåƒåˆ†å±‚ï¼š" class="headerlink" title="é•œåƒåˆ†å±‚ï¼š"></a>é•œåƒåˆ†å±‚ï¼š</h3><p><img src="http://i2.51cto.com/images/blog/201711/27/462718f3cd35608c20481b33b09db020.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="Dockeré•œåƒçš„å†…éƒ¨ç»“æ„(å››)"></p><p>åœ¨ä½¿ç”¨dockeråï¼Œæˆ‘ä»¬ä¼šæ‹‰å–å¾ˆå¤šå¾ˆå¤šçš„é•œåƒåˆ°æœ¬åœ°ï¼Œä¸ºäº†é˜²æ­¢æ‹‰å–çš„é•œåƒäº’ç›¸é—´å­˜åœ¨å†—ä½™çš„æ•°æ®ï¼ˆæ¯”å¦‚Nginxå’ŒRediséƒ½éœ€è¦å®‰è£…C++ç¯å¢ƒï¼Œå¦‚æœæ‹‰å–é•œåƒçš„æ—¶å€™éƒ½æ‹‰å–äº†ä¸€ä¸ªï¼Œè¿™éƒ¨åˆ†ç›¸åŒçš„C++ç¯å¢ƒå°±æ˜¯å†—ä½™çš„æ•°æ®äº†ï¼Œæ›´æ·±å…¥äº›ï¼Œæ¯ä¸ªé•œåƒä¾èµ–çš„æœ€åŸºç¡€çš„Linuxç¯å¢ƒä¹Ÿä¼šæˆä¸ºå†—ä½™æ•°æ®çš„ä¸€éƒ¨åˆ†)ï¼Œæ‰€ä»¥Dockeré‡‡ç”¨äº†é•œåƒåˆ†å±‚çš„æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯å°†æœ€åŸºç¡€çš„Linuxç¯å¢ƒåšä¸ºBaseé•œåƒï¼Œåé¢æœ€ç»ˆæˆ‘ä»¬æ‰€ä½¿ç”¨çš„é•œåƒï¼ˆNginxã€Redisç­‰ç­‰ï¼‰éƒ½æ˜¯åœ¨è¿™ä¸ªBaseé•œåƒçš„åŸºç¡€ä¸Šï¼Œå †ä¸Šä¸€å±‚å±‚å…¶å®ƒçš„é•œåƒæ„æˆçš„ï¼Œå¦‚æœä¸åŒçš„é•œåƒæœ‰åˆ©ç”¨åˆ°ç›¸åŒçš„éƒ¨åˆ†ï¼Œåˆ™ä¸ä¼šé‡å¤æ‹‰å–ï¼Œè€Œæ˜¯ç›´æ¥å¤ç”¨ã€‚</p><h3 id="Volume-æ•°æ®å·ï¼š"><a href="#Volume-æ•°æ®å·ï¼š" class="headerlink" title="Volume æ•°æ®å·ï¼š"></a>Volume æ•°æ®å·ï¼š</h3><p>ä½¿å®¹å™¨ä¸å®¿ä¸»æœºå»ºç«‹æ˜ å°„å…³ç³»ï¼ŒæŠŠå®¹å™¨é‡Œçš„æ•°æ®æ˜ å°„åˆ°å®¿ä¸»æœºä¸Šï¼Œåœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¯ä»¥æŒ‡å®šæ•°æ®å·ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™æ•°æ®è¿˜æ˜¯åªä¿å­˜åœ¨å®¹å™¨ä¸­ã€‚</p><h3 id="Registry"><a href="#Registry" class="headerlink" title="Registry:"></a>Registry:</h3><p><a href="hub.docker.com">å®˜æ–¹é•œåƒä»“åº“</a> éœ€è¦è”ç½‘ï¼Œè€Œä¸”ä¸Šä¼ ååˆ«äººä¹Ÿèƒ½çœ‹åˆ°</p><p>æ‰€ä»¥docker æä¾›äº† registry é•œåƒï¼Œå¯ä¾›æˆ‘ä»¬åœ¨å±€åŸŸç½‘å†…æ­å»ºä»“åº“ï¼Œä¹Ÿå¯ä»¥è®¾ç½®èº«ä»½è®¤è¯ç­‰ç­‰</p><h2 id="ğŸ’˜Docker-å¸¸ç”¨å‘½ä»¤ï¼š"><a href="#ğŸ’˜Docker-å¸¸ç”¨å‘½ä»¤ï¼š" class="headerlink" title="ğŸ’˜Docker å¸¸ç”¨å‘½ä»¤ï¼š"></a>ğŸ’˜Docker å¸¸ç”¨å‘½ä»¤ï¼š</h2><h3 id="é•œåƒç›¸å…³å‘½ä»¤ï¼š"><a href="#é•œåƒç›¸å…³å‘½ä»¤ï¼š" class="headerlink" title="é•œåƒç›¸å…³å‘½ä»¤ï¼š"></a>é•œåƒç›¸å…³å‘½ä»¤ï¼š</h3><h4 id="1-æŸ¥çœ‹é•œåƒï¼š"><a href="#1-æŸ¥çœ‹é•œåƒï¼š" class="headerlink" title="1.æŸ¥çœ‹é•œåƒï¼š"></a>1.æŸ¥çœ‹é•œåƒï¼š</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker images<br><br></code></pre></td></tr></table></figure><ul><li><code>Repository</code>:ä»“åº“åç§°</li></ul><h4 id="2-æœç´¢é•œåƒï¼š"><a href="#2-æœç´¢é•œåƒï¼š" class="headerlink" title="2.æœç´¢é•œåƒï¼š"></a>2.æœç´¢é•œåƒï¼š</h4><p>å¦‚æœéœ€è¦ä»ç½‘ç»œä¸­æŸ¥æ‰¾éœ€è¦çš„é•œåƒï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å­˜åœ¨</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">docker search é•œåƒå<br></code></pre></td></tr></table></figure><h4 id="3-æ‹‰å–é•œåƒï¼š"><a href="#3-æ‹‰å–é•œåƒï¼š" class="headerlink" title="3.æ‹‰å–é•œåƒï¼š"></a>3.æ‹‰å–é•œåƒï¼š</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs http">docker pull é•œåƒå<br><br>ä¹Ÿå¯ä»¥æŒ‡å®šæ ‡ç­¾ï¼šdocker pull redis:5 (ä¾‹å­)<br></code></pre></td></tr></table></figure><h4 id="4-åˆ é™¤é•œåƒï¼š"><a href="#4-åˆ é™¤é•œåƒï¼š" class="headerlink" title="4.åˆ é™¤é•œåƒï¼š"></a>4.åˆ é™¤é•œåƒï¼š</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker rmi é•œåƒå<br>ä¹Ÿå¯ä»¥æŒ‡å®šæ ‡ç­¾ï¼šdocker rmi redis:5 (ä¾‹å­)<br></code></pre></td></tr></table></figure><h3 id="å®¹å™¨å‘½ä»¤ï¼š"><a href="#å®¹å™¨å‘½ä»¤ï¼š" class="headerlink" title="å®¹å™¨å‘½ä»¤ï¼š"></a>å®¹å™¨å‘½ä»¤ï¼š</h3><h4 id="1-æŸ¥çœ‹å‘½ä»¤ï¼š"><a href="#1-æŸ¥çœ‹å‘½ä»¤ï¼š" class="headerlink" title="1.æŸ¥çœ‹å‘½ä»¤ï¼š"></a>1.æŸ¥çœ‹å‘½ä»¤ï¼š</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs http">docker ps  æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨<br>docker ps -a æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨<br>docker ps -l æŸ¥çœ‹æœ€ååˆ›å»ºçš„å®¹å™¨<br>docker ps -l -n æœ€åå‡ ä¸ªå®¹å™¨<br>docker ps -f status:exited  è¿‡æ»¤æŸ¥è¯¢<br>ä¸çŸ¥é“æ€ä¹ˆæ“ä½œå°±å¯ä»¥åŠ  --helpæ¥è·å¾—å¸®åŠ©<br></code></pre></td></tr></table></figure><h4 id="2-åˆ›å»ºä¸å¯åŠ¨ï¼š"><a href="#2-åˆ›å»ºä¸å¯åŠ¨ï¼š" class="headerlink" title="2.åˆ›å»ºä¸å¯åŠ¨ï¼š"></a>2.åˆ›å»ºä¸å¯åŠ¨ï¼š</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs http">docker run é•œåƒå  åˆ›å»ºå®¹å™¨<br>å‚æ•°ï¼š<br>--name: æŒ‡å®šåˆ›å»ºçš„å®¹å™¨å<br>-p:æŒ‡å®šç«¯å£  ï¼ˆå®¿ä¸»æœºç«¯å£ï¼šå®¹å™¨ç«¯å£ï¼‰<br>-Pï¼šè‡ªåŠ¨æŒ‡å®š<br>-i: è¿è¡Œå®¹å™¨<br>-t:è¡¨ç¤ºå®¹å™¨å¯åŠ¨åä¼šè¿›å…¥å…¶å‘½ä»¤è¡Œç•Œé¢<br>-v:å¯ä»¥æŒ‡å®šç›®å½•æ˜ å°„å…³ç³»ï¼Œå¯ä»¥ç”¨å¤šä¸ª-v æ˜ å°„å¤šä¸ªç›®å½•<br>-itï¼šå¯åŠ¨å¹¶è¿›å…¥ï¼Œæœ‰äº›å®¹å™¨åˆ›å»ºåä¸ä¼šè¿›å…¥ï¼Œå°±å¯ä»¥è¿™æ ·å¯åŠ¨åå¹¶è¿›å…¥<br></code></pre></td></tr></table></figure><h4 id="3-å®ˆæŠ¤è¿›ç¨‹è¿›å…¥"><a href="#3-å®ˆæŠ¤è¿›ç¨‹è¿›å…¥" class="headerlink" title="3.å®ˆæŠ¤è¿›ç¨‹è¿›å…¥"></a>3.å®ˆæŠ¤è¿›ç¨‹è¿›å…¥</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker run -di é•œåƒå<br>docker exec -it [è‡ªå·±å–çš„é•œåƒåï¼Œå®¹å™¨ID]  è¿›å…¥å®¹å™¨<br></code></pre></td></tr></table></figure><h4 id="4-åœæ­¢å¯åŠ¨å®¹å™¨"><a href="#4-åœæ­¢å¯åŠ¨å®¹å™¨" class="headerlink" title="4.åœæ­¢å¯åŠ¨å®¹å™¨"></a>4.åœæ­¢å¯åŠ¨å®¹å™¨</h4><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker stop å®¹å™¨å<br>docker start å®¹å™¨å<br></code></pre></td></tr></table></figure><h4 id="5-æ–‡ä»¶æ‹·è´ï¼š"><a href="#5-æ–‡ä»¶æ‹·è´ï¼š" class="headerlink" title="5.æ–‡ä»¶æ‹·è´ï¼š"></a>5.æ–‡ä»¶æ‹·è´ï¼š</h4><p>å¯ä»¥æŠŠå®¿ä¸»æœºçš„æ‹·è´åˆ°å®¹å™¨ï¼Œä¹Ÿå¯ä»¥æŠŠå®¹å™¨çš„æ‹·è´åˆ°å®¿ä¸»æœº</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker cp éœ€è¦æ‹·è´çš„æ–‡ä»¶æˆ–ç›®å½• å®¹å™¨åç§°:å®¹å™¨ç›®å½•<br>docker cp å®¹å™¨åç§°:å®¹å™¨ç›®å½•æˆ–æ–‡ä»¶ æ‹·è´åˆ°å®¿çš„ä¸»æœºçš„ä½ç½®<br></code></pre></td></tr></table></figure><h4 id="6-ç›®å½•æŒ‚è½½ï¼š"><a href="#6-ç›®å½•æŒ‚è½½ï¼š" class="headerlink" title="6.ç›®å½•æŒ‚è½½ï¼š"></a>6.ç›®å½•æŒ‚è½½ï¼š</h4><p>å¦‚æœä¸æŒ‚è½½ï¼Œå½“å®¹å™¨è¢«åˆ é™¤åï¼Œæ•°æ®ä¹Ÿå°±è¢«åˆ é™¤äº†ï¼ŒæŒ‚è½½åï¼Œå®¿ä¸»æœºçš„æ•°æ®åˆ™è¿˜åœ¨</p><ol><li><p>æŒ‡å®šç›®å½•æŒ‚è½½ï¼š<code>docker run -di -v å®¿ä¸»æœºä½ç½®:å®¹å™¨ç›®å½• é•œåƒåç§°</code>ï¼Œdockerä¼šè‡ªåŠ¨åˆ›å»ºç›¸åº”çš„å®¹å™¨ç›®å½•ï¼Œå¦‚æœæ²¡åœ¨åˆ›å»ºå®¹å™¨æ—¶æŒ‚è½½ï¼Œåé¢æƒ³æŒ‚è½½å¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®æ–‡ä»¶æ¥å®ç°ã€‚</p><p><code>docker inspect å®¹å™¨å </code>å¯ä»¥æŸ¥çœ‹æ‰€æœ‰çš„è¯¦ç»†ä¿¡æ¯ã€‚</p></li><li><p>åŒ¿åæŒ‚è½½ï¼š<code>docker run -di -v å®¹å™¨ç›®å½• é•œåƒåç§°</code>,åŒ¿åæŒ‚è½½æˆ‘ä»¬ä¸ç”¨æŒ‡å®šå®¿ä¸»æœºçš„ä½ç½®ï¼Œç»Ÿä¸€ä¼šè¢«æ”¾åˆ° <code>/var/lib/docker/volumes</code> ä¸­ï¼Œå®ƒä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªéšæœºåç§°çš„ç›®å½•ï¼Œå¦‚æœåŒ¿åæŒ‚è½½è¿‡å¤šæ—¶ï¼Œå¯ä»¥é€šè¿‡<code>docker inspect å®¹å™¨å</code>æ¥æŸ¥çœ‹è¢«æŒ‚è½½æ—¶éšæœºç”Ÿæˆçš„åå­—ã€‚</p></li><li><p>å…·åæŒ‚è½½ï¼š<code>docker run -di -v å®¿ä¸»æœºä¸­çš„ç›®å½•åå­—:å®¹å™¨ç›®å½• é•œåƒåç§°</code>,å’Œä¸Šé¢ä¸€æ ·ä¼šè¢«æ”¾åˆ°<code>/var/lib/docker/volumes</code>ä¸­ï¼Œä¸è¿‡è¿™æ¬¡å¯ä»¥æŒ‡å®šåå­—</p></li><li><p>è®¾ç½®æƒé™ï¼ˆåªè¯»&#x2F;è¯»å†™ï¼Œæœ‰æ—¶æˆ‘ä»¬ä¸å¸Œæœ›å®¹å™¨åœ¨å†…éƒ¨æ“ä½œï¼Œå°±åªå…è®¸å®¿ä¸»æœºæ“ä½œï¼Œå°±å¯ä»¥æŒ‚åªè¯»ï¼‰ï¼Œ<code>docker run -di -v å®¹å™¨ç›®å½•:ro/rw é•œåƒåç§°</code> åªè¯»&#x2F;è¯»å†™</p></li><li><p>ç»§æ‰¿ï¼š<code>--volumes-from è¢«ç»§æ‰¿çš„å®¹å™¨å:ro/rw</code>ï¼Œå¯ä»¥ç»§æ‰¿ä¹‹å‰å®¹å™¨æŒ‚è½½çš„ç›®å½•</p></li><li><p>æŸ¥çœ‹å®¹å™¨ipåœ°å€ï¼š<code>docker inspect å®¹å™¨åç§°</code></p></li><li><p>åˆ é™¤å®¹å™¨ï¼š</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs http">docker rm å®¹å™¨åç§°|å®¹å™¨ID<br>docker rm å®¹å™¨åç§°|å®¹å™¨ID å®¹å™¨åç§°|å®¹å™¨ID å®¹å™¨åç§°|å®¹å™¨ID<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>æ‰“æ€ªå‡çº§</category>
      
      <category>æå®šdocker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>The First Blog</title>
    <link href="/2022/06/28/The-First-Blog/"/>
    <url>/2022/06/28/The-First-Blog/</url>
    
    <content type="html"><![CDATA[<h1 id="ğŸ˜å…¨å†›å‡ºå‡»ğŸ‰"><a href="#ğŸ˜å…¨å†›å‡ºå‡»ğŸ‰" class="headerlink" title="ğŸ˜å…¨å†›å‡ºå‡»ğŸ‰"></a>ğŸ˜å…¨å†›å‡ºå‡»ğŸ‰</h1><h2 id="é©å‘½å°šæœªæˆåŠŸï¼Œè¿˜éœ€ç»§ç»­åŠªåŠ›ğŸ–"><a href="#é©å‘½å°šæœªæˆåŠŸï¼Œè¿˜éœ€ç»§ç»­åŠªåŠ›ğŸ–" class="headerlink" title="é©å‘½å°šæœªæˆåŠŸï¼Œè¿˜éœ€ç»§ç»­åŠªåŠ›ğŸ–"></a>é©å‘½å°šæœªæˆåŠŸï¼Œè¿˜éœ€ç»§ç»­åŠªåŠ›ğŸ–</h2>]]></content>
    
    
    <categories>
      
      <category>é™ˆè¯æ»¥è°ƒ</category>
      
      <category>ç¬¬ä¸€ç¯‡åšå®¢</category>
      
    </categories>
    
    
    <tags>
      
      <tag>FirstBlog</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
