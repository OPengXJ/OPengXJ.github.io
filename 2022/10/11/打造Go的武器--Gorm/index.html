

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/3dd.png">
  <link rel="icon" href="/img/3dd.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="PEngxJ">
  <meta name="keywords" content="">
  
    <meta name="description" content="Goç¨‹åºçš„ç¬¬ä¸€æŠŠæ­¦å™¨ï¼šä¼˜é›…çš„CRUDï¼Œby Gorm">
<meta property="og:type" content="article">
<meta property="og:title" content="ğŸ€æ‰“é€ Goçš„æ­¦å™¨--Gormâ˜¢ï¸">
<meta property="og:url" content="https://opengxj.github.io/2022/10/11/%E6%89%93%E9%80%A0Go%E7%9A%84%E6%AD%A6%E5%99%A8--Gorm/index.html">
<meta property="og:site_name" content="PEngxJçš„å°ç ´ç«™">
<meta property="og:description" content="Goç¨‹åºçš„ç¬¬ä¸€æŠŠæ­¦å™¨ï¼šä¼˜é›…çš„CRUDï¼Œby Gorm">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/008vxvgGgy1h71ghd9z7sj30nz08ct8x.jpg">
<meta property="article:published_time" content="2022-10-11T09:00:33.000Z">
<meta property="article:modified_time" content="2022-10-12T09:42:51.564Z">
<meta property="article:author" content="PEngxJ">
<meta property="article:tag" content="Gorm">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://tva1.sinaimg.cn/large/008vxvgGgy1h71ghd9z7sj30nz08ct8x.jpg">
  
  
  
  <title>ğŸ€æ‰“é€ Goçš„æ­¦å™¨--Gormâ˜¢ï¸ - PEngxJçš„å°ç ´ç«™</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"opengxj.github.io","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>PEngxJçš„å°ç ´ç«™</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://tva1.sinaimg.cn/large/008vxvgGgy1h71ghd9z7sj30nz08ct8x.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ğŸ€æ‰“é€ Goçš„æ­¦å™¨--Gormâ˜¢ï¸"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2022-10-11 17:00" pubdate>
          2022å¹´10æœˆ11æ—¥ ä¸‹åˆ
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          17k å­—
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          146 åˆ†é’Ÿ
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ğŸ€æ‰“é€ Goçš„æ­¦å™¨--Gormâ˜¢ï¸</h1>
            
            
              <div class="markdown-body">
                
                <p>Goç¨‹åºçš„ç¬¬ä¸€æŠŠæ­¦å™¨ï¼šä¼˜é›…çš„CRUDï¼Œby <strong>Gorm</strong></p>
<span id="more"></span>

<h1 id="ğŸ€æ‰“é€ Goçš„æ­¦å™¨â€“Gormâ˜¢ï¸"><a href="#ğŸ€æ‰“é€ Goçš„æ­¦å™¨â€“Gormâ˜¢ï¸" class="headerlink" title="ğŸ€æ‰“é€ Goçš„æ­¦å™¨â€“Gormâ˜¢ï¸"></a>ğŸ€æ‰“é€ Goçš„æ­¦å™¨â€“Gormâ˜¢ï¸</h1><p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h72mzx624lj30vq0hsgnp.jpg" srcset="/img/loading.gif" lazyload></p>
<h2 id="ä»€ä¹ˆæ˜¯Gormï¼š"><a href="#ä»€ä¹ˆæ˜¯Gormï¼š" class="headerlink" title="ä»€ä¹ˆæ˜¯Gormï¼š"></a>ä»€ä¹ˆæ˜¯Gormï¼š</h2><blockquote>
<p>åœ¨ç”¨Goå¼€å‘é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬å…ä¸äº†è¦å’Œæ•°æ®åº“æ‰“äº¤é“ã€‚æ¯ç§è¯­è¨€éƒ½æœ‰ä¼˜ç§€çš„ORMå¯ä¾›é€‰æ‹©ï¼Œåœ¨Goä¸­ä¹Ÿä¸ä¾‹å¤–ï¼Œæ¯”å¦‚<a target="_blank" rel="noopener" href="https://github.com/go-gorm/gorm">gorm</a>ã€<a target="_blank" rel="noopener" href="https://github.com/go-xorm/xorm">xorm</a>ã€<a target="_blank" rel="noopener" href="https://github.com/gohouse/gorose">gorose</a>ç­‰ã€‚ç›®å‰ï¼ŒGitHubä¸Š staræ•°æœ€å¤šçš„æ˜¯GORMï¼Œå®ƒä¹Ÿæ˜¯å½“å‰Goé¡¹ç›®ä¸­ä½¿ç”¨æœ€å¤šçš„ORMã€‚</p>
</blockquote>
<p>GORMæ˜¯Goè¯­è¨€çš„ORMåŒ…ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œè°ƒç”¨æ–¹ä¾¿ã€‚åƒè…¾è®¯ã€åä¸ºã€é˜¿é‡Œè¿™æ ·çš„å¤§å‚ï¼Œéƒ½åœ¨ä½¿ç”¨GORMæ¥æ„å»ºä¼ä¸šçº§çš„åº”ç”¨ã€‚GORMæœ‰å¾ˆå¤šç‰¹æ€§ï¼Œå¼€å‘ä¸­å¸¸ç”¨çš„æ ¸å¿ƒç‰¹æ€§å¦‚ä¸‹ï¼š</p>
<ul>
<li>åŠŸèƒ½å…¨ã€‚ä½¿ç”¨ORMæ“ä½œæ•°æ®åº“çš„æ¥å£ï¼ŒGORMéƒ½æœ‰ï¼Œå¯ä»¥æ»¡è¶³æˆ‘ä»¬å¼€å‘ä¸­å¯¹æ•°æ®åº“è°ƒç”¨çš„å„ç±»éœ€æ±‚ã€‚</li>
<li>æ”¯æŒé’©å­æ–¹æ³•ã€‚è¿™äº›é’©å­æ–¹æ³•å¯ä»¥åº”ç”¨åœ¨Createã€Saveã€Updateã€Deleteã€Findæ–¹æ³•ä¸­ã€‚</li>
<li>å¼€å‘è€…å‹å¥½ï¼Œè°ƒç”¨æ–¹ä¾¿ã€‚</li>
<li>æ”¯æŒAuto Migrationã€‚</li>
<li>æ”¯æŒå…³è”æŸ¥è¯¢ã€‚</li>
<li>æ”¯æŒå¤šç§å…³ç³»æ•°æ®åº“ï¼Œä¾‹å¦‚MySQLã€Postgresã€SQLiteã€SQLServerç­‰ã€‚</li>
</ul>
<p>GORMæœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/jinzhu/gorm">V1</a>å’Œ<a target="_blank" rel="noopener" href="https://github.com/go-gorm/gorm">V2</a>ã€‚éµå¾ªç”¨æ–°ä¸ç”¨æ—§çš„åŸåˆ™ï¼Œæˆ‘ä»¬å­¦ä¹ æœ€æ–°çš„V2ç‰ˆæœ¬ã€‚</p>
<h2 id="å¿«é€Ÿä½¿ç”¨ğŸ«¥ï¼š"><a href="#å¿«é€Ÿä½¿ç”¨ğŸ«¥ï¼š" class="headerlink" title="å¿«é€Ÿä½¿ç”¨ğŸ«¥ï¼š"></a>å¿«é€Ÿä½¿ç”¨ğŸ«¥ï¼š</h2><p><strong>å®‰è£…ï¼š</strong></p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>å®‰è£…gormåŒ…<br>go get -u gorm.io/gorm<br><br><span class="hljs-regexp">//</span>å®‰è£…mysqlæ•°æ®åº“é©±åŠ¨<br>go get -u gorm.io<span class="hljs-regexp">/driver/my</span>sql<br></code></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨ï¼š</strong></p>
<p>é¦–å…ˆæ˜¯<strong>å¯¼åŒ…</strong>ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> (<br>  <span class="hljs-string">&quot;gorm.io/driver/mysql&quot;</span><br>  <span class="hljs-string">&quot;gorm.io/gorm&quot;</span><br>)<br></code></pre></td></tr></table></figure>

<p>ç„¶å<strong>å®šä¹‰ä¸€ä¸ªGORMæ¨¡å‹</strong>ï¼ˆModelsï¼‰ï¼ŒModelsæ˜¯æ ‡å‡†çš„Go structï¼Œç”¨æ¥ä»£è¡¨æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¡¨ç»“æ„ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>  ID <span class="hljs-type">int64</span> <span class="hljs-comment">// ä¸»é”®</span><br>	<span class="hljs-comment">//é€šè¿‡åœ¨å­—æ®µåé¢çš„æ ‡ç­¾è¯´æ˜ï¼Œå®šä¹‰golangå­—æ®µå’Œè¡¨å­—æ®µçš„å…³ç³»</span><br>	<span class="hljs-comment">//ä¾‹å¦‚ `gorm:&quot;column:username&quot;` æ ‡ç­¾è¯´æ˜å«ä¹‰æ˜¯: åœ¨Mysqlä¸­è¡¨çš„åˆ—åï¼ˆå­—æ®µå)ä¸ºusername</span><br>	<span class="hljs-comment">//è¿™é‡Œgolangå®šä¹‰çš„Usernameå˜é‡å’ŒMYSQLè¡¨å­—æ®µusernameä¸€æ ·ï¼Œä»–ä»¬çš„åå­—å¯ä»¥ä¸ä¸€æ ·ã€‚</span><br>	Username <span class="hljs-type">string</span> <span class="hljs-string">`gorm:&quot;column:username&quot;`</span><br>	Password <span class="hljs-type">string</span> <span class="hljs-string">`gorm:&quot;column:password&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>è¿æ¥æ•°æ®åº“ï¼š</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  username := <span class="hljs-string">&quot;root&quot;</span><br>  password := <span class="hljs-string">&quot;123456&quot;</span><br>  host := <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>  port := <span class="hljs-number">3306</span><br>  Dbname := <span class="hljs-string">&quot;Dbname&quot;</span><br>  <br>  <span class="hljs-comment">// æ‹¼æ¥ mysql dsnï¼Œå³æ‹¼æ¥æ•°æ®æºï¼Œä¸‹æ–¹ &#123;&#125; ä¸­çš„æ›¿æ¢å‚æ•°å³å¯</span><br>  <span class="hljs-comment">// &#123;username&#125;:&#123;password&#125;@tcp(&#123;host&#125;:&#123;port&#125;)/&#123;Dbname&#125;?charset=utf8&amp;parseTime=True&amp;loc=Local&amp;timeout=10s&amp;readTimeout=30s&amp;writeTimeout=60s</span><br>  <span class="hljs-comment">// timeout æ˜¯è¿æ¥è¶…æ—¶æ—¶é—´ï¼ŒreadTimeout æ˜¯è¯»è¶…æ—¶æ—¶é—´ï¼ŒwriteTimeout æ˜¯å†™è¶…æ—¶æ—¶é—´ï¼Œå¯ä»¥ä¸å¡«</span><br>  dsn := fmt.Sprintf(<span class="hljs-string">&quot;%s:%s@tcp(%s:%d)/%s?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;</span>, username, password, host, port, Dbname)<br>  <span class="hljs-comment">// è¿æ¥ mysql</span><br>  db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)<br>  <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>    <span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;æ•°æ®åº“è¿æ¥å¤±è´¥, error&quot;</span> + err.Error())<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>æ­£å¼ä½¿ç”¨ï¼š</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><br><span class="hljs-keyword">import</span> (<br>  <span class="hljs-string">&quot;gorm.io/driver/mysql&quot;</span><br>  <span class="hljs-string">&quot;gorm.io/gorm&quot;</span><br>  <span class="hljs-string">&quot;fmt&quot;</span><br>  <span class="hljs-string">&quot;time&quot;</span><br>  <span class="hljs-string">&quot;errors&quot;</span><br>)<br><br><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>  ID <span class="hljs-type">int64</span><br>	Username <span class="hljs-type">string</span> <span class="hljs-string">`gorm:&quot;column:username&quot;`</span><br>	Password <span class="hljs-type">string</span> <span class="hljs-string">`gorm:&quot;column:password&quot;`</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>  &#123;<br>	username := <span class="hljs-string">&quot;root&quot;</span><br>	password := <span class="hljs-string">&quot;123456&quot;</span><br>	host := <span class="hljs-string">&quot;127.0.0.1&quot;</span><br>	port := <span class="hljs-number">3306</span><br>	Dbname := <span class="hljs-string">&quot;Dbname&quot;</span><br>  <br>	dsn := fmt.Sprintf(<span class="hljs-string">&quot;%s:%s@tcp(%s:%d)/%s?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;</span>, username, password, host, port, Dbname)<br>  db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)<br><br>	<span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥, error=&quot;</span> + err.Error())<br>	&#125;<br><br>	<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶åˆå§‹åŒ–æ•°æ®</span><br>	u := User&#123;<br>		Username:<span class="hljs-string">&quot;tizi365&quot;</span>,<br>		Password:<span class="hljs-string">&quot;123456&quot;</span>,<br>	&#125;<br>	<br>	<span class="hljs-comment">//æ’å…¥ä¸€æ¡ç”¨æˆ·æ•°æ®</span><br>	<span class="hljs-comment">//ä¸‹é¢ä»£ç ä¼šè‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ï¼šINSERT INTO `users` (`username`,`password`) VALUES (&#x27;tizi365&#x27;,&#x27;123456&#x27;)</span><br>	<span class="hljs-keyword">if</span> err := db.Create(&amp;u).Error; err != <span class="hljs-literal">nil</span> &#123;<br>		fmt.Println(<span class="hljs-string">&quot;æ’å…¥å¤±è´¥&quot;</span>, err)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br><br>  <br>	<span class="hljs-comment">//æŸ¥è¯¢å¹¶è¿”å›ç¬¬ä¸€æ¡æ•°æ®</span><br>	u = User&#123;&#125;<br>	<span class="hljs-comment">//è‡ªåŠ¨ç”Ÿæˆsqlï¼š SELECT * FROM `users`  WHERE (username = &#x27;tizi365&#x27;) LIMIT 1</span><br>	result := db.Where(<span class="hljs-string">&quot;username = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).First(&amp;u)<br>	<span class="hljs-keyword">if</span> errors.Is(result.Error, gorm.ErrRecordNotFound) &#123;<br>		fmt.Println(<span class="hljs-string">&quot;æ‰¾ä¸åˆ°è®°å½•&quot;</span>)<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	fmt.Println(u.Username,u.Password)<br><br>	<span class="hljs-comment">//æ›´æ–°</span><br>	<span class="hljs-comment">//è‡ªåŠ¨ç”ŸæˆSql: UPDATE `users` SET `password` = &#x27;654321&#x27;  WHERE (username = &#x27;tizi365&#x27;)</span><br>	db.Model(&amp;User&#123;&#125;).Where(<span class="hljs-string">&quot;username = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).Update(<span class="hljs-string">&quot;password&quot;</span>, <span class="hljs-string">&quot;654321&quot;</span>)<br><br>	<span class="hljs-comment">//åˆ é™¤</span><br>	<span class="hljs-comment">//è‡ªåŠ¨ç”ŸæˆSqlï¼š DELETE FROM `users`  WHERE (username = &#x27;tizi365&#x27;)</span><br>	db.Where(<span class="hljs-string">&quot;username = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).Delete(&amp;User&#123;&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨Goé¡¹ç›®å¼€å‘ä¸­ï¼Œä½¿ç”¨GORMåº“ä¸»è¦ç”¨æ¥å®Œæˆä»¥ä¸‹æ•°æ®åº“æ“ä½œï¼š</p>
<ul>
<li>è¿æ¥å’Œå…³é—­æ•°æ®åº“ã€‚è¿æ¥æ•°æ®åº“æ—¶ï¼Œå¯èƒ½éœ€è¦è®¾ç½®ä¸€äº›å‚æ•°ï¼Œæ¯”å¦‚æœ€å¤§è¿æ¥æ•°ã€æœ€å¤§ç©ºé—²è¿æ¥æ•°ã€æœ€å¤§è¿æ¥æ—¶é•¿ç­‰ã€‚</li>
<li>æ’å…¥è¡¨è®°å½•ã€‚å¯ä»¥æ’å…¥ä¸€æ¡è®°å½•ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡æ’å…¥è®°å½•ã€‚</li>
<li>æ›´æ–°è¡¨è®°å½•ã€‚å¯ä»¥æ›´æ–°æŸä¸€ä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ›´æ–°å¤šä¸ªå­—æ®µã€‚</li>
<li>æŸ¥çœ‹è¡¨è®°å½•ã€‚å¯ä»¥æŸ¥çœ‹æŸä¸€æ¡è®°å½•ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹ç¬¦åˆæ¡ä»¶çš„è®°å½•åˆ—è¡¨ã€‚</li>
<li>åˆ é™¤è¡¨è®°å½•ã€‚å¯ä»¥åˆ é™¤æŸä¸€ä¸ªè®°å½•ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡åˆ é™¤ã€‚åˆ é™¤è¿˜æ”¯æŒæ°¸ä¹…åˆ é™¤å’Œè½¯åˆ é™¤ã€‚</li>
<li>åœ¨ä¸€äº›å°å‹é¡¹ç›®ä¸­ï¼Œè¿˜ä¼šç”¨åˆ°GORMçš„è¡¨ç»“æ„è‡ªåŠ¨è¿ç§»åŠŸèƒ½ã€‚</li>
</ul>
<p>GORMåŠŸèƒ½å¼ºå¤§ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç å±•ç¤ºçš„æ˜¯æ¯”è¾ƒé€šç”¨çš„ä¸€ç§æ“ä½œæ–¹å¼ã€‚ä¸Šé¢å±•ç¤ºçš„æ¨¡å‹å®šä¹‰ï¼Œè¿æ¥æ•°æ®åº“ï¼Œå¢åˆ å·®æ”¹çš„æ–¹æ³•åœ¨Gormä¸­è¿˜æœ‰å¾ˆå¤šç»†èŠ‚ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹è¿›ä¸€æ­¥çš„å­¦ä¹ ã€‚</p>
<h2 id="ğŸ¤§GORMå¸¸ç”¨æ“ä½œè®²è§£ï¼š"><a href="#ğŸ¤§GORMå¸¸ç”¨æ“ä½œè®²è§£ï¼š" class="headerlink" title="ğŸ¤§GORMå¸¸ç”¨æ“ä½œè®²è§£ï¼š"></a>ğŸ¤§GORMå¸¸ç”¨æ“ä½œè®²è§£ï¼š</h2><h3 id="æ¨¡å‹å®šä¹‰ï¼š"><a href="#æ¨¡å‹å®šä¹‰ï¼š" class="headerlink" title="æ¨¡å‹å®šä¹‰ï¼š"></a>æ¨¡å‹å®šä¹‰ï¼š</h3><blockquote>
<p>æ¨¡å‹æ˜¯æ ‡å‡†çš„ structï¼Œç”± Go çš„<strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>ã€å®ç°äº† Scannerå’Œ Valueræ¥å£çš„è‡ªå®šä¹‰ç±»å‹åŠå…¶æŒ‡é’ˆæˆ–åˆ«åç»„æˆ</p>
</blockquote>
<p><strong>çº¦å®š</strong></p>
<p>GORM å€¾å‘äºçº¦å®šï¼Œè€Œä¸æ˜¯é…ç½®ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒGORM ä½¿ç”¨ <code>ID</code> ä½œä¸ºä¸»é”®ï¼Œä½¿ç”¨ç»“æ„ä½“åçš„ <code>è›‡å½¢å¤æ•°</code> ä½œä¸ºè¡¨åï¼Œå­—æ®µåçš„ <code>è›‡å½¢</code> ä½œä¸ºåˆ—åï¼Œå¹¶ä½¿ç”¨ <code>CreatedAt</code>ã€<code>UpdatedAt</code> å­—æ®µè¿½è¸ªåˆ›å»ºã€æ›´æ–°æ—¶é—´</p>
<p>åˆ†åˆ«çš„ç»†èŠ‚ï¼š</p>
<ol>
<li><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGORM ä¼šä½¿ç”¨ <code>ID</code> ä½œä¸ºè¡¨çš„ä¸»é”®ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>  ID   <span class="hljs-type">string</span> <span class="hljs-comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œåä¸º `ID` çš„å­—æ®µä¼šä½œä¸ºè¡¨çš„ä¸»é”®</span><br>  Name <span class="hljs-type">string</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p> ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ ‡ç­¾ <code>primaryKey</code> å°†å…¶å®ƒå­—æ®µè®¾ä¸ºä¸»é”®</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å°† `UID` è®¾ä¸ºä¸»é”®</span><br><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;<br>  ID     <span class="hljs-type">int64</span><br>  UID   <span class="hljs-type">string</span> <span class="hljs-string">`gorm:&quot;primaryKey&quot;`</span><br>  Name   <span class="hljs-type">string</span><br>  Age    <span class="hljs-type">int64</span><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ç»“æ„ä½“åçš„ <code>è›‡å½¢å¤æ•°</code> ä½œä¸ºè¡¨åï¼Œå­—æ®µåçš„ <code>è›‡å½¢</code> ä½œä¸ºåˆ—åã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;<br>  AnimalID <span class="hljs-type">int64</span>        <span class="hljs-comment">// åˆ—å `animal_id`</span><br>  Birthday time.Time    <span class="hljs-comment">// åˆ—å `birthday`</span><br>  Age      <span class="hljs-type">int64</span>        <span class="hljs-comment">// åˆ—å `age`</span><br>&#125;<br><span class="hljs-comment">//è¡¨å animals</span><br></code></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è¦è‡ªå®šä¹‰ï¼ŒGormä¹Ÿæä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//è‡ªå®šä¹‰è¡¨åï¼šä¸ºç»“æ„ä½“å®šä¹‰ä¸€ä¸ªTableNameæ–¹æ³•ï¼Œè¿”å›è¡¨å</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(a *Animal)</span></span> TableName() <span class="hljs-type">string</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;animal&quot;</span><br>&#125;<br><br><span class="hljs-comment">//è‡ªå®šä¹‰åˆ—åï¼šåœ¨ç»“æ„ä½“çš„å­—æ®µä¸Šæ·»åŠ å…³äºåˆ—åçš„æ ‡ç­¾</span><br><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;<br>    AnimalID <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:animalID;primarykey&quot;`</span> <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `animalID`</span><br>    Birthday time.Time <span class="hljs-string">`gorm:&quot;column:birthday&quot;`</span>            <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `birthday`</span><br>    Age      <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:age&quot;`</span>                 <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `age`</span><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>Gorm.Model:</p>
<p>æ•°æ®åº“è¡¨é€šå¸¸ä¼šåŒ…å«4ä¸ªå­—æ®µã€‚</p>
<ul>
<li>IDï¼šè‡ªå¢å­—æ®µï¼Œä¹Ÿä½œä¸ºä¸»é”®ã€‚</li>
<li>CreatedAtï¼šè®°å½•åˆ›å»ºæ—¶é—´ã€‚</li>
<li>UpdatedAtï¼šè®°å½•æ›´æ–°æ—¶é—´ã€‚</li>
<li>DeletedAtï¼šè®°å½•åˆ é™¤æ—¶é—´ï¼ˆè½¯åˆ é™¤æ—¶æœ‰ç”¨ï¼‰ã€‚</li>
</ul>
<p>GORMä¹Ÿé¢„å®šä¹‰äº†åŒ…å«è¿™4ä¸ªå­—æ®µçš„Modelsï¼Œ</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// gorm.Model çš„å®šä¹‰</span><br><span class="hljs-keyword">type</span> Model <span class="hljs-keyword">struct</span> &#123;<br>  ID        <span class="hljs-type">uint</span>           <span class="hljs-string">`gorm:&quot;primaryKey&quot;`</span><br>  CreatedAt time.Time<br>  UpdatedAt time.Time<br>  DeletedAt gorm.DeletedAt <span class="hljs-string">`gorm:&quot;index&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>åœ¨æˆ‘ä»¬å®šä¹‰è‡ªå·±çš„Modelsæ—¶ï¼Œå¯ä»¥ç›´æ¥å†…åµŒåˆ°ç»“æ„ä½“å†…ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;<br>    gorm.Model<br>    AnimalID <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:animalID&quot;`</span> <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `animalID`</span><br>    Birthday time.Time <span class="hljs-string">`gorm:&quot;column:birthday&quot;`</span> <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `birthday`</span><br>    Age      <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:age&quot;`</span>      <span class="hljs-comment">// å°†åˆ—åè®¾ä¸º `age`</span><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>åµŒå…¥ç»“æ„ä½“ï¼š</p>
<p>å¯¹äºåŒ¿åå­—æ®µï¼ŒGORM ä¼šå°†å…¶å­—æ®µåŒ…å«åœ¨çˆ¶ç»“æ„ä½“ä¸­ï¼Œå°±æ˜¯ä¸ä¸Šé¢çš„åµŒå…¥gorm.Modelä¸€æ ·ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//åµŒå…¥åçš„Animalç­‰æ•ˆäºä¸‹é¢è¿™ä¸ª</span><br><span class="hljs-keyword">type</span> Animal <span class="hljs-keyword">struct</span> &#123;<br>    ID        <span class="hljs-type">uint</span><br>  	CreatedAt time.Time<br>  	UpdatedAt time.Time<br>  	DeletedAt gorm.DeletedAt<br>    AnimalID <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:animalID&quot;`</span><br>    Birthday time.Time <span class="hljs-string">`gorm:&quot;column:birthday&quot;`</span><br>    Age      <span class="hljs-type">int64</span>     <span class="hljs-string">`gorm:&quot;column:age&quot;`</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¯¹äºæ­£å¸¸çš„ç»“æ„ä½“å­—æ®µï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æ ‡ç­¾ <code>embedded</code> å°†å…¶åµŒå…¥ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Author <span class="hljs-keyword">struct</span> &#123;<br>    Name  <span class="hljs-type">string</span><br>    Email <span class="hljs-type">string</span><br>&#125;<br><span class="hljs-keyword">type</span> Blog <span class="hljs-keyword">struct</span> &#123;<br>  ID      <span class="hljs-type">int</span><br>  Author  Author <span class="hljs-string">`gorm:&quot;embedded&quot;`</span><br>  Upvotes <span class="hljs-type">int32</span><br>&#125;<br><span class="hljs-comment">// ç­‰æ•ˆäº</span><br><span class="hljs-keyword">type</span> Blog <span class="hljs-keyword">struct</span> &#123;<br>  ID    <span class="hljs-type">int64</span><br>  Name  <span class="hljs-type">string</span><br>  Email <span class="hljs-type">string</span><br>  Upvotes  <span class="hljs-type">int32</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¹¶ä¸”ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ ‡ç­¾ <code>embeddrefix</code> æ¥ä¸º db ä¸­çš„å­—æ®µåæ·»åŠ å‰ç¼€ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Blog <span class="hljs-keyword">struct</span> &#123;<br>  ID      <span class="hljs-type">int</span><br>  Author  Author <span class="hljs-string">`gorm:&quot;embedded;embeddedPrefix:author_&quot;`</span><br>  Upvotes <span class="hljs-type">int32</span><br>&#125;<br><span class="hljs-comment">// ç­‰æ•ˆäº</span><br><span class="hljs-keyword">type</span> Blog <span class="hljs-keyword">struct</span> &#123;<br>  ID          <span class="hljs-type">int64</span><br>    AuthorName  <span class="hljs-type">string</span><br>    AuthorEmail <span class="hljs-type">string</span><br>  Upvotes     <span class="hljs-type">int32</span><br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>å­—æ®µæ ‡ç­¾</p>
<p>Modelsä¸­çš„å­—æ®µèƒ½æ”¯æŒå¾ˆå¤šGORMæ ‡ç­¾ï¼Œä½†å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨GORMè‡ªåŠ¨åˆ›å»ºè¡¨å’Œè¿ç§»è¡¨ç»“æ„çš„åŠŸèƒ½ï¼Œå¾ˆå¤šæ ‡ç­¾æˆ‘ä»¬å®é™…ä¸Šæ˜¯ç”¨ä¸åˆ°çš„ã€‚åœ¨å¼€å‘ä¸­ï¼Œç”¨å¾—æœ€å¤šçš„æ˜¯ <code>column</code> æ ‡ç­¾ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="left">æ ‡ç­¾å</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">column</td>
<td align="left">æŒ‡å®š db åˆ—å</td>
</tr>
<tr>
<td align="left">type</td>
<td align="left">åˆ—æ•°æ®ç±»å‹ï¼Œæ¨èä½¿ç”¨å…¼å®¹æ€§å¥½çš„é€šç”¨ç±»å‹ï¼Œä¾‹å¦‚ï¼šboolã€intã€uintã€floatã€stringã€timeã€bytesã€‚å¹¶å¯ä¸å…¶ä»–æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š<code>not null</code>ã€<code>size</code>, <code>autoIncrement</code>â€¦ åƒ <code>varbinary(8)</code> è¿™æ ·æŒ‡å®šæ•°æ®åº“æ•°æ®ç±»å‹ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚åœ¨ä½¿ç”¨æŒ‡å®šæ•°æ®åº“æ•°æ®ç±»å‹æ—¶ï¼Œå®ƒéœ€è¦æ˜¯å®Œæ•´çš„æ•°æ®åº“æ•°æ®ç±»å‹ï¼Œå¦‚ï¼š<code>MEDIUMINT UNSINED not NULL AUTO_INSTREMENT</code></td>
</tr>
<tr>
<td align="left">size</td>
<td align="left">æŒ‡å®šåˆ—å¤§å°ï¼Œä¾‹å¦‚ï¼š<code>size:256</code></td>
</tr>
<tr>
<td align="left">primaryKey</td>
<td align="left">æŒ‡å®šåˆ—ä¸ºä¸»é”®</td>
</tr>
<tr>
<td align="left">unique</td>
<td align="left">æŒ‡å®šåˆ—ä¸ºå”¯ä¸€</td>
</tr>
<tr>
<td align="left">default</td>
<td align="left">æŒ‡å®šåˆ—çš„é»˜è®¤å€¼</td>
</tr>
<tr>
<td align="left">precision</td>
<td align="left">æŒ‡å®šåˆ—çš„ç²¾åº¦</td>
</tr>
<tr>
<td align="left">not null</td>
<td align="left">æŒ‡å®šåˆ—ä¸º NOT NULL</td>
</tr>
<tr>
<td align="left">autoIncrement</td>
<td align="left">æŒ‡å®šåˆ—ä¸ºè‡ªåŠ¨å¢é•¿</td>
</tr>
<tr>
<td align="left">embedded</td>
<td align="left">åµŒå¥—å­—æ®µ</td>
</tr>
<tr>
<td align="left">embeddedPrefix</td>
<td align="left">åµŒå¥—å­—æ®µçš„å‰ç¼€</td>
</tr>
<tr>
<td align="left">autoCreateTime</td>
<td align="left">track current time when creating, for <code>int</code> fields, it will track unix seconds, use value <code>nano</code>&#x2F;<code>milli</code> to track unix nano&#x2F;milli seconds, e.g: <code>autoCreateTime:nano</code></td>
</tr>
<tr>
<td align="left">autoUpdateTime</td>
<td align="left">track current time when creating&#x2F;updating, for <code>int</code> fields, it will track unix seconds, use value <code>nano</code>&#x2F;<code>milli</code> to track unix nano&#x2F;milli seconds, e.g: <code>autoUpdateTime:milli</code></td>
</tr>
<tr>
<td align="left">index</td>
<td align="left">æ ¹æ®å‚æ•°åˆ›å»ºç´¢å¼•ï¼Œå¤šä¸ªå­—æ®µæ‹¥æœ‰ç›¸åŒçš„åç§°åˆ™åˆ›å»ºå¤åˆç´¢å¼•ï¼Œå‚è€ƒ <a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/gorm-2.0/$docs-indexes.html">ç´¢å¼•</a> è·å–è¯¦æƒ…</td>
</tr>
<tr>
<td align="left">uniqueIndex</td>
<td align="left">ä¸ <code>index</code> ç›¸åŒï¼Œä½†åˆ›å»ºçš„æ˜¯å”¯ä¸€ç´¢å¼•</td>
</tr>
<tr>
<td align="left">check</td>
<td align="left">åˆ›å»ºæ£€æŸ¥çº¦æŸï¼Œä¾‹å¦‚ <code>check:(age &gt; 13)</code>ï¼ŒæŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://www.bookstack.cn/read/gorm-2.0/$docs-constraints.html">çº¦æŸ</a> è·å–è¯¦æƒ…</td>
</tr>
<tr>
<td align="left">&lt;-</td>
<td align="left">è®¾ç½®å­—æ®µå†™å…¥çš„æƒé™ï¼Œ <code>&lt;-:create</code> åªåˆ›å»ºã€<code>&lt;-:update</code> åªæ›´æ–°ã€<code>&lt;-:false</code> æ— æƒé™</td>
</tr>
<tr>
<td align="left">-&gt;</td>
<td align="left">è®¾ç½®å­—æ®µè¯»å–æƒé™</td>
</tr>
<tr>
<td align="left">-</td>
<td align="left">å¿½ç•¥æ­¤å­—æ®µï¼ˆç¦æ­¢è¯»å†™ï¼‰</td>
</tr>
</tbody></table>
</li>
</ol>
<h3 id="è¿æ¥æ•°æ®åº“ï¼š"><a href="#è¿æ¥æ•°æ®åº“ï¼š" class="headerlink" title="è¿æ¥æ•°æ®åº“ï¼š"></a>è¿æ¥æ•°æ®åº“ï¼š</h3><ol>
<li>å°±åƒå¿«é€Ÿä½¿ç”¨çš„ä¾‹å­ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ç›´æ¥è¿æ¥æ•°æ®åº“ï¼š</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">import</span> (<br>  <span class="hljs-string">&quot;gorm.io/driver/mysql&quot;</span><br>  <span class="hljs-string">&quot;gorm.io/gorm&quot;</span><br>)<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-comment">// å‚è€ƒ https://github.com/go-sql-driver/mysql#dsn-data-source-name è·å–è¯¦æƒ…</span><br>  dsn := <span class="hljs-string">&quot;user:pass@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;</span><br>  db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>å¦‚æœéœ€è¦GORMæ­£ç¡®åœ°å¤„ç† <code>time.Time</code> ç±»å‹ï¼Œåœ¨è¿æ¥æ•°æ®åº“æ—¶éœ€è¦å¸¦ä¸Š <code>parseTime</code> å‚æ•°(é€šå¸¸éƒ½è¦åŠ çš„ï¼Œè¿™æ ·Gormå°±æ”¯æŒæŠŠæ•°æ®åº“datetimeå’Œdateç±»å‹è½¬æ¢ä¸ºgolangçš„time.Timeç±»å‹ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸€å †å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜)ã€‚å¦‚æœè¦æ”¯æŒå®Œæ•´çš„UTF-8ç¼–ç ï¼Œå¯å°†<code>charset=utf8</code>æ›´æ”¹ä¸º<code>charset=utf8mb4</code>ï¼ˆä¸ºäº†é¿å…ä¹±ç ï¼Œå¯ä»¥mysqlå­—ç¬¦é›†é‚£ç¯‡åšå®¢)ã€‚</p>
<ol start="2">
<li><strong>gormè°ƒè¯•æ¨¡å¼ï¼š</strong></li>
</ol>
<p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œäº†è§£gormæ“ä½œåˆ°åº•æ‰§è¡Œäº†æ€ä¹ˆæ ·çš„sqlè¯­å¥ï¼Œ<strong>å¼€å‘çš„æ—¶å€™</strong>éœ€è¦æ‰“å¼€è°ƒè¯•æ—¥å¿—ï¼Œè¿™æ ·gormä¼šæ‰“å°å‡ºæ‰§è¡Œçš„æ¯ä¸€æ¡sqlè¯­å¥ã€‚ä½¿ç”¨Debugå‡½æ•°æ‰§è¡ŒæŸ¥è¯¢å³å¯ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">result := db.Debug().Where(<span class="hljs-string">&quot;username = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).First(&amp;u)<br></code></pre></td></tr></table></figure>

<ol start="3">
<li><strong>gormè¿æ¥æ± :</strong></li>
</ol>
<p>åœ¨é«˜å¹¶å‘å®è·µä¸­ï¼Œä¸ºäº†æé«˜æ•°æ®åº“è¿æ¥çš„ä½¿ç”¨ç‡ï¼Œé¿å…é‡å¤å»ºç«‹æ•°æ®åº“è¿æ¥å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ï¼Œä¼šç»å¸¸ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯æ¥ç»´æŠ¤æ•°æ®åº“è¿æ¥ã€‚<br>gormè‡ªå¸¦äº†æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨éå¸¸ç®€å•åªè¦è®¾ç½®ä¸‹æ•°æ®åº“è¿æ¥æ± å‚æ•°å³å¯ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go">sqlDB, err := db.DB()<br>sqlDB.SetMaxIdleConns(<span class="hljs-number">10</span>)              <span class="hljs-comment">// è®¾ç½®MySQLçš„æœ€å¤§ç©ºé—²è¿æ¥æ•°ï¼ˆæ¨è10ï¼‰</span><br>sqlDB.SetMaxOpenConns(<span class="hljs-number">100</span>)             <span class="hljs-comment">// è®¾ç½®MySQLçš„æœ€å¤§è¿æ¥æ•°ï¼ˆæ¨è100ï¼‰</span><br>sqlDB.SetConnMaxLifetime(time.Hour)    <span class="hljs-comment">// è®¾ç½®MySQLçš„ç©ºé—²è¿æ¥æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆæ¨è10sï¼‰</span><br></code></pre></td></tr></table></figure>

<p>å…·ä½“ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå·¥å…·åŒ…ï¼Œç”¨æ¥ç®¡ç†gormæ•°æ®åº“è¿æ¥æ± çš„åˆå§‹åŒ–å·¥ä½œã€‚</span><br><span class="hljs-keyword">package</span> tools<br><br><span class="hljs-comment">//å®šä¹‰å…¨å±€çš„dbå¯¹è±¡ï¼Œæˆ‘ä»¬æ‰§è¡Œæ•°æ®åº“æ“ä½œä¸»è¦é€šè¿‡ä»–å®ç°ã€‚</span><br><span class="hljs-keyword">var</span> _db *gorm.DB<br><br><span class="hljs-comment">//åŒ…åˆå§‹åŒ–å‡½æ•°ï¼Œgolangç‰¹æ€§ï¼Œæ¯ä¸ªåŒ…åˆå§‹åŒ–çš„æ—¶å€™ä¼šè‡ªåŠ¨æ‰§è¡Œinitå‡½æ•°ï¼Œè¿™é‡Œç”¨æ¥åˆå§‹åŒ–gormã€‚</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">init</span><span class="hljs-params">()</span></span> &#123;<br>    ...å¿½ç•¥dsné…ç½®ï¼Œè¯·å‚è€ƒä¸Šé¢ä¾‹å­...<br>    <br>    <span class="hljs-comment">// å£°æ˜errå˜é‡ï¼Œä¸‹é¢ä¸èƒ½ä½¿ç”¨:=èµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦åˆ™_dbå˜é‡ä¼šå½“æˆå±€éƒ¨å˜é‡ï¼Œå¯¼è‡´å¤–éƒ¨æ— æ³•è®¿é—®_dbå˜é‡</span><br>    <span class="hljs-keyword">var</span> err <span class="hljs-type">error</span><br>    <span class="hljs-comment">//è¿æ¥MYSQL, è·å¾—DBç±»å‹å®ä¾‹ï¼Œç”¨äºåé¢çš„æ•°æ®åº“è¯»å†™æ“ä½œã€‚</span><br>    _db, err = gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)<br>    <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>		<span class="hljs-built_in">panic</span>(<span class="hljs-string">&quot;è¿æ¥æ•°æ®åº“å¤±è´¥, error=&quot;</span> + err.Error())<br>	&#125;<br>     <br>    sqlDB, _ := db.DB()  <span class="hljs-comment">//æ³¨æ„ï¼šè¿™é‡Œçš„dbå¯å’Œä¸Šé¢çš„_dbä¸æ˜¯åŒä¸ªä¸œè¥¿</span><br><br>    <span class="hljs-comment">//è®¾ç½®æ•°æ®åº“è¿æ¥æ± å‚æ•°</span><br>    sqlDB.SetMaxOpenConns(<span class="hljs-number">100</span>)   <span class="hljs-comment">//è®¾ç½®æ•°æ®åº“è¿æ¥æ± æœ€å¤§è¿æ¥æ•°</span><br>    sqlDB.SetMaxIdleConns(<span class="hljs-number">10</span>)   <span class="hljs-comment">//è¿æ¥æ± æœ€å¤§å…è®¸çš„ç©ºé—²è¿æ¥æ•°ï¼Œå¦‚æœæ²¡æœ‰sqlä»»åŠ¡éœ€è¦æ‰§è¡Œçš„è¿æ¥æ•°å¤§äº20ï¼Œè¶…è¿‡çš„è¿æ¥ä¼šè¢«è¿æ¥æ± å…³é—­ã€‚</span><br>&#125;<br><br><span class="hljs-comment">//è·å–gorm dbå¯¹è±¡ï¼Œå…¶ä»–åŒ…éœ€è¦æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œåªè¦é€šè¿‡tools.getDB()è·å–dbå¯¹è±¡å³å¯ã€‚</span><br><span class="hljs-comment">//ä¸ç”¨æ‹…å¿ƒåç¨‹å¹¶å‘ä½¿ç”¨åŒæ ·çš„dbå¯¹è±¡ä¼šå…±ç”¨åŒä¸€ä¸ªè¿æ¥ï¼Œdbå¯¹è±¡åœ¨è°ƒç”¨ä»–çš„æ–¹æ³•çš„æ—¶å€™ä¼šä»æ•°æ®åº“è¿æ¥æ± ä¸­è·å–æ–°çš„è¿æ¥</span><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">GetDB</span><span class="hljs-params">()</span></span> *gorm.DB &#123;<br>	<span class="hljs-keyword">return</span> _db<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¾‹å­ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">package</span> main<br><span class="hljs-comment">//å¯¼å…¥toolsåŒ…</span><br><span class="hljs-keyword">import</span> tools<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span> &#123;<br>  <span class="hljs-comment">//è·å–DB</span><br>  db := tools.GetDB()<br>  <span class="hljs-comment">//æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œ</span><br>  u := User&#123;&#125;<br>	<span class="hljs-comment">//è‡ªåŠ¨ç”Ÿæˆsqlï¼š SELECT * FROM `users`  WHERE (username = &#x27;tizi365&#x27;) LIMIT 1</span><br>	db.Where(<span class="hljs-string">&quot;username = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).First(&amp;u)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºè®°å½•ï¼š"><a href="#åˆ›å»ºè®°å½•ï¼š" class="headerlink" title="åˆ›å»ºè®°å½•ï¼š"></a>åˆ›å»ºè®°å½•ï¼š</h3><ol>
<li>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>db.Create</code> æ–¹æ³•æ¥åˆ›å»ºä¸€æ¡è®°å½•ï¼š</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> User <span class="hljs-keyword">struct</span> &#123;<br>  gorm.Model<br>  Name         <span class="hljs-type">string</span><br>  Age          <span class="hljs-type">uint8</span><br>  Birthday     *time.Time<br>&#125;<br>user := User&#123;Name: <span class="hljs-string">&quot;Jinzhu&quot;</span>, Age: <span class="hljs-number">18</span>, Birthday: time.Now()&#125;<br>result := db.Create(&amp;user) <span class="hljs-comment">// é€šè¿‡æ•°æ®çš„æŒ‡é’ˆæ¥åˆ›å»º</span><br></code></pre></td></tr></table></figure>

<p>db.Createå‡½æ•°ä¼šè¿”å›å¦‚ä¸‹3ä¸ªå€¼ï¼š</p>
<ul>
<li>user.IDï¼šè¿”å›æ’å…¥æ•°æ®çš„ä¸»é”®ï¼Œè¿™ä¸ªæ˜¯ç›´æ¥èµ‹å€¼ç»™userå˜é‡ã€‚</li>
<li>result.Errorï¼šè¿”å›errorã€‚</li>
<li>result.RowsAffectedï¼šè¿”å›æ’å…¥è®°å½•çš„æ¡æ•°ã€‚</li>
</ul>
<ol start="2">
<li>å½“éœ€è¦æ’å…¥çš„æ•°æ®é‡æ¯”è¾ƒå¤§æ—¶ï¼Œå¯ä»¥æ‰¹é‡æ’å…¥ï¼Œä»¥æé«˜æ’å…¥æ€§èƒ½ï¼š</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> users = []User&#123;&#123;Name: <span class="hljs-string">&quot;jinzhu1&quot;</span>&#125;, &#123;Name: <span class="hljs-string">&quot;jinzhu2&quot;</span>&#125;, &#123;Name: <span class="hljs-string">&quot;jinzhu3&quot;</span>&#125;&#125;<br>DB.Create(&amp;users)<br><br><span class="hljs-keyword">for</span> _, user := <span class="hljs-keyword">range</span> users &#123;<br>  user.ID <span class="hljs-comment">// 1,2,3</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="åˆ é™¤è®°å½•ï¼š"><a href="#åˆ é™¤è®°å½•ï¼š" class="headerlink" title="åˆ é™¤è®°å½•ï¼š"></a>åˆ é™¤è®°å½•ï¼š</h3><ol>
<li>æˆ‘ä»¬å¯ä»¥é€šè¿‡Deleteæ–¹æ³•åˆ é™¤è®°å½•ï¼š</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// DELETE from users where id = 10 AND name = &quot;jinzhu&quot;;</span><br>db.Where(<span class="hljs-string">&quot;name = ?&quot;</span>, <span class="hljs-string">&quot;jinzhu&quot;</span>).Delete(&amp;User&#123;&#125;)<br></code></pre></td></tr></table></figure>

<p>GORMä¹Ÿæ”¯æŒæ ¹æ®ä¸»é”®è¿›è¡Œåˆ é™¤ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// DELETE FROM users WHERE id = 10;</span><br>db.Delete(&amp;User&#123;&#125;, <span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure>

<p>ä¸è¿‡ï¼Œæ›´æ¨èä½¿ç”¨db.Whereçš„æ–¹å¼è¿›è¡Œåˆ é™¤ï¼Œè¿™ç§æ–¹å¼æœ‰ä¸¤ä¸ªä¼˜ç‚¹ã€‚</p>
<p>ç¬¬ä¸€ä¸ªä¼˜ç‚¹æ˜¯åˆ é™¤æ–¹å¼æ›´é€šç”¨ã€‚ä½¿ç”¨db.Whereä¸ä»…å¯ä»¥æ ¹æ®ä¸»é”®åˆ é™¤ï¼Œè¿˜èƒ½å¤Ÿéšæ„ç»„åˆæ¡ä»¶è¿›è¡Œåˆ é™¤ã€‚</p>
<p>ç¬¬äºŒä¸ªä¼˜ç‚¹æ˜¯åˆ é™¤æ–¹å¼æ›´æ˜¾å¼ï¼Œè¿™æ„å‘³ç€æ›´æ˜“è¯»ã€‚å¦‚æœä½¿ç”¨<code>db.Delete(&amp;User&#123;&#125;, 10)</code>ï¼Œä½ è¿˜éœ€è¦ç¡®è®¤Userçš„ä¸»é”®ï¼Œå¦‚æœè®°é”™äº†ä¸»é”®ï¼Œè¿˜å¯èƒ½ä¼šå¼•å…¥Bugã€‚</p>
<p>æ­¤å¤–ï¼ŒGORMä¹Ÿæ”¯æŒæ‰¹é‡åˆ é™¤ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Where(<span class="hljs-string">&quot;name in (?)&quot;</span>, []<span class="hljs-type">string</span>&#123;<span class="hljs-string">&quot;jinzhu&quot;</span>, <span class="hljs-string">&quot;colin&quot;</span>&#125;).Delete(&amp;User&#123;&#125;)<br></code></pre></td></tr></table></figure>

<ol start="2">
<li><strong>è½¯ç¡¬åˆ é™¤ï¼š</strong></li>
</ol>
<p>è½¯åˆ é™¤æ˜¯æŒ‡æ‰§è¡ŒDeleteæ—¶ï¼Œè®°å½•ä¸ä¼šè¢«ä»æ•°æ®åº“ä¸­çœŸæ­£åˆ é™¤ã€‚GORMä¼šå°† <code>DeletedAt</code> è®¾ç½®ä¸ºå½“å‰æ—¶é—´ï¼Œå¹¶ä¸”ä¸èƒ½é€šè¿‡æ­£å¸¸çš„æ–¹å¼æŸ¥è¯¢åˆ°è¯¥è®°å½•ã€‚<strong>æ€ä¹ˆè§¦å‘è½¯åˆ é™¤å‘¢ï¼Ÿ</strong>å¦‚æœæ¨¡å‹åŒ…å«äº†ä¸€ä¸ª <code>gorm.DeletedAt</code> å­—æ®µï¼Œé‚£ä¹ˆGORMåœ¨æ‰§è¡Œåˆ é™¤æ“ä½œæ—¶ï¼Œå°±ä¼šè½¯åˆ é™¤è¯¥è®°å½•ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE age = 20;</span><br>db.Where(<span class="hljs-string">&quot;age = ?&quot;</span>, <span class="hljs-number">20</span>).Delete(&amp;User&#123;&#125;)<br><br><span class="hljs-comment">// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL;</span><br>db.Where(<span class="hljs-string">&quot;age = 20&quot;</span>).Find(&amp;user)<br></code></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼ŒGORMå¹¶æ²¡æœ‰çœŸæ­£æŠŠè®°å½•ä»æ•°æ®åº“åˆ é™¤æ‰ï¼Œè€Œæ˜¯åªæ›´æ–°äº† <code>deleted_at</code> å­—æ®µã€‚åœ¨æŸ¥è¯¢æ—¶ï¼ŒGORMæŸ¥è¯¢æ¡ä»¶ä¸­æ–°å¢äº†<code>AND deleted_at IS NULL</code>æ¡ä»¶ï¼Œæ‰€ä»¥è¿™äº›è¢«è®¾ç½®è¿‡ <code>deleted_at</code> å­—æ®µçš„è®°å½•ä¸ä¼šè¢«æŸ¥è¯¢åˆ°ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è½¯åˆ é™¤çš„æ–¹å¼åˆ é™¤è®°å½•ï¼Œè½¯åˆ é™¤å¯ä»¥ä½¿è¿™äº›é‡è¦çš„æ•°æ®åæœŸèƒ½å¤Ÿè¢«æ¢å¤ï¼Œå¹¶ä¸”ä¾¿äºä»¥åçš„æ’éšœã€‚</p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼æŸ¥æ‰¾è¢«è½¯åˆ é™¤çš„è®°å½•ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// SELECT * FROM users WHERE age = 20;</span><br>db.Unscoped().Where(<span class="hljs-string">&quot;age = 20&quot;</span>).Find(&amp;users)<br></code></pre></td></tr></table></figure>

<p><strong>æ°¸ä¹…åˆ é™¤:</strong></p>
<p>å¦‚æœæƒ³æ°¸ä¹…åˆ é™¤ä¸€æ¡è®°å½•ï¼Œå¯ä»¥ä½¿ç”¨Unscopedï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// DELETE FROM orders WHERE id=10;</span><br>db.Unscoped().Delete(&amp;order)<br></code></pre></td></tr></table></figure>

<p>æˆ–è€…ï¼Œä¹Ÿå¯ä»¥åœ¨æ¨¡å‹ä¸­å»æ‰gorm.DeletedAtã€‚</p>
<h3 id="æ›´æ–°è®°å½•ï¼š"><a href="#æ›´æ–°è®°å½•ï¼š" class="headerlink" title="æ›´æ–°è®°å½•ï¼š"></a>æ›´æ–°è®°å½•ï¼š</h3><ol>
<li>GORMä¸­ï¼Œ<strong>æœ€å¸¸ç”¨çš„æ›´æ–°æ–¹æ³•</strong>å¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//å…ˆæ‰¾åˆ°é‚£æ¡è®°å½•ï¼Œèµ‹å€¼äºç»“æ„ä½“ä¸­</span><br>db.First(&amp;user)<br><span class="hljs-comment">//ä¿®æ”¹ç»“æ„ä½“çš„å€¼</span><br>user.Name = <span class="hljs-string">&quot;jinzhu 2&quot;</span><br>user.Age = <span class="hljs-number">100</span><br><span class="hljs-comment">// UPDATE users SET name=&#x27;jinzhu 2&#x27;, age=100, birthday=&#x27;2016-01-01&#x27;, updated_at = &#x27;2013-11-17 21:34:10&#x27; WHERE id=111;</span><br>db.Save(&amp;user)<br></code></pre></td></tr></table></figure>

<p>ä¸Šè¿°æ–¹æ³•ä¼šä¿ç•™æ‰€æœ‰å­—æ®µï¼Œæ‰€ä»¥æ‰§è¡ŒSaveæ—¶ï¼Œéœ€è¦å…ˆæ‰§è¡ŒFirstï¼Œè·å–æŸä¸ªè®°å½•çš„æ‰€æœ‰åˆ—çš„å€¼ï¼Œç„¶åå†å¯¹éœ€è¦æ›´æ–°çš„å­—æ®µè®¾ç½®å€¼ã€‚</p>
<ol start="2">
<li><strong>è¿˜å¯ä»¥æŒ‡å®šæ›´æ–°å•ä¸ªåˆ—ï¼š</strong></li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// UPDATE users SET age=200, updated_at=&#x27;2013-11-17 21:34:10&#x27; WHERE name=&#x27;colin&#x27;;</span><br>db.Model(&amp;User&#123;&#125;).Where(<span class="hljs-string">&quot;name = ?&quot;</span>, <span class="hljs-string">&quot;colin&quot;</span>).Update(<span class="hljs-string">&quot;age&quot;</span>, <span class="hljs-number">200</span>)<br></code></pre></td></tr></table></figure>

<ol start="3">
<li><strong>ä¹Ÿå¯ä»¥æŒ‡å®šæ›´æ–°å¤šä¸ªåˆ—ï¼š</strong></li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// UPDATE users SET name=&#x27;hello&#x27;, age=18, updated_at = &#x27;2013-11-17 21:34:10&#x27; WHERE name = &#x27;colin&#x27;;</span><br>db.Model(&amp;user).Where(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;colin&quot;</span>).Updates(User&#123;Name: <span class="hljs-string">&quot;hello&quot;</span>, Age: <span class="hljs-number">18</span>, Active: <span class="hljs-literal">false</span>&#125;)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>æç¤ºï¼š é€šè¿‡ç»“æ„ä½“å˜é‡æ›´æ–°å­—æ®µå€¼, gormåº“ä¼šå¿½ç•¥é›¶å€¼å­—æ®µã€‚å°±æ¯”å¦‚å¦‚æœæˆ‘ä»¬æƒ³ä¸€ä¸ªå­—æ®µçš„å€¼æ”¹ä¸º0ï¼Œé‚£ç”¨ç»“æ„ä½“å°±è¡Œä¸é€šäº†ï¼Œå­—æ®µå€¼ç­‰äº0, nil, â€œâ€, falseè¿™äº›å€¼ä¼šè¢«å¿½ç•¥æ‰ï¼Œä¸ä¼šæ›´æ–°ã€‚å¦‚æœæƒ³æ›´æ–°é›¶å€¼ï¼Œå¯ä»¥ä½¿ç”¨mapç±»å‹æ›¿ä»£ç»“æ„ä½“ã€‚</p>
</blockquote>
<ol start="4">
<li><strong>æ›´æ–°è¡¨è¾¾å¼</strong>:</li>
</ol>
<p><em>UPDATE <code>foods</code> SET <code>stock</code> &#x3D; <code>stock</code> + 1 WHERE id &#x3D; â€˜2â€™</em><br>è¿™æ ·çš„å¸¦è®¡ç®—è¡¨è¾¾å¼çš„æ›´æ–°è¯­å¥gormæ€ä¹ˆå†™ï¼Ÿ</p>
<p><del>æŒºé‡è¦â€¼ï¸çš„å“¦ï¼Œè€Œä¸”æŒºå¸¸ç”¨çš„ï¼Œä¹‹å‰å°±æœ‰æœè¿‡è¿™ä¸ª</del></p>
<p>gormæä¾›äº†Exprå‡½æ•°ç”¨äºè®¾ç½®è¡¨è¾¾å¼</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//ç­‰ä»·äº: UPDATE `foods` SET `stock` = stock + 1  WHERE `foods`.`id` = &#x27;2&#x27;</span><br>db.Model(&amp;food).Update(<span class="hljs-string">&quot;stock&quot;</span>, gorm.Expr(<span class="hljs-string">&quot;stock + 1&quot;</span>))<br></code></pre></td></tr></table></figure>

<h3 id="æŸ¥è¯¢æ•°æ®ï¼š"><a href="#æŸ¥è¯¢æ•°æ®ï¼š" class="headerlink" title="æŸ¥è¯¢æ•°æ®ï¼š"></a>æŸ¥è¯¢æ•°æ®ï¼š</h3><p>GORMæ”¯æŒä¸åŒçš„æŸ¥è¯¢æ–¹æ³•ï¼Œä¸‹é¢æˆ‘æ¥è®²è§£ä¸‰ç§åœ¨å¼€å‘ä¸­ç»å¸¸ç”¨åˆ°çš„æŸ¥è¯¢æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯æ£€ç´¢å•ä¸ªè®°å½•ã€æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•å’Œæ™ºèƒ½é€‰æ‹©å­—æ®µã€‚</p>
<ol>
<li>æ£€ç´¢å•ä¸ªè®°å½•</li>
</ol>
<p>ä¸‹é¢æ˜¯æ£€ç´¢å•ä¸ªè®°å½•çš„ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// è·å–æ ¹æ®ä¸»é”®æ’åºçš„ç¬¬ä¸€æ¡è®°å½•ï¼ˆä¸»é”®å‡åºï¼‰</span><br><span class="hljs-comment">// å¦‚æœmodelç±»å‹æ²¡æœ‰å®šä¹‰ä¸»é”®ï¼Œåˆ™æŒ‰ç¬¬ä¸€ä¸ªå­—æ®µæ’åºã€‚</span><br><span class="hljs-comment">// SELECT * FROM users ORDER BY id LIMIT 1;</span><br>db.First(&amp;user)<br><br><span class="hljs-comment">// è·å–æœ€åä¸€æ¡è®°å½•ï¼ˆä¸»é”®é™åºï¼‰</span><br><span class="hljs-comment">// SELECT * FROM users ORDER BY id DESC LIMIT 1;</span><br>db.Last(&amp;user)<br>result := db.First(&amp;user)<br>result.RowsAffected <span class="hljs-comment">// è¿”å›æ‰¾åˆ°çš„è®°å½•æ•°</span><br>result.Error        <span class="hljs-comment">// returns error</span><br><br><span class="hljs-comment">// æ£€æŸ¥ ErrRecordNotFound é”™è¯¯</span><br>errors.Is(result.Error, gorm.ErrRecordNotFound)<br><br><span class="hljs-comment">//ä¸‹é¢è¿™ç§æ–¹å¼ä¹Ÿè¾ƒä¸ºå¸¸è§</span><br>err := db.Take(&amp;food).Error   <span class="hljs-comment">//Takeæ˜¯éšæœºè·å–ä¸€æ¡æ•°æ®</span><br><span class="hljs-keyword">if</span> errors.Is(err, gorm.ErrRecordNotFound) &#123;<br>    fmt.Println(<span class="hljs-string">&quot;æŸ¥è¯¢ä¸åˆ°æ•°æ®&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br><span class="hljs-comment">//å¦‚æœerrä¸ç­‰äºrecord not foundé”™è¯¯ï¼Œåˆä¸ç­‰äºnilï¼Œé‚£è¯´æ˜sqlæ‰§è¡Œå¤±è´¥äº†ã€‚</span><br>	fmt.Println(<span class="hljs-string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>, err)<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„è®°å½•</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs go">users := <span class="hljs-built_in">make</span>([]*User, <span class="hljs-number">0</span>)<br><br><span class="hljs-comment">// SELECT * FROM users WHERE name &lt;&gt; &#x27;jinzhu&#x27;;</span><br>db.Where(<span class="hljs-string">&quot;name &lt;&gt; ?&quot;</span>, <span class="hljs-string">&quot;jinzhu&quot;</span>).Find(&amp;users)<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>æ™ºèƒ½é€‰æ‹©å­—æ®µ</li>
</ol>
<p>ä½ å¯ä»¥é€šè¿‡Selectæ–¹æ³•ï¼Œé€‰æ‹©ç‰¹å®šçš„å­—æ®µã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªè¾ƒå°çš„ç»“æ„ä½“æ¥æ¥å—é€‰å®šçš„å­—æ®µï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> APIUser <span class="hljs-keyword">struct</span> &#123;<br>  ID   <span class="hljs-type">uint</span><br>  Name <span class="hljs-type">string</span><br>&#125;<br>user:=APIUser&#123;&#125;<br>db.Select(<span class="hljs-string">&quot;id,name&quot;</span>).Where(<span class="hljs-string">&quot;id = ?&quot;</span>, <span class="hljs-number">1</span>).Take(&amp;user)<br><br><span class="hljs-comment">//ä¾‹å­2:</span><br><span class="hljs-comment">//å¯ä»¥ç›´æ¥ä¹¦å†™èšåˆè¯­å¥</span><br><span class="hljs-comment">//ç­‰ä»·äº: SELECT count(*) as total FROM `foods`</span><br>total := []<span class="hljs-type">int</span>&#123;&#125;<br><br><span class="hljs-comment">//Modelå‡½æ•°ï¼Œç”¨äºæŒ‡å®šç»‘å®šçš„æ¨¡å‹ï¼Œè¿™é‡Œç”Ÿæˆäº†ä¸€ä¸ªFood&#123;&#125;å˜é‡ã€‚ç›®çš„æ˜¯ä»æ¨¡å‹å˜é‡é‡Œé¢æå–è¡¨åï¼ŒPluckå‡½æ•°æˆ‘ä»¬æ²¡æœ‰ç›´æ¥ä¼ é€’ç»‘å®šè¡¨åçš„ç»“æ„ä½“å˜é‡ï¼Œgormåº“ä¸çŸ¥é“è¡¨åæ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æŒ‡å®šè¡¨å</span><br><span class="hljs-comment">//Pluckå‡½æ•°ï¼Œä¸»è¦ç”¨äºæŸ¥è¯¢ä¸€åˆ—å€¼</span><br>db.Model(&amp;Food&#123;&#125;).Select(<span class="hljs-string">&quot;count(*) as total&quot;</span>).Pluck(<span class="hljs-string">&quot;total&quot;</span>, &amp;total)<br><span class="hljs-comment">//è¿™é‡Œå°±æ˜¯æˆ‘ä»¬è®¡ç®—å‡ºtotalåï¼Œæˆ‘ä»¬ä»è¿”å›ç»“æœä¸­å–å‡ºtotalåˆ—çš„å€¼</span><br>fmt.Println(total[<span class="hljs-number">0</span>])<br></code></pre></td></tr></table></figure>

<p>é™¤äº†ä¸Šé¢è®²çš„ä¸‰ç§å¸¸ç”¨çš„åŸºæœ¬æŸ¥è¯¢æ–¹æ³•ï¼ŒGORMè¿˜æ”¯æŒé«˜çº§æŸ¥è¯¢</p>
<ol>
<li>æŒ‡å®šæ£€ç´¢è®°å½•æ—¶çš„æ’åºæ–¹å¼</li>
</ol>
<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// SELECT * FROM users ORDER BY age desc, name;</span><br>db.Order(<span class="hljs-string">&quot;age desc, name&quot;</span>).Find(&amp;users)<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>Limit &amp; Offset</li>
</ol>
<p>OffsetæŒ‡å®šä»ç¬¬å‡ æ¡è®°å½•å¼€å§‹æŸ¥è¯¢ï¼ŒLimitæŒ‡å®šè¿”å›çš„æœ€å¤§è®°å½•æ•°ã€‚Offsetå’ŒLimitå€¼ä¸º-1æ—¶ï¼Œæ¶ˆé™¤Offsetå’ŒLimitæ¡ä»¶ã€‚å¦å¤–ï¼ŒLimitå’ŒOffsetä½ç½®ä¸åŒï¼Œæ•ˆæœä¹Ÿä¸åŒã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// SELECT * FROM users OFFSET 5 LIMIT 10;</span><br>db.Limit(<span class="hljs-number">10</span>).Offset(<span class="hljs-number">5</span>).Find(&amp;users)<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>Distinct</li>
</ol>
<p>Distinctå¯ä»¥ä»æ•°æ®åº“è®°å½•ä¸­é€‰æ‹©ä¸åŒçš„å€¼ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Distinct(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;age&quot;</span>).Order(<span class="hljs-string">&quot;name, age desc&quot;</span>).Find(&amp;results)<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>Count</li>
</ol>
<p>Countå¯ä»¥è·å–åŒ¹é…çš„æ¡æ•°ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">var</span> count <span class="hljs-type">int64</span><br><span class="hljs-comment">// SELECT count(1) FROM users WHERE name = &#x27;jinzhu&#x27;; (count)</span><br>db.Model(&amp;User&#123;&#125;).Where(<span class="hljs-string">&quot;name = ?&quot;</span>, <span class="hljs-string">&quot;jinzhu&quot;</span>).Count(&amp;count)<br></code></pre></td></tr></table></figure>

<p>5.Group</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//ä¾‹å­:</span><br><span class="hljs-comment">//ç»Ÿè®¡æ¯ä¸ªå•†å“åˆ†ç±»ä¸‹é¢æœ‰å¤šå°‘ä¸ªå•†å“</span><br><span class="hljs-comment">//å®šä¸€ä¸ªResultç»“æ„ä½“ç±»å‹ï¼Œç”¨æ¥ä¿å­˜æŸ¥è¯¢ç»“æœ</span><br><span class="hljs-keyword">type</span> Result <span class="hljs-keyword">struct</span> &#123;<br>    Type  <span class="hljs-type">int</span><br>    Total <span class="hljs-type">int</span><br>&#125;<br><br><span class="hljs-keyword">var</span> results []Result<br><span class="hljs-comment">//ç­‰ä»·äº: SELECT type, count(*) as  total FROM `foods` GROUP BY type HAVING (total &gt; 0)</span><br>db.Model(Food&#123;&#125;).Select(<span class="hljs-string">&quot;type, count(*) as  total&quot;</span>).Group(<span class="hljs-string">&quot;type&quot;</span>).Having(<span class="hljs-string">&quot;total &gt; 0&quot;</span>).Scan(&amp;results)<br><br><span class="hljs-comment">//scanç±»ä¼¼Findéƒ½æ˜¯ç”¨äºæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼Œç„¶åæŠŠæŸ¥è¯¢ç»“æœèµ‹å€¼ç»™ç»“æ„ä½“å˜é‡ï¼ŒåŒºåˆ«åœ¨äºscanä¸ä¼šä»ä¼ é€’è¿›æ¥çš„ç»“æ„ä½“å˜é‡æå–è¡¨å.</span><br><span class="hljs-comment">//è¿™é‡Œå› ä¸ºæˆ‘ä»¬é‡æ–°å®šä¹‰äº†ä¸€ä¸ªç»“æ„ä½“ç”¨äºä¿å­˜ç»“æœï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„ä½“å¹¶æ²¡æœ‰ç»‘å®šfoodsè¡¨ï¼Œæ‰€ä»¥è¿™é‡Œåªèƒ½ä½¿ç”¨scanæŸ¥è¯¢å‡½æ•°ã€‚</span><br></code></pre></td></tr></table></figure>

<p>GORMè¿˜æ”¯æŒå¾ˆå¤šé«˜çº§æŸ¥è¯¢åŠŸèƒ½ï¼Œæ¯”å¦‚å†…è”æ¡ä»¶ã€Not æ¡ä»¶ã€Or æ¡ä»¶ã€Joinsã€FirstOrInitã€FirstOrCreateã€è¿­ä»£ã€FindInBatchesç­‰ã€‚å› ä¸ºIAMé¡¹ç›®ä¸­æ²¡æœ‰ç”¨åˆ°è¿™äº›é«˜çº§ç‰¹æ€§ï¼Œæˆ‘åœ¨è¿™é‡Œå°±ä¸å±•å¼€ä»‹ç»äº†ã€‚ä½ å¦‚æœæ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹ä¸‹<a target="_blank" rel="noopener" href="https://gorm.io/zh_CN/docs/index.html">GORMçš„å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<h3 id="åŸç”ŸSQL"><a href="#åŸç”ŸSQL" class="headerlink" title="åŸç”ŸSQL"></a>åŸç”ŸSQL</h3><p>GORMæ”¯æŒåŸç”ŸæŸ¥è¯¢SQLå’Œæ‰§è¡ŒSQLã€‚åŸç”ŸæŸ¥è¯¢SQLç”¨æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">type</span> Result <span class="hljs-keyword">struct</span> &#123;<br>  ID   <span class="hljs-type">int</span><br>  Name <span class="hljs-type">string</span><br>  Age  <span class="hljs-type">int</span><br>&#125;<br><br><span class="hljs-keyword">var</span> result Result<br>db.Raw(<span class="hljs-string">&quot;SELECT id, name, age FROM users WHERE name = ?&quot;</span>, <span class="hljs-number">3</span>).Scan(&amp;result)<br></code></pre></td></tr></table></figure>

<p>åŸç”Ÿæ‰§è¡ŒSQLç”¨æ³•å¦‚ä¸‹ï¼›</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">db<span class="hljs-selector-class">.Exec</span>(<span class="hljs-string">&quot;DROP TABLE users&quot;</span>)<br>db<span class="hljs-selector-class">.Exec</span>(<span class="hljs-string">&quot;UPDATE orders SET shipped_at=? WHERE id IN ?&quot;</span>, <span class="hljs-selector-tag">time</span><span class="hljs-selector-class">.Now</span>(), <span class="hljs-selector-attr">[]</span>int64&#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>&#125;)<br></code></pre></td></tr></table></figure>

<h2 id="â­ï¸é«˜çº§æ“ä½œï¼š"><a href="#â­ï¸é«˜çº§æ“ä½œï¼š" class="headerlink" title="â­ï¸é«˜çº§æ“ä½œï¼š"></a>â­ï¸é«˜çº§æ“ä½œï¼š</h2><h3 id="ğŸªé’©å­ï¼š"><a href="#ğŸªé’©å­ï¼š" class="headerlink" title="ğŸªé’©å­ï¼š"></a>ğŸªé’©å­ï¼š</h3><p>é’©å­æ˜¯åœ¨åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œä¹‹å‰ã€ä¹‹åè°ƒç”¨çš„å‡½æ•°ã€‚</p>
<p>å¦‚æœæ‚¨å·²ç»ä¸ºæ¨¡å‹å®šä¹‰äº†æŒ‡å®šçš„æ–¹æ³•ï¼Œå®ƒä¼šåœ¨åˆ›å»ºã€æ›´æ–°ã€æŸ¥è¯¢ã€åˆ é™¤æ—¶è‡ªåŠ¨è¢«è°ƒç”¨ã€‚å¦‚<strong>æœä»»ä½•å›è°ƒè¿”å›é”™è¯¯ï¼ŒGORM å°†åœæ­¢åç»­çš„æ“ä½œå¹¶å›æ»šäº‹åŠ¡ã€‚</strong></p>
<p>é’©å­æ–¹æ³•çš„å‡½æ•°ç­¾ååº”è¯¥æ˜¯ <code>func(*gorm.DB) error</code></p>
<h4 id="åˆ›å»ºå¯¹è±¡"><a href="#åˆ›å»ºå¯¹è±¡" class="headerlink" title="åˆ›å»ºå¯¹è±¡:"></a>åˆ›å»ºå¯¹è±¡:</h4><p>åˆ›å»ºæ—¶å¯ç”¨çš„é’©å­ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å¼€å§‹äº‹åŠ¡</span><br>BeforeSave<br>BeforeCreate<br><span class="hljs-comment">// å…³è”å‰çš„ save</span><br><span class="hljs-comment">// æ’å…¥è®°å½•è‡³ db</span><br><span class="hljs-comment">// å…³è”åçš„ save</span><br>AfterCreate<br>AfterSave<br><span class="hljs-comment">// æäº¤æˆ–å›æ»šäº‹åŠ¡</span><br><br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸‹é¢çš„ä»£ç ä¸ºä¾‹ï¼Œåœ¨åˆ›å»ºç”¨æˆ·å‰ä¼šç”³è¯·ä¸€ä¸ªuuidï¼Œå¦‚æœç”³è¯·å¤±è´¥åˆ™ä¼šæŠ¥é”™å›æ»šï¼Œä¸”åœ¨æˆåŠŸåˆ›å»ºåå¯¹idè¿›è¡Œåˆ¤æ–­ï¼Œè¿›è¡Œåç»­æ“ä½œã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span></span> BeforeCreate(tx *gorm.DB) (err <span class="hljs-type">error</span>) &#123;<br>  u.UUID = uuid.New()<br><br>  <span class="hljs-keyword">if</span> !u.IsValid() &#123;<br>    err = errors.New(<span class="hljs-string">&quot;can&#x27;t save invalid data&quot;</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span><br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">func</span> <span class="hljs-params">(u *User)</span></span> AfterCreate(tx *gorm.DB) (err <span class="hljs-type">error</span>) &#123;<br>  <span class="hljs-keyword">if</span> u.ID == <span class="hljs-number">1</span> &#123;<br>    tx.Model(u).Update(<span class="hljs-string">&quot;role&quot;</span>, <span class="hljs-string">&quot;admin&quot;</span>)<br>  &#125;<br>  <span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ³¨æ„</strong> åœ¨ GORM ä¸­ä¿å­˜ã€åˆ é™¤æ“ä½œä¼šé»˜è®¤è¿è¡Œåœ¨äº‹åŠ¡ä¸Šï¼Œ å› æ­¤åœ¨äº‹åŠ¡å®Œæˆä¹‹å‰è¯¥äº‹åŠ¡ä¸­æ‰€ä½œçš„æ›´æ”¹æ˜¯ä¸å¯è§çš„ï¼Œå¦‚æœæ‚¨çš„é’©å­è¿”å›äº†ä»»ä½•é”™è¯¯ï¼Œåˆ™ä¿®æ”¹å°†è¢«å›æ»šã€‚</p>
</blockquote>
<p>å…¶ä»–ç±»å‹çš„æ“ä½œæ˜¯ç›¸ä¼¼äºä¸Šé¢çš„ï¼Œè¿™é‡Œå°±åªè´´å‡ºä»–ä»¬å¯ç”¨çš„é’©å­ï¼š</p>
<p><img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h72lz1oz47j310o0ny0vi.jpg" srcset="/img/loading.gif" lazyload></p>
<h3 id="äº‹åŠ¡ï¼š"><a href="#äº‹åŠ¡ï¼š" class="headerlink" title="äº‹åŠ¡ï¼š"></a>äº‹åŠ¡ï¼š</h3><h4 id="è‡ªåŠ¨äº‹åŠ¡ï¼š"><a href="#è‡ªåŠ¨äº‹åŠ¡ï¼š" class="headerlink" title="è‡ªåŠ¨äº‹åŠ¡ï¼š"></a>è‡ªåŠ¨äº‹åŠ¡ï¼š</h4><p>é€šè¿‡db.Transactionå‡½æ•°å®ç°äº‹åŠ¡ï¼Œå¦‚æœé—­åŒ…ä»»ä½•ä¸€ä¸ªå‡½æ•°è¿”å›é”™è¯¯ï¼Œåˆ™å›æ»šäº‹åŠ¡ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs go">db.Transaction(<span class="hljs-function"><span class="hljs-keyword">func</span><span class="hljs-params">(tx *gorm.DB)</span></span> <span class="hljs-type">error</span> &#123;<br>  <span class="hljs-comment">// åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œä¸€äº› db æ“ä½œï¼ˆä»è¿™é‡Œå¼€å§‹ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨ &#x27;tx&#x27; è€Œä¸æ˜¯ &#x27;db&#x27;ï¼‰</span><br>  <span class="hljs-keyword">if</span> err := tx.Create(&amp;Animal&#123;Name: <span class="hljs-string">&quot;Giraffe&quot;</span>&#125;).Error; err != <span class="hljs-literal">nil</span> &#123;<br>    <span class="hljs-comment">// è¿”å›ä»»ä½•é”™è¯¯éƒ½ä¼šå›æ»šäº‹åŠ¡</span><br>    <span class="hljs-keyword">return</span> err<br>  &#125;<br><br>  <span class="hljs-keyword">if</span> err := tx.Create(&amp;Animal&#123;Name: <span class="hljs-string">&quot;Lion&quot;</span>&#125;).Error; err != <span class="hljs-literal">nil</span> &#123;<br>    <span class="hljs-keyword">return</span> err<br>  &#125;<br><br>  <span class="hljs-comment">// è¿”å› nil æäº¤äº‹åŠ¡</span><br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="æ‰‹åŠ¨äº‹åŠ¡ï¼š"><a href="#æ‰‹åŠ¨äº‹åŠ¡ï¼š" class="headerlink" title="æ‰‹åŠ¨äº‹åŠ¡ï¼š"></a>æ‰‹åŠ¨äº‹åŠ¡ï¼š</h4><p>åœ¨å¼€å‘ä¸­ç»å¸¸éœ€è¦æ•°æ®åº“äº‹åŠ¡æ¥ä¿è¯å¤šä¸ªæ•°æ®åº“å†™æ“ä½œçš„åŸå­æ€§ã€‚ä¾‹å¦‚ç”µå•†ç³»ç»Ÿä¸­çš„æ‰£å‡åº“å­˜å’Œä¿å­˜è®¢å•ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// å¼€å¯äº‹åŠ¡</span><br>tx := db.Begin()<br><br><span class="hljs-comment">//åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œä½¿ç”¨çš„æ˜¯txå˜é‡ï¼Œä¸æ˜¯dbã€‚</span><br><br><span class="hljs-comment">//åº“å­˜å‡ä¸€</span><br><span class="hljs-comment">//ç­‰ä»·äº: UPDATE `foods` SET `stock` = stock - 1  WHERE `foods`.`id` = &#x27;2&#x27; and stock &gt; 0</span><br><span class="hljs-comment">//RowsAffectedç”¨äºè¿”å›sqlæ‰§è¡Œåå½±å“çš„è¡Œæ•°</span><br>rowsAffected := tx.Model(&amp;food).Where(<span class="hljs-string">&quot;stock &gt; 0&quot;</span>).Update(<span class="hljs-string">&quot;stock&quot;</span>, gorm.Expr(<span class="hljs-string">&quot;stock - 1&quot;</span>)).RowsAffected<br><span class="hljs-keyword">if</span> rowsAffected == <span class="hljs-number">0</span> &#123;<br>    <span class="hljs-comment">//å¦‚æœæ›´æ–°åº“å­˜æ“ä½œï¼Œè¿”å›å½±å“è¡Œæ•°ä¸º0ï¼Œè¯´æ˜æ²¡æœ‰åº“å­˜äº†ï¼Œç»“æŸä¸‹å•æµç¨‹</span><br>    <span class="hljs-comment">//è¿™é‡Œå›æ»šä½œç”¨ä¸å¤§ï¼Œå› ä¸ºå‰é¢æ²¡æˆåŠŸæ‰§è¡Œä»€ä¹ˆæ•°æ®åº“æ›´æ–°æ“ä½œï¼Œä¹Ÿæ²¡ä»€ä¹ˆæ•°æ®éœ€è¦å›æ»šã€‚</span><br>    <span class="hljs-comment">//è¿™é‡Œå°±æ˜¯ä¸¾ä¸ªä¾‹å­ï¼Œäº‹åŠ¡ä¸­å¯ä»¥æ‰§è¡Œå¤šä¸ªsqlè¯­å¥ï¼Œé”™è¯¯äº†å¯ä»¥å›æ»šäº‹åŠ¡</span><br>    tx.Rollback()<br>    <span class="hljs-keyword">return</span><br>&#125;<br>err := tx.Create(ä¿å­˜è®¢å•).Error<br><br><span class="hljs-comment">//ä¿å­˜è®¢å•å¤±è´¥ï¼Œåˆ™å›æ»šäº‹åŠ¡</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> &#123;<br>    tx.Rollback()<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    tx.Commit()<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="âœ¨é”™è¯¯å¤„ç†ï¼š"><a href="#âœ¨é”™è¯¯å¤„ç†ï¼š" class="headerlink" title="âœ¨é”™è¯¯å¤„ç†ï¼š"></a>âœ¨é”™è¯¯å¤„ç†ï¼š</h2><blockquote>
<p>åœ¨ä¸Šé¢çš„æŸ¥è¯¢æ•°æ®é‡Œæˆ‘ä»¬å·²ç»æœ‰æåˆ°é”™è¯¯å¤„ç†äº†ï¼Œå…¶å®é‚£å°±æ˜¯å…¨éƒ¨äº†ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå†å•ç‹¬æ€»ç»“ä¸‹ï½ï½ï½ï½</p>
</blockquote>
<h3 id="é”™è¯¯å¤„ç†ï¼š"><a href="#é”™è¯¯å¤„ç†ï¼š" class="headerlink" title="é”™è¯¯å¤„ç†ï¼š"></a>é”™è¯¯å¤„ç†ï¼š</h3><p>å¦‚æœé‡åˆ°ä»»ä½•é”™è¯¯ï¼ŒGORM ä¼šå°†é”™è¯¯ä¿¡æ¯ä¿å­˜åˆ° *gorm.DB çš„Errorå­—æ®µï¼Œæˆ‘ä»¬åªè¦æ£€æµ‹Errorå­—æ®µå°±å¯ä»¥çŸ¥é“æ˜¯å¦å­˜åœ¨é”™è¯¯ã€‚å³ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-keyword">if</span> err := db.Where(<span class="hljs-string">&quot;name = ?&quot;</span>, <span class="hljs-string">&quot;tizi365&quot;</span>).First(&amp;user).Error; err != <span class="hljs-literal">nil</span> &#123;<br>  <span class="hljs-comment">// é”™è¯¯å¤„ç†</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="ErrRecordNotFound-errorï¼š"><a href="#ErrRecordNotFound-errorï¼š" class="headerlink" title="ErrRecordNotFound errorï¼š"></a>ErrRecordNotFound errorï¼š</h3><p>å½“ <code>First</code>ã€<code>Last</code>ã€<code>Take</code> æ–¹æ³•æ‰¾ä¸åˆ°è®°å½•æ—¶ï¼ŒGORM ä¼šè¿”å› <code>ErrRecordNotFound</code> é”™è¯¯ã€‚å¦‚æœå‘ç”Ÿäº†å¤šä¸ªé”™è¯¯ï¼Œä½ å¯ä»¥é€šè¿‡ <code>errors.Is</code> åˆ¤æ–­é”™è¯¯æ˜¯å¦ä¸º <code>ErrRecordNotFound</code>ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">// æ£€æŸ¥é”™è¯¯æ˜¯å¦ä¸º RecordNotFound</span><br>err := db.First(&amp;user, <span class="hljs-number">100</span>).Error<br>errors.Is(err, gorm.ErrRecordNotFound)<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Go/" class="category-chain-item">Go</a>
  
  
    <span>></span>
    
  <a href="/categories/Go/Gorm/" class="category-chain-item">Gorm</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Gorm/">#Gorm</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ğŸ€æ‰“é€ Goçš„æ­¦å™¨--Gormâ˜¢ï¸</div>
      <div>https://opengxj.github.io/2022/10/11/æ‰“é€ Goçš„æ­¦å™¨--Gorm/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>ä½œè€…</div>
          <div>PEngxJ</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>å‘å¸ƒäº</div>
          <div>2022å¹´10æœˆ11æ—¥</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>è®¸å¯åè®®</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - ç½²å">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/09/24/Mysql--%E4%B9%B1%E7%A0%81%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F-%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%AF%94%E8%BE%83%E8%A7%84%E5%88%99/" title="ğŸŸMysql--ä¹±ç çš„å‰ä¸–ä»Šç”Ÿ-å­—ç¬¦é›†å’Œæ¯”è¾ƒè§„åˆ™">
                        <span class="hidden-mobile">ğŸŸMysql--ä¹±ç çš„å‰ä¸–ä»Šç”Ÿ-å­—ç¬¦é›†å’Œæ¯”è¾ƒè§„åˆ™</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Mamba</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>KOBE</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ï¼Œå°†å®ƒä¿æŒåœ¨æœ€åº•éƒ¨ -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div>
  </noscript>
</body>
</html>
